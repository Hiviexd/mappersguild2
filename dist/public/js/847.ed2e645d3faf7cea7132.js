(self.webpackChunkmappersguild=self.webpackChunkmappersguild||[]).push([[847],{3001:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>_});var o=n(5393);const s={class:"row"},i={class:"col-sm"},c={class:"my-2"},r={key:1,class:"ms-4"},a={key:0,class:"text-center p-3"};var d=n(6564);const l=(0,o.withScopeId)("data-v-539d51cc");(0,o.pushScopeId)("data-v-539d51cc");const m={class:"col-sm-12 my-1"},u={class:"card-body p-2"},p={class:"row"},h={class:"col-sm-6"},v={class:"col-sm-6 text-end"},g={class:"row"},f={class:"col-sm"};(0,o.popScopeId)();const b=l(((e,t,n,s,i,c)=>{const r=(0,o.resolveComponent)("screening-vote"),a=(0,o.resolveComponent)("screening-notes");return(0,o.openBlock)(),(0,o.createBlock)("div",m,[(0,o.createVNode)("div",{class:["card",e.relatedScreening&&e.relatedScreening.vote?"bg-vote":"bg-dark"]},[(0,o.createVNode)("div",u,[(0,o.createVNode)("div",p,[(0,o.createVNode)("div",h,(0,o.toDisplayString)(e.submission.name),1),(0,o.createVNode)("div",v,[(0,o.createVNode)(r,{"submission-id":e.submission.id,"saved-vote":e.relatedScreening&&e.relatedScreening.vote},null,8,["submission-id","saved-vote"])])]),(0,o.createVNode)("div",g,[(0,o.createVNode)("div",f,[(0,o.createVNode)(a,{"submission-id":e.submission.id,"saved-comment":e.relatedScreening&&e.relatedScreening.comment},null,8,["submission-id","saved-comment"])])])])],2)])})),k=(0,o.withScopeId)("data-v-6c6237ec")(((e,t,n,s,i,c)=>((0,o.openBlock)(),(0,o.createBlock)("div",null,[((0,o.openBlock)(),(0,o.createBlock)(o.Fragment,null,(0,o.renderList)(5,(t=>(0,o.createVNode)("a",{key:t,class:["mx-1",{"disabled-star":e.usedVotes.includes(t)&&e.savedVote!=t||e.voteLoading}],disabled:e.voteLoading,href:"#",onClick:(0,o.withModifiers)((n=>e.updateVote(t)),["prevent"])},[(0,o.createVNode)("i",{class:["fa-star fas",{"text-warning":e.usedVotes.includes(t)&&e.savedVote==t}]},null,2)],10,["disabled","onClick"]))),64))]))));var w;!function(e){e[e.First=5]="First",e[e.Second=4]="Second",e[e.Third=3]="Third",e[e.Fourth=2]="Fourth",e[e.Fifth=1]="Fifth",e[e.None=0]="None"}(w||(w={}));const C=(0,o.defineComponent)({name:"ScreeningVote",props:{submissionId:{type:String,required:!0},savedVote:{type:Number,default:0}},computed:Object.assign(Object.assign({},(0,d.rn)({voteLoading:e=>e.voteLoading})),(0,d.Se)(["usedVotes"])),methods:{updateVote(e){return t=this,n=void 0,s=function*(){this.$store.commit("setVoteLoading",!0),this.savedVote==e&&(e=w.None);const t=yield this.$http.executePost("/screening/updateSubmission/"+this.submissionId,{vote:e});this.$http.isError(t)||this.$store.commit("updateSubmission",t),this.$store.commit("setVoteLoading",!1)},new((o=void 0)||(o=Promise))((function(e,i){function c(e){try{a(s.next(e))}catch(e){i(e)}}function r(e){try{a(s.throw(e))}catch(e){i(e)}}function a(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(c,r)}a((s=s.apply(t,n||[])).next())}));var t,n,o,s}}});C.render=k,C.__scopeId="data-v-6c6237ec";const y=C,V={class:""},S=(0,o.createVNode)("i",{class:"fas fa-edit"},null,-1),N={key:1,class:"small text-white-50"},B={class:"text-end"};const I=(0,o.defineComponent)({name:"ScreeningNotes",props:{submissionId:{type:String,required:!0},savedComment:{type:String,default:""}},data(){return{showCommentInput:!1,newComment:this.savedComment}},methods:{cancelUpdate(){this.showCommentInput=!this.showCommentInput,this.newComment=this.savedComment},updateComment(e){return t=this,n=void 0,s=function*(){if(this.savedComment!=this.newComment){const t=yield this.$http.executePost("/screening/updateSubmission/"+this.submissionId,{comment:this.newComment.trim()},e);this.$http.isError(t)||(this.showCommentInput=!this.showCommentInput,this.$store.commit("updateSubmission",t))}else this.showCommentInput=!this.showCommentInput},new((o=void 0)||(o=Promise))((function(e,i){function c(e){try{a(s.next(e))}catch(e){i(e)}}function r(e){try{a(s.throw(e))}catch(e){i(e)}}function a(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(c,r)}a((s=s.apply(t,n||[])).next())}));var t,n,o,s}}});I.render=function(e,t,n,s,i,c){return(0,o.openBlock)(),(0,o.createBlock)("div",V,[e.showCommentInput?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)("a",{key:0,href:"#",onClick:t[1]||(t[1]=(0,o.withModifiers)((t=>e.showCommentInput=!e.showCommentInput),["prevent"]))},[S])),e.showCommentInput?((0,o.openBlock)(),(0,o.createBlock)(o.Fragment,{key:2},[(0,o.withDirectives)((0,o.createVNode)("textarea",{"onUpdate:modelValue":t[2]||(t[2]=t=>e.newComment=t),class:"form-control form-control-sm",rows:"4",type:"text",placeholder:"map comments...",style:{overflow:"hidden","overflow-wrap":"break-word"},maxlength:"1000"},null,512),[[o.vModelText,e.newComment,void 0,{trim:!0}]]),(0,o.createVNode)("div",B,[(0,o.createVNode)("button",{type:"button",class:"btn btn-sm btn-outline-info  mt-1",onClick:t[3]||(t[3]=t=>e.cancelUpdate())}," Cancel "),(0,o.createVNode)("button",{type:"button",class:"btn btn-sm btn-outline-info  mt-1",onClick:t[4]||(t[4]=t=>e.updateComment(t))}," Save ")])],64)):((0,o.openBlock)(),(0,o.createBlock)("span",N,(0,o.toDisplayString)(e.newComment||"..."),1))])};const x=I,$=(0,o.defineComponent)({name:"SubmissionCard",components:{ScreeningVote:y,ScreeningNotes:x},props:{submission:{type:Object,required:!0}},computed:Object.assign(Object.assign({},(0,d.rn)(["loggedInUser"])),{relatedScreening(){return this.submission.evaluations.find((e=>e.screener._id===this.loggedInUser.id))}})});$.render=b,$.__scopeId="data-v-539d51cc";const L=$,F={state:{contests:[],voteLoading:!1},mutations:{setContests(e,t){e.contests=t},setVoteLoading(e,t){e.voteLoading=t},updateSubmission(e,t){let n=-1;const o=e.contests.findIndex((e=>{if(n=e.submissions.findIndex((e=>e.id===t.id)),-1!==n)return!0}));-1!==o&&-1!==n&&(e.contests[o].submissions[n]=t)}},getters:{usedVotes:(e,t,n)=>{const o=[];return e.contests.forEach((e=>{e.submissions.forEach((e=>{const t=e.evaluations.find((e=>{var t;return e.screener.id===(null===(t=n.loggedInUser)||void 0===t?void 0:t.id)}));t&&o.push(t.vote)}))})),o}}};const M=(0,o.defineComponent)({name:"ScreeningPage",components:{SubmissionCard:L},computed:(0,d.rn)({contests:e=>e.screening.contests}),beforeCreate(){this.$store.hasModule("screening")||this.$store.registerModule("screening",F)},unmounted(){this.$store.hasModule("screening")&&this.$store.unregisterModule("screening")},created(){return e=this,t=void 0,o=function*(){const e=yield this.$http.initialRequest("/screening/relevantInfo");this.$http.isError(e)||this.$store.commit("setContests",e.contests||[])},new((n=void 0)||(n=Promise))((function(s,i){function c(e){try{a(o.next(e))}catch(e){i(e)}}function r(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,r)}a((o=o.apply(e,t||[])).next())}));var e,t,n,o}});M.render=function(e,t,n,d,l,m){const u=(0,o.resolveComponent)("submission-card");return(0,o.openBlock)(),(0,o.createBlock)("div",null,[((0,o.openBlock)(!0),(0,o.createBlock)(o.Fragment,null,(0,o.renderList)(e.contests,(e=>((0,o.openBlock)(),(0,o.createBlock)("div",{key:e.id,class:"container card card-body py-1"},[(0,o.createVNode)("div",s,[(0,o.createVNode)("div",i,[(0,o.createVNode)("h4",c,(0,o.toDisplayString)(e.name),1),(0,o.createVNode)("h5",null,[(0,o.createVNode)("a",{href:e.download,target:"_blank"},(0,o.toDisplayString)(e.download),9,["href"])]),e.submissions.length?((0,o.openBlock)(),(0,o.createBlock)(o.TransitionGroup,{key:0,name:"list",tag:"div",class:"row"},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createBlock)(o.Fragment,null,(0,o.renderList)(e.submissions,(e=>((0,o.openBlock)(),(0,o.createBlock)(u,{key:e.id,submission:e},null,8,["submission"])))),128))])),_:2},1024)):((0,o.openBlock)(),(0,o.createBlock)("p",r," No submissions... "))])])])))),128)),e.contests.length?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)("div",a," No contests available for screening... "))])};const _=M}}]);