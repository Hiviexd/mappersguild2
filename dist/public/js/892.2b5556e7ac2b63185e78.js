(self.webpackChunkmappersguild=self.webpackChunkmappersguild||[]).push([[892],{1515:(t,i,e)=>{"use strict";e.d(i,{Z:()=>a});var s=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"modal fade",attrs:{tabindex:"-1"}},[e("div",{staticClass:"modal-dialog",class:"modal-"+t.modalSize},[t.loaded?e("div",{staticClass:"modal-content the-a-background"},[e("div",{staticClass:"modal-header",class:t.headerClass||"bg-primary"},[e("h5",{staticClass:"modal-title"},[t._t("header",[t._v("\n                        "+t._s(t.title)+"\n                    ")])],2),t._v(" "),e("a",{staticClass:"close",attrs:{href:"#","data-dismiss":"modal"},on:{click:function(t){t.preventDefault()}}},[t._v("\n                    Ã—\n                ")])]),t._v(" "),e("div",{staticClass:"modal-body"},[t._t("default")],2),t._v(" "),t.$slots.footer?e("div",{staticClass:"modal-footer"},[t._t("footer")],2):t._e()]):t._e()])])};s._withStripped=!0;var n=e(2934);const o=e.n(n)().extend({name:"ModalDialog",props:{title:{type:String,default:""},modalSize:{type:String,default:"lg"},headerClass:{type:String,default:"bg-primary"},loaded:{type:Boolean,default:!0}}});var r=(0,e(1900).Z)(o,s,[],!1,null,null,null);r.options.__file="src/components/ModalDialog.vue";const a=r.exports},4030:(t,i,e)=>{"use strict";e.r(i),e.d(i,{default:()=>f});var s=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[t.contest?e("div",{staticClass:"row mb-2"},[e("div",{staticClass:"col-sm"},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-header"},[e("h4",{staticClass:"text-center my-2"},[t._v("\n                        "+t._s(t.contest.name)+"\n                    ")])]),t._v(" "),e("div",{staticClass:"card-body p-0"},[e("table",{staticClass:"table table-responsive-sm mb-0"},[e("thead",[e("tr",[e("th",{staticClass:"text-left"},[e("a",{attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),t.sortSubmissionsBy("name")}}},[t._v("\n                                        Entry's Name\n                                    ")])]),t._v(" "),t._l(t.criterias,(function(i){return e("th",{key:i.id},[e("a",{staticClass:"text-capitalize",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.sortSubmissionsBy("criteria",i.id)}}},[t._v("\n                                        "+t._s(i.name)+"\n                                    ")])])})),t._v(" "),e("th",[e("a",{attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),t.sortSubmissionsBy("total")}}},[t._v("\n                                        Total\n                                    ")])]),t._v(" "),e("th",[e("a",{attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),t.sortSubmissionsBy("completed")}}},[t._v("\n                                        Completed\n                                    ")])])],2)]),t._v(" "),e("tbody",t._l(t.sortedSubmissions,(function(i){return e("tr",{key:i.id},[e("td",{staticClass:"text-left"},[t._v("\n                                    "+t._s(i.name)+"\n                                ")]),t._v(" "),t._l(t.criterias,(function(s){return e("td",{key:s.id,staticClass:"text-left"},[e("a",{attrs:{href:"#","data-toggle":"modal","data-target":"#editing-judging-modal"},on:{click:function(e){return e.preventDefault(),t.selectForEditing(i.id,s.id)}}},[e("i",{staticClass:"mr-1 fas fa-edit"}),t._v(" "),"comments"!=s.name?e("span",[t._v("\n                                            "+t._s(t.getScore(i.id,s.id)+"/"+s.maxScore)+"\n                                        ")]):t._e()])])})),t._v(" "),e("td",[t._v("\n                                    "+t._s(t.getTotalScore(i.id))+"/"+t._s(t.maxPossibleScore)+"\n                                ")]),t._v(" "),e("td",{staticClass:"text-center"},[e("i",{staticClass:"fa",class:t.isCompleted(i.id)?"fa-check text-success":"fa-times text-danger"})])],2)})),0)])])])])]):t._e(),t._v(" "),e("editing-criteria-modal")],1)};s._withStripped=!0;var n=e(2934),o=e.n(n),r=e(6564),a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("modal-dialog",{attrs:{id:"editing-judging-modal","data-backdrop":"static","data-keyboard":"false",loaded:Boolean(t.editingSubmission)},scopedSlots:t._u([{key:"header",fn:function(){return[t._v("\n        "+t._s(t.editingSubmission.name)+": "),e("span",{staticClass:"text-capitalize"},[t._v(t._s(t.editingCriteria.name))])]},proxy:!0},{key:"default",fn:function(){return["comments"!=t.editingCriteria.name?e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"score"}},[t._v("Score")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.editingScore,expression:"editingScore"}],staticClass:"form-control",attrs:{id:"score",type:"number",step:"1",min:"0",max:t.editingCriteria.maxScore},domProps:{value:t.editingScore},on:{input:function(i){i.target.composing||(t.editingScore=i.target.value)}}})]):e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"comment"}},[t._v("\n                Comment\n            ")]),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.editingComment,expression:"editingComment"}],staticClass:"form-control",attrs:{id:"comment",maxlength:"3000",rows:"4"},domProps:{value:t.editingComment},on:{input:function(i){i.target.composing||(t.editingComment=i.target.value)}}})])]},proxy:!0},{key:"footer",fn:function(){return[e("button",{staticClass:"btn btn-sm btn-outline-secondary",attrs:{type:"button"},on:{click:function(i){return i.preventDefault(),t.closeModal()}}},[t._v("\n            Close\n        ")]),t._v(" "),e("button",{staticClass:"btn btn-sm btn-outline-primary",attrs:{type:"button"},on:{click:function(i){return i.preventDefault(),t.save(i)}}},[t._v("\n            Save changes\n        ")]),t._v(" "),e("div",{attrs:{id:"close-button","data-dismiss":"modal"}})]},proxy:!0}])})};a._withStripped=!0;var d=e(1515);const c=o().extend({name:"EditingCriteriaModal",components:{ModalDialog:d.Z},data:()=>({editingScore:0,editingComment:""}),computed:Object.assign(Object.assign({},(0,r.rn)({judgingDone:t=>t.judging.judgingDone})),(0,r.Se)(["editingSubmission","editingCriteria"])),watch:{editingSubmission(){this.getUserInput()},editingCriteria(){this.getUserInput()}},methods:{getUserInput(){const t=this.getJudgingToCriterias(this.editingSubmission.id,this.editingCriteria.id);t?(this.editingScore=t.score,this.editingComment=t.comment):(this.editingScore=0,this.editingComment="")},getJudgingToCriterias(t,i){const e=this.judgingDone.find((i=>i.submission.id===t));if(!e)return null;return e.judgingScores.find((t=>t.criteria.id===i))||null},save(t){var i,e,s,n,o,r;return s=this,n=void 0,r=function*(){const s=yield this.executePost("/judging/save",{submissionId:null===(i=this.editingSubmission)||void 0===i?void 0:i.id,criteriaId:null===(e=this.editingCriteria)||void 0===e?void 0:e.id,score:this.editingScore,comment:this.editingComment},t);this.isError(s)||(this.$store.commit("setJudgingDone",s.judgingDone),this.$store.dispatch("updateToastMessages",{message:s.success,type:"info"}))},new((o=void 0)||(o=Promise))((function(t,i){function e(t){try{d(r.next(t))}catch(t){i(t)}}function a(t){try{d(r.throw(t))}catch(t){i(t)}}function d(i){var s;i.done?t(i.value):(s=i.value,s instanceof o?s:new o((function(t){t(s)}))).then(e,a)}d((r=r.apply(s,n||[])).next())}))},closeModal(){var t;null===(t=document.getElementById("close-button"))||void 0===t||t.click()}}});var l=e(1900),u=(0,l.Z)(c,a,[],!1,null,null,null);u.options.__file="src/components/judging/EditingCriteriaModal.vue";const g=u.exports,m={state:{contest:null,criterias:[],judgingDone:[],editingSubmissionId:null,editingCriteriaId:null},mutations:{setContest(t,i){t.contest=i},setCriterias(t,i){t.criterias=i},setJudgingDone(t,i){t.judgingDone=i},setEditingSubmissionId(t,i){t.editingSubmissionId=i},setEditingCriteriaId(t,i){t.editingCriteriaId=i}},getters:{editingSubmission:t=>{var i;return null===(i=t.contest)||void 0===i?void 0:i.submissions.find((i=>i.id===t.editingSubmissionId))},editingCriteria:t=>t.criterias.find((i=>i.id===t.editingCriteriaId))}};const v=o().extend({name:"JudgingPage",components:{EditingCriteriaModal:g},data:()=>({sortBy:"name",sortByCriteria:"",sortDesc:!1}),computed:Object.assign(Object.assign({},(0,r.rn)({contest:t=>t.judging.contest,criterias:t=>t.judging.criterias,judgingDone:t=>t.judging.judgingDone})),{filteredSubmissions(){const t=[...this.contest.submissions];for(let i=0;i<t.length;i++){const e=t[i].evaluations.reduce(((t,i)=>i.vote?t+i.vote:t),0);t[i].total=e}return this.contest.submissions.filter((t=>t.total>=this.contest.judgingThreshold))},sortedSubmissions(){const t=this.filteredSubmissions;return t?("name"===this.sortBy?t.sort(((t,i)=>{var e,s;const n=null===(e=t.name)||void 0===e?void 0:e.toUpperCase(),o=null===(s=i.name)||void 0===s?void 0:s.toUpperCase();return n<o?this.sortDesc?-1:1:n>o?this.sortDesc?1:-1:0})):"total"===this.sortBy?t.sort(((t,i)=>{const e=this.getTotalScore(t.id),s=this.getTotalScore(i.id);return this.sortDesc?e-s:s-e})):"criteria"===this.sortBy?t.sort(((t,i)=>{const e=this.getScore(t.id,this.sortByCriteria),s=this.getScore(i.id,this.sortByCriteria);return this.sortDesc?e-s:s-e})):"completed"===this.sortBy&&t.sort(((t,i)=>{const e=this.isCompleted(t.id);return e===this.isCompleted(i.id)?0:this.sortDesc?e?1:-1:e?-1:1})),t):[]},maxPossibleScore(){return this.criterias.reduce(((t,i)=>i.maxScore+t),0)}}),beforeCreate(){this.$store.hasModule("judging")||this.$store.registerModule("judging",m)},destroyed(){this.$store.hasModule("judging")&&this.$store.unregisterModule("judging")},created(){return t=this,i=void 0,s=function*(){const t=yield this.initialRequest("/judging/relevantInfo");this.isError(t)||(this.$store.commit("setContest",t.contest),this.$store.commit("setCriterias",t.criterias),this.$store.commit("setJudgingDone",t.judgingDone))},new((e=void 0)||(e=Promise))((function(n,o){function r(t){try{d(s.next(t))}catch(t){o(t)}}function a(t){try{d(s.throw(t))}catch(t){o(t)}}function d(t){var i;t.done?n(t.value):(i=t.value,i instanceof e?i:new e((function(t){t(i)}))).then(r,a)}d((s=s.apply(t,i||[])).next())}));var t,i,e,s},methods:{selectForEditing(t,i){this.$store.commit("setEditingSubmissionId",t),this.$store.commit("setEditingCriteriaId",i)},getJudgingToCriterias(t,i){const e=this.judgingDone.find((i=>i.submission.id===t));if(!e)return null;return e.judgingScores.find((t=>t.criteria.id===i))||null},getScore(t,i){const e=this.getJudgingToCriterias(t,i);return e?e.score:0},getTotalScore(t){const i=this.judgingDone.find((i=>i.submission.id===t));return i?i.judgingScores.reduce(((t,i)=>i.score+t),0):0},isCompleted(t){const i=this.judgingDone.find((i=>i.submission.id===t));return!!i&&i.judgingScores.length===this.criterias.length},sortSubmissionsBy(t,i){this.sortBy=t,this.sortDesc=!this.sortDesc,"criteria"===t&&i&&(this.sortByCriteria=i)}}});var h=(0,l.Z)(v,s,[],!1,null,null,null);h.options.__file="src/pages/JudgingPage.vue";const f=h.exports}}]);