var e,s,t=Object.defineProperty,n=Object.defineProperties,o=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,d=(e,s,n)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[s]=n,m=(e,s)=>{for(var t in s||(s={}))a.call(s,t)&&d(e,t,s[t]);if(i)for(var t of i(s))r.call(s,t)&&d(e,t,s[t]);return e};import{d as c,m as l,D as u,p,a as h,o as v,b,F as g,g as f,f as w,n as C,l as y,e as S,t as I,G as k,N as V,i as $,j as x,q as O,w as j,u as L}from"./vendor.7edd7468.js";(s=e||(e={}))[s.First=5]="First",s[s.Second=4]="Second",s[s.Third=3]="Third",s[s.Fourth=2]="Fourth",s[s.Fifth=1]="Fifth",s[s.None=0]="None";var N=c({name:"ScreeningVote",props:{submissionId:{type:String,required:!0},savedVote:{type:Number,default:0}},computed:m(m({},l({voteLoading:e=>e.voteLoading})),u(["usedVotes"])),methods:{async updateVote(s){this.$store.commit("setVoteLoading",!0),this.savedVote==s&&(s=e.None);const t=await this.$http.executePost("/screening/updateSubmission/"+this.submissionId,{vote:s});this.$http.isError(t)||this.$store.commit("updateSubmission",t),this.$store.commit("setVoteLoading",!1)}}});p("data-v-378b763d");const P=["disabled","onClick"];h(),N.render=function(e,s,t,n,o,i){return v(),b("div",null,[(v(),b(g,null,f(5,(s=>w("a",{key:s,class:C(["mx-1",{"disabled-star":e.usedVotes.includes(s)&&e.savedVote!=s||e.voteLoading}]),disabled:e.voteLoading,href:"#",onClick:y((t=>e.updateVote(s)),["prevent"])},[w("i",{class:C(["fa-star fas",{"text-warning":e.usedVotes.includes(s)&&e.savedVote==s}])},null,2)],10,P))),64))])},N.__scopeId="data-v-378b763d";var F=c({name:"ScreeningNotes",props:{submissionId:{type:String,required:!0},savedComment:{type:String,default:""}},data(){return{showCommentInput:!1,newComment:this.savedComment}},methods:{cancelUpdate(){this.showCommentInput=!this.showCommentInput,this.newComment=this.savedComment},async updateComment(e){if(this.savedComment!=this.newComment){const s=await this.$http.executePost("/screening/updateSubmission/"+this.submissionId,{comment:this.newComment.trim()},e);this.$http.isError(s)||(this.showCommentInput=!this.showCommentInput,this.$store.commit("updateSubmission",s))}else this.showCommentInput=!this.showCommentInput}}});const _={class:""},E=[w("i",{class:"fas fa-edit"},null,-1)],U={key:1,class:"small text-white-50"},q={class:"text-end"};F.render=function(e,s,t,n,o,i){return v(),b("div",_,[e.showCommentInput?S("",!0):(v(),b("a",{key:0,href:"#",onClick:s[0]||(s[0]=y((s=>e.showCommentInput=!e.showCommentInput),["prevent"]))},E)),e.showCommentInput?(v(),b(g,{key:2},[k(w("textarea",{"onUpdate:modelValue":s[1]||(s[1]=s=>e.newComment=s),class:"form-control form-control-sm",rows:"4",type:"text",placeholder:"map comments...",style:{overflow:"hidden","overflow-wrap":"break-word"},maxlength:"1000"},null,512),[[V,e.newComment,void 0,{trim:!0}]]),w("div",q,[w("button",{type:"button",class:"btn btn-sm btn-outline-info  mt-1",onClick:s[2]||(s[2]=s=>e.cancelUpdate())}," Cancel "),w("button",{type:"button",class:"btn btn-sm btn-outline-info  mt-1",onClick:s[3]||(s[3]=s=>e.updateComment(s))}," Save ")])],64)):(v(),b("span",U,I(e.newComment||"..."),1))])};var M,D,T=c({name:"SubmissionCard",components:{ScreeningVote:N,ScreeningNotes:F},props:{submission:{type:Object,required:!0}},computed:(M=m({},l(["loggedInUser"])),D={relatedScreening(){return this.submission.evaluations.find((e=>e.screener._id===this.loggedInUser.id))}},n(M,o(D)))});p("data-v-f9584124");const G={class:"col-sm-12 my-1"},R={class:"card-body p-2"},z={class:"row"},A={class:"col-sm-6"},B={class:"col-sm-6 text-end"},H={class:"row"},J={class:"col-sm"};h(),T.render=function(e,s,t,n,o,i){const a=$("screening-vote"),r=$("screening-notes");return v(),b("div",G,[w("div",{class:C(["card",e.relatedScreening&&e.relatedScreening.vote?"bg-vote":"bg-dark"])},[w("div",R,[w("div",z,[w("div",A,I(e.submission.name),1),w("div",B,[x(a,{"submission-id":e.submission.id,"saved-vote":e.relatedScreening&&e.relatedScreening.vote},null,8,["submission-id","saved-vote"])])]),w("div",H,[w("div",J,[x(r,{"submission-id":e.submission.id,"saved-comment":e.relatedScreening&&e.relatedScreening.comment},null,8,["submission-id","saved-comment"])])])])],2)])},T.__scopeId="data-v-f9584124";var K={state:{contests:[],voteLoading:!1},mutations:{setContests(e,s){e.contests=s},setVoteLoading(e,s){e.voteLoading=s},updateSubmission(e,s){let t=-1;const n=e.contests.findIndex((e=>{if(t=e.submissions.findIndex((e=>e.id===s.id)),-1!==t)return!0}));-1!==n&&-1!==t&&(e.contests[n].submissions[t]=s)}},getters:{usedVotes:(e,s,t)=>{const n=[];return e.contests.forEach((e=>{e.submissions.forEach((e=>{const s=e.evaluations.find((e=>{var s;return e.screener.id===(null==(s=t.loggedInUser)?void 0:s.id)}));s&&n.push(s.vote)}))})),n}}},Q=c({name:"ScreeningPage",components:{SubmissionCard:T},computed:l({contests:e=>e.screening.contests}),beforeCreate(){this.$store.hasModule("screening")||this.$store.registerModule("screening",K)},unmounted(){this.$store.hasModule("screening")&&this.$store.unregisterModule("screening")},async created(){const e=await this.$http.initialRequest("/screening/relevantInfo");this.$http.isError(e)||this.$store.commit("setContests",e.contests||[])}});const W={class:"row"},X={class:"col-sm"},Y={class:"my-2"},Z=["href"],ee={key:1,class:"ms-4"},se={key:0,class:"text-center p-3"};Q.render=function(e,s,t,n,o,i){const a=$("submission-card");return v(),b("div",null,[(v(!0),b(g,null,f(e.contests,(e=>(v(),b("div",{key:e.id,class:"container card card-body py-1"},[w("div",W,[w("div",X,[w("h4",Y,I(e.name),1),w("h5",null,[w("a",{href:e.download,target:"_blank"},I(e.download),9,Z)]),e.submissions.length?(v(),O(L,{key:0,name:"list",tag:"div",class:"row"},{default:j((()=>[(v(!0),b(g,null,f(e.submissions,(e=>(v(),O(a,{key:e.id,submission:e},null,8,["submission"])))),128))])),_:2},1024)):(v(),b("p",ee," No submissions... "))])])])))),128)),e.contests.length?S("",!0):(v(),b("div",se," No contests available for screening... "))])};export{Q as default};
