import{d as y,U as B,m as V,_ as I,o as m,c as C,w as k,a as e,i as r,e as l,r as M,t as u,F as $,k as g,j as h,y as U,p as c,P as E,b as p,f as b,v as D,n as A,O as P,s as T,u as L}from"./index-96f5eca7.js";import{M as R}from"./ModalDialog-abe26d3a.js";import{b as j,F as G,c as O}from"./FormTextarea-a6c0f66b.js";import{D as _}from"./DataTable-449c65c1.js";const z=y({name:"SubmitMissionModal",components:{ModalDialog:R,FormInput:j,FormSelect:G,FormTextarea:O},props:{isAdmin:Boolean},data(){return{modes:B,featuredArtists:[],selectedArtists:[],selectedArtistId:"",selectedMode:"",selectedModes:[],tier:"",deadline:"",objective:"",name:"",winCondition:"",userMaximumRankedBeatmapsCount:null,userMaximumGlobalRank:null,userMaximumPp:null,beatmapEarliestSubmissionDate:null,beatmapLatestSubmissionDate:null}},computed:{...V(["loggedInUser"])},async created(){const t=await this.$http.executeGet("/featuredArtists");t&&(this.featuredArtists=t.sort((s,i)=>s.label.toLowerCase()>i.label.toLowerCase()?1:i.label.toLowerCase()>s.label.toLowerCase()?-1:0))},methods:{addArtist(){if(this.selectedArtistId.length){const t=this.featuredArtists.findIndex(a=>a.id==this.selectedArtistId),s=this.featuredArtists[t],i={id:s.id,_id:s._id,label:s.label,osuId:s.osuId};this.selectedArtists.push(i)}},addMode(){this.selectedMode.length&&this.selectedModes.push(this.selectedMode)},removeArtist(t){const s=this.selectedArtists.findIndex(i=>i.id==t);this.selectedArtists.splice(s,1)},removeMode(t){const s=this.selectedModes.findIndex(i=>i==t);this.selectedModes.splice(s,1)},async addMission(t){if(typeof this.name=="number"){this.$store.dispatch("updateToastMessages",{message:"Choose a name that doesn't start with a number",type:"danger"});return}const s=await this.$http.executePost("/admin/missions/create",{artists:this.selectedArtists,tier:this.tier,name:this.name,deadline:this.deadline,objective:this.objective,modes:this.selectedModes,winCondition:this.winCondition,userMaximumRankedBeatmapsCount:this.userMaximumRankedBeatmapsCount,userMaximumGlobalRank:this.userMaximumGlobalRank,userMaximumPp:this.userMaximumPp,beatmapEarliestSubmissionDate:this.beatmapEarliestSubmissionDate,beatmapLatestSubmissionDate:this.beatmapLatestSubmissionDate},t);this.$http.isError(s)||(this.$store.commit("addMission",s),this.$bs.hideModal("submitMission"))}}}),W={class:"container"},N=e("h5",null,"General",-1),Q={class:"row"},q=e("option",{value:"-",disabled:""}," --- ",-1),F=["value"],H={class:"col-sm-1"},J={class:"small text-secondary"},K={key:0},X=["onClick"],Y=e("i",{class:"fas fa-minus"},null,-1),Z=[Y],ss={class:"row"},ts=e("option",{value:"-",disabled:""}," --- ",-1),es=["value"],is={class:"col-sm-1"},os={class:"mt-2"},ns={class:"small text-secondary"},as={key:0},ds=["onClick"],ms=e("i",{class:"fas fa-minus"},null,-1),ls=[ms],us=e("hr",null,null,-1),rs=e("h5",null,"User requirements",-1);function ps(t,s,i,a,w,v){const f=c("form-select"),d=c("form-input"),o=c("form-textarea"),S=c("modal-dialog");return m(),C(S,{id:"submitMission",title:"Submit mission"},{default:k(()=>[e("div",W,[N,e("div",Q,[r(f,{modelValue:t.selectedArtistId,"onUpdate:modelValue":s[0]||(s[0]=n=>t.selectedArtistId=n),class:"col-sm-11",label:"Artist",placeholder:"Any artist (selected by default)"},{default:k(()=>[q,(m(!0),l($,null,M(t.featuredArtists,n=>(m(),l("option",{key:n.id,value:n.id},u(n.label),9,F))),128))]),_:1},8,["modelValue"]),e("div",H,[e("button",{id:"artistButton",class:"btn btn-sm btn-outline-info",onClick:s[1]||(s[1]=n=>t.addArtist())}," Add ")])]),e("div",null,[e("ul",J,[t.selectedArtists.length?g("",!0):(m(),l("li",K," Any artist (selected by default) ")),(m(!0),l($,null,M(t.selectedArtists,n=>(m(),l("li",{key:n.osuId},[h(u(n.label)+" ",1),e("a",{href:"#",class:"text-danger",onClick:U(x=>t.removeArtist(n.id),["prevent"])},Z,8,X)]))),128))])]),e("div",ss,[r(f,{modelValue:t.selectedMode,"onUpdate:modelValue":s[2]||(s[2]=n=>t.selectedMode=n),class:"col-sm-11",label:"Mode",placeholder:"Any mode (selected by default)"},{default:k(()=>[ts,(m(!0),l($,null,M(t.modes,n=>(m(),l("option",{key:n,value:n},u(n),9,es))),128))]),_:1},8,["modelValue"]),e("div",is,[e("button",{id:"artistButton",class:"btn btn-sm btn-outline-info",onClick:s[3]||(s[3]=n=>t.addMode())}," Add ")])]),e("div",os,[e("ul",ns,[t.selectedModes.length?g("",!0):(m(),l("li",as," Any mode (selected by default) ")),(m(!0),l($,null,M(t.selectedModes,n=>(m(),l("li",{key:n},[h(u(n)+" ",1),e("a",{href:"#",class:"text-danger",onClick:U(x=>t.removeMode(n),["prevent"])},ls,8,ds)]))),128))])]),r(d,{modelValue:t.tier,"onUpdate:modelValue":s[4]||(s[4]=n=>t.tier=n),modelModifiers:{number:!0},label:"Tier",type:"number"},null,8,["modelValue"]),r(d,{modelValue:t.name,"onUpdate:modelValue":s[5]||(s[5]=n=>t.name=n),modelModifiers:{number:!0},label:"Name",type:"text"},null,8,["modelValue"]),r(o,{modelValue:t.objective,"onUpdate:modelValue":s[6]||(s[6]=n=>t.objective=n),label:"Objective"},null,8,["modelValue"]),r(o,{modelValue:t.winCondition,"onUpdate:modelValue":s[7]||(s[7]=n=>t.winCondition=n),label:"Win condition"},null,8,["modelValue"]),r(d,{modelValue:t.deadline,"onUpdate:modelValue":s[8]||(s[8]=n=>t.deadline=n),label:"Deadline",type:"date"},null,8,["modelValue"]),us,rs,r(d,{modelValue:t.userMaximumRankedBeatmapsCount,"onUpdate:modelValue":s[9]||(s[9]=n=>t.userMaximumRankedBeatmapsCount=n),modelModifiers:{number:!0},label:"Max ranked maps",type:"number"},null,8,["modelValue"]),r(d,{modelValue:t.userMaximumGlobalRank,"onUpdate:modelValue":s[10]||(s[10]=n=>t.userMaximumGlobalRank=n),modelModifiers:{number:!0},label:"Max global rank",type:"number"},null,8,["modelValue"]),r(d,{modelValue:t.userMaximumPp,"onUpdate:modelValue":s[11]||(s[11]=n=>t.userMaximumPp=n),modelModifiers:{number:!0},label:"Max pp",type:"number"},null,8,["modelValue"]),r(d,{modelValue:t.beatmapEarliestSubmissionDate,"onUpdate:modelValue":s[12]||(s[12]=n=>t.beatmapEarliestSubmissionDate=n),modelModifiers:{number:!0},label:"Earliest submission date",type:"date"},null,8,["modelValue"]),r(d,{modelValue:t.beatmapLatestSubmissionDate,"onUpdate:modelValue":s[13]||(s[13]=n=>t.beatmapLatestSubmissionDate=n),modelModifiers:{number:!0},label:"Latest submission date",type:"date"},null,8,["modelValue"]),e("button",{class:"btn btn-outline-success w-100",onClick:s[14]||(s[14]=n=>t.addMission(n))}," Add mission ")])]),_:1})}const cs=I(z,[["render",ps]]),bs={state:{missions:[]},mutations:{setMissions(t,s){t.missions=s},updateMission(t,s){const i=t.missions.findIndex(a=>a.id===s.id);i!==-1&&(t.missions[i]=s)},addMission(t,s){t.missions.push(s)},updateName(t,s){const i=t.missions.find(a=>a.id==s.missionId);i&&(i.name=s.name)},updateTier(t,s){const i=t.missions.find(a=>a.id==s.missionId);i&&(i.tier=s.tier)},updateObjective(t,s){const i=t.missions.find(a=>a.id==s.missionId);i&&(i.objective=s.objective)},updateStatus(t,s){const i=t.missions.find(a=>a.id==s.missionId);i&&(i.status=s.status)},updateWinCondition(t,s){const i=t.missions.find(a=>a.id==s.missionId);i&&(i.winCondition=s.winCondition)},updateOpeningAnnounced(t,s){const i=t.missions.find(a=>a.id==s.missionId);i&&(i.openingAnnounced=s.openingAnnounced)},updateClosingAnnounced(t,s){const i=t.missions.find(a=>a.id==s.missionId);i&&(i.closingAnnounced=s.closingAnnounced)},updateWinningBeatmaps(t,s){const i=t.missions.find(a=>a.id==s.missionId);i&&(i.winningBeatmaps=s.winningBeatmaps)},updateInvalidBeatmaps(t,s){const i=t.missions.find(a=>a.id==s.missionId);i&&(i.invalidBeatmaps=s.invalidBeatmaps)},updateAssociatedMaps(t,s){const i=t.missions.find(a=>a.id==s.missionId);i&&(i.associatedMaps=s.associatedMaps)},updateModes(t,s){const i=t.missions.find(a=>a.id==s.missionId);i&&(i.modes=s.modes)},updateArtists(t,s){const i=t.missions.find(a=>a.id==s.missionId);i&&(i.artists=s.artists)},updateUserMaximumRankedBeatmapsCount(t,s){const i=t.missions.find(a=>a.id==s.missionId);i&&(i.userMaximumRankedBeatmapsCount=s.userMaximumRankedBeatmapsCount)},updateUserMaximumGlobalRank(t,s){const i=t.missions.find(a=>a.id==s.missionId);i&&(i.userMaximumGlobalRank=s.userMaximumGlobalRank)},updateUserMaximumPp(t,s){const i=t.missions.find(a=>a.id==s.missionId);i&&(i.userMaximumPp=s.userMaximumPp)},updateBeatmapEarliestSubmissionDate(t,s){const i=t.missions.find(a=>a.id==s.missionId);i&&(i.beatmapEarliestSubmissionDate=s.beatmapEarliestSubmissionDate)},updateBeatmapLatestSubmissionDate(t,s){const i=t.missions.find(a=>a.id==s.missionId);i&&(i.beatmapLatestSubmissionDate=s.beatmapLatestSubmissionDate)},updateDeadline(t,s){const i=t.missions.find(a=>a.id==s.missionId);i&&(i.deadline=s.deadline)}}},hs=bs,fs=y({name:"MissionInfo",components:{AssociatedBeatmaps:E,ModalDialog:R},props:{mission:{type:Object,required:!0}},data(){return{availableArtists:[],availableModes:B,name:this.mission.name,tier:this.mission.tier,objective:this.mission.objective,winCondition:this.mission.winCondition,status:this.mission.status,mode:"",selectedArtist:{},artists:this.mission.artists,userMaximumRankedBeatmapsCount:this.mission.userMaximumRankedBeatmapsCount,userMaximumGlobalRank:this.mission.userMaximumGlobalRank,userMaximumPp:this.mission.userMaximumPp,beatmapEarliestSubmissionDate:new Date(this.mission.beatmapEarliestSubmissionDate),beatmapLatestSubmissionDate:new Date(this.mission.beatmapLatestSubmissionDate),deadline:new Date(this.mission.deadline)}},watch:{mission(){this.name=this.mission.name,this.tier=this.mission.tier,this.artists=this.mission.artists,this.objective=this.mission.objective,this.winCondition=this.mission.winCondition,this.status=this.mission.status,this.mode="",this.userMaximumRankedBeatmapsCount=this.mission.userMaximumRankedBeatmapsCount,this.userMaximumGlobalRank=this.mission.userMaximumGlobalRank,this.userMaximumPp=this.mission.userMaximumPp,this.beatmapEarliestSubmissionDate=new Date(this.mission.beatmapEarliestSubmissionDate),this.beatmapLatestSubmissionDate=new Date(this.mission.beatmapLatestSubmissionDate),this.deadline=new Date(this.mission.deadline)}},async created(){const t=await this.$http.executeGet("/featuredArtists");t&&(this.availableArtists=t.sort((s,i)=>s.label.toLowerCase()>i.label.toLowerCase()?1:i.label.toLowerCase()>s.label.toLowerCase()?-1:0))},methods:{async updateName(t){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/rename`,{name:this.name},t);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"renamed mission",type:"info"}),this.$store.commit("updateName",{missionId:this.mission.id,name:s}))},async updateTier(t){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/updateTier`,{tier:this.tier},t);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"updated tier",type:"info"}),this.$store.commit("updateTier",{missionId:this.mission.id,tier:s}))},async updateObjective(t){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/updateObjective/`,{objective:this.objective},t);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"updated objective",type:"info"}),this.$store.commit("updateObjective",{missionId:this.mission.id,objective:s}))},async updateStatus(t){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/updateStatus/`,{status:this.status},t);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"updated status",type:"info"}),this.$store.commit("updateStatus",{missionId:this.mission.id,status:s}))},async updateUserMaximumRankedBeatmapsCount(t){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/updateUserMaximumRankedBeatmapsCount/`,{userMaximumRankedBeatmapsCount:this.userMaximumRankedBeatmapsCount},t);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"updated user max ranked maps count for mission",type:"info"}),this.$store.commit("updateUserMaximumRankedBeatmapsCount",{missionId:this.mission.id,userMaximumRankedBeatmapsCount:s}))},async updateUserMaximumGlobalRank(t){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/updateUserMaximumGlobalRank/`,{userMaximumGlobalRank:this.userMaximumGlobalRank},t);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"updated user max global rank for mission",type:"info"}),this.$store.commit("updateUserMaximumGlobalRank",{missionId:this.mission.id,userMaximumGlobalRank:s}))},async updateUserMaximumPp(t){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/updateUserMaximumPp/`,{userMaximumPp:this.userMaximumPp},t);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"updated user max pp for mission",type:"info"}),this.$store.commit("updateUserMaximumPp",{missionId:this.mission.id,userMaximumPp:s}))},async updateBeatmapEarliestSubmissionDate(t){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/updateBeatmapEarliestSubmissionDate/`,{beatmapEarliestSubmissionDate:this.beatmapEarliestSubmissionDate},t);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"updated beatmap earliest submission date",type:"info"}),this.$store.commit("updateBeatmapEarliestSubmissionDate",{missionId:this.mission.id,beatmapEarliestSubmissionDate:s}))},async updateBeatmapLatestSubmissionDate(t){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/updateBeatmapLatestSubmissionDate/`,{beatmapLatestSubmissionDate:this.beatmapLatestSubmissionDate},t);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"updated beatmap latest submission date",type:"info"}),this.$store.commit("updateBeatmapLatestSubmissionDate",{missionId:this.mission.id,beatmapLatestSubmissionDate:s}))},async updateDeadline(t){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/updateDeadline/`,{deadline:this.deadline},t);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"updated deadline",type:"info"}),this.$store.commit("updateDeadline",{missionId:this.mission.id,deadline:s}))},async updateWinCondition(t){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/updateWinCondition/`,{winCondition:this.winCondition},t);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"updated win condition",type:"info"}),this.$store.commit("updateWinCondition",{missionId:this.mission.id,winCondition:s}))},async toggleOpeningAnnounced(t){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/toggleOpeningAnnounced/`,{openingAnnounced:!this.mission.openingAnnounced},t);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"toggled openingAnnounced",type:"info"}),this.$store.commit("updateOpeningAnnounced",{missionId:this.mission.id,openingAnnounced:s}))},async toggleClosingAnnounced(t){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/toggleClosingAnnounced/`,{closingAnnounced:!this.mission.closingAnnounced},t);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"toggled closingAnnounced",type:"info"}),this.$store.commit("updateClosingAnnounced",{missionId:this.mission.id,closingAnnounced:s}))},async toggleMode(t){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/toggleMode/`,{mode:this.mode},t);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"toggled mode",type:"info"}),this.$store.commit("updateModes",{missionId:this.mission.id,modes:s}))},async toggleArtist(t){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/toggleArtist/`,{artistLabel:this.selectedArtist},t);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"toggled artist",type:"info"}),this.$store.commit("updateArtists",{missionId:this.mission.id,artists:s}))}}}),gs={class:"container"},Ms={class:"row mt-2"},$s={class:"row mt-2"},ws={class:"row mt-2"},vs={class:"row mt-2"},ks={class:"row"},Cs=e("option",{value:"",disabled:""}," Select a status ",-1),As=e("option",{value:"hidden"}," Hidden ",-1),ys=e("option",{value:"open"}," Open ",-1),Is=e("option",{value:"closed"}," Closed ",-1),Ss=[Cs,As,ys,Is],Ds={class:"row"},Us=e("option",{value:"",disabled:""}," Select a mode ",-1),Vs={class:"w-25 mt-2"},Bs={key:0,class:"row"},Rs=e("option",{value:{},disabled:""}," Select an artist ",-1),xs={key:0,class:"w-25 mt-2"},Es={class:"row mt-2"},Ps={class:"small"},Ts={class:"row"},Ls={class:"col-sm-6 mt-2"},js={class:"row"},Gs={class:"col-sm-6 mt-2"},Os=e("hr",null,null,-1),_s=e("h5",null,"User requirements",-1),zs={class:"row"},Ws={class:"row mt-2"},Ns={class:"row mt-2"},Qs={class:"row mt-2"},qs={class:"small"},Fs={class:"row mt-2"},Hs={class:"small"};function Js(t,s,i,a,w,v){const f=c("associated-beatmaps"),d=c("modal-dialog");return m(),C(d,{id:"editMission"},{header:k(()=>[h(u(t.mission.name),1)]),default:k(()=>[e("div",gs,[e("div",Ms,[p(e("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>t.name=o),class:"form-control form-control-sm mx-2 w-50",type:"text",autocomplete:"off",placeholder:"mission name..."},null,512),[[b,t.name]]),e("button",{class:"btn btn-sm btn-outline-info w-25",onClick:s[1]||(s[1]=o=>t.updateName(o))}," Rename mission ")]),e("div",$s,[p(e("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>t.tier=o),class:"form-control form-control-sm mx-2 w-50",type:"text",autocomplete:"off",placeholder:"tier..."},null,512),[[b,t.tier]]),e("button",{class:"btn btn-sm btn-outline-info w-25",onClick:s[3]||(s[3]=o=>t.updateTier(o))}," Update tier ")]),e("div",ws,[p(e("textarea",{"onUpdate:modelValue":s[4]||(s[4]=o=>t.objective=o),class:"form-control form-control-sm mx-2 mt-2 w-50",type:"text",autocomplete:"off",placeholder:"mission objective..."},null,512),[[b,t.objective]]),e("button",{class:"btn btn-sm btn-outline-info w-25 mt-2",onClick:s[5]||(s[5]=o=>t.updateObjective(o))}," Update objective ")]),e("div",vs,[p(e("textarea",{"onUpdate:modelValue":s[6]||(s[6]=o=>t.winCondition=o),class:"form-control form-control-sm mx-2 mt-2 w-50",type:"text",autocomplete:"off",placeholder:"mission win condition..."},null,512),[[b,t.winCondition]]),e("button",{class:"btn btn-sm btn-outline-info w-25 mt-2",onClick:s[7]||(s[7]=o=>t.updateWinCondition(o))}," Update win condition ")]),e("div",ks,[p(e("select",{"onUpdate:modelValue":s[8]||(s[8]=o=>t.status=o),class:"form-select form-select-sm mx-2 mt-2 w-50"},Ss,512),[[D,t.status]]),e("button",{class:"btn btn-sm btn-outline-info mt-2 w-25",onClick:s[9]||(s[9]=o=>t.updateStatus(o))}," Update status ")]),e("div",Ds,[p(e("select",{"onUpdate:modelValue":s[10]||(s[10]=o=>t.mode=o),class:"form-select form-select-sm mx-2 mt-2 w-25"},[Us,(m(!0),l($,null,M(t.availableModes,o=>(m(),l("option",{key:o},u(o),1))),128))],512),[[D,t.mode]]),e("div",Vs,u(t.mission.modes),1),e("button",{class:"btn btn-sm btn-outline-info mt-2 w-25",onClick:s[11]||(s[11]=o=>t.toggleMode(o))}," Toggle mode ")]),t.availableArtists?(m(),l("div",Bs,[p(e("select",{"onUpdate:modelValue":s[12]||(s[12]=o=>t.selectedArtist=o),class:"form-select form-select-sm mx-2 mt-2 w-25"},[Rs,(m(!0),l($,null,M(t.availableArtists,o=>(m(),l("option",{key:o.id},u(o.label),1))),128))],512),[[D,t.selectedArtist]]),t.mission.artists&&t.mission.artists.length?(m(),l("div",xs,u(t.mission.artists.map(o=>o.label)),1)):g("",!0),e("button",{class:"btn btn-sm btn-outline-info mt-2 w-25",onClick:s[13]||(s[13]=o=>t.toggleArtist(o))}," Toggle artist ")])):g("",!0),e("div",Es,[p(e("input",{"onUpdate:modelValue":s[14]||(s[14]=o=>t.deadline=o),class:"form-control form-control-sm mx-2 w-50",type:"date",autocomplete:"off",placeholder:"deadline..."},null,512),[[b,t.deadline]]),e("button",{class:"btn btn-sm btn-outline-info w-25",onClick:s[15]||(s[15]=o=>t.updateDeadline(o))}," Update deadline "),e("span",Ps,[h("current: "),e("b",null,u(t.mission.deadline),1)])]),e("div",Ts,[e("div",Ls,[h(" Opening announced: "),e("span",{class:A(t.mission.openingAnnounced?"text-success":"text-danger")},u(t.mission.openingAnnounced),3)]),e("button",{class:"btn btn-sm btn-outline-info mt-2 ms-3 w-25",onClick:s[16]||(s[16]=o=>t.toggleOpeningAnnounced(o))}," Toggle openingAnnounced ")]),e("div",js,[e("div",Gs,[h(" Closing announced: "),e("span",{class:A(t.mission.closingAnnounced?"text-success":"text-danger")},u(t.mission.closingAnnounced),3)]),e("button",{class:"btn btn-sm btn-outline-info mt-2 ms-3 w-25",onClick:s[17]||(s[17]=o=>t.toggleClosingAnnounced(o))}," Toggle closingAnnounced ")]),Os,_s,e("div",zs,[p(e("input",{"onUpdate:modelValue":s[18]||(s[18]=o=>t.userMaximumRankedBeatmapsCount=o),class:"form-control form-control-sm mx-2 w-50",type:"text",autocomplete:"off",placeholder:"maximum ranked maps allowed..."},null,512),[[b,t.userMaximumRankedBeatmapsCount]]),e("button",{class:"btn btn-sm btn-outline-info w-25",onClick:s[19]||(s[19]=o=>t.updateUserMaximumRankedBeatmapsCount(o))}," Update user max ranked maps count ")]),e("div",Ws,[p(e("input",{"onUpdate:modelValue":s[20]||(s[20]=o=>t.userMaximumGlobalRank=o),class:"form-control form-control-sm mx-2 w-50",type:"number",autocomplete:"off",placeholder:"maximum global rank allowed..."},null,512),[[b,t.userMaximumGlobalRank]]),e("button",{class:"btn btn-sm btn-outline-info w-25",onClick:s[21]||(s[21]=o=>t.updateUserMaximumGlobalRank(o))}," Update user max global rank ")]),e("div",Ns,[p(e("input",{"onUpdate:modelValue":s[22]||(s[22]=o=>t.userMaximumPp=o),class:"form-control form-control-sm mx-2 w-50",type:"number",autocomplete:"off",placeholder:"maximum pp allowed..."},null,512),[[b,t.userMaximumPp]]),e("button",{class:"btn btn-sm btn-outline-info w-25",onClick:s[23]||(s[23]=o=>t.updateUserMaximumPp(o))}," Update user max pp ")]),e("div",Qs,[p(e("input",{"onUpdate:modelValue":s[24]||(s[24]=o=>t.beatmapEarliestSubmissionDate=o),class:"form-control form-control-sm mx-2 w-50",type:"date",autocomplete:"off",placeholder:"earliest submission date allowed..."},null,512),[[b,t.beatmapEarliestSubmissionDate]]),e("button",{class:"btn btn-sm btn-outline-info w-25",onClick:s[25]||(s[25]=o=>t.updateBeatmapEarliestSubmissionDate(o))}," Update beatmap earliest submission date "),e("span",qs,[h("current: "),e("b",null,u(t.mission.beatmapEarliestSubmissionDate),1)])]),e("div",Fs,[p(e("input",{"onUpdate:modelValue":s[26]||(s[26]=o=>t.beatmapLatestSubmissionDate=o),class:"form-control form-control-sm mx-2 w-50",type:"date",autocomplete:"off",placeholder:"latest submission date allowed..."},null,512),[[b,t.beatmapLatestSubmissionDate]]),e("button",{class:"btn btn-sm btn-outline-info w-25",onClick:s[27]||(s[27]=o=>t.updateBeatmapLatestSubmissionDate(o))}," Update beatmap latest submission date "),e("span",Hs,[h("current: "),e("b",null,u(t.mission.beatmapLatestSubmissionDate),1)])]),t.mission.associatedMaps&&t.mission.associatedMaps.length?(m(),C(f,{key:1,class:"my-4",mission:t.mission,"is-admin-page":!0},null,8,["mission"])):g("",!0)])]),_:1})}const Ks=I(fs,[["render",Js]]),Xs=y({name:"MissionWinners",computed:{...V({missions:t=>t.missionsAdmin.missions}),closedMissions(){return this.missions.filter(t=>t.status==P.Closed)}},methods:{loadWinners(){let t=[];for(const d of this.closedMissions)t=t.concat(d.winningBeatmaps);const s=t.map(d=>d.host);let a=s.map(d=>d.username).reduce(function(d,o){return d[o]?++d[o]:d[o]=1,d},{});const w=[],v=[];for(const d of s)v.includes(d.osuId)||(v.push(d.osuId),w.push({username:d.username,osuId:d.osuId,total:a[d.username],isQuestTrailblazer:d.isQuestTrailblazer}));return w.sort((d,o)=>o.total-d.total)},async toggleIsQuestTrailblazer(t,s){const i=await this.$http.executePost("/admin/missions/toggleIsQuestTrailblazer/",{userOsuId:t},s);this.$http.isError(i)||this.$store.dispatch("updateToastMessages",{message:"toggled isQuestTrailblazer, refresh to see changes",type:"info"})}}}),Ys={class:"container card card-body py-1 my-2"},Zs={key:0},st=["onClick"];function tt(t,s,i,a,w,v){const f=c("user-link");return m(),l("div",Ys,[(m(!0),l($,null,M(t.loadWinners(),d=>(m(),l("div",{key:d.osuId},[r(f,{user:d},null,8,["user"]),h(" - "+u(d.total)+" ",1),d.total>=3&&!d.isQuestTrailblazer?(m(),l("code",Zs,".add-badge "+u(d.osuId)+` questtrailblazer.png "Completed 3+ priority quests in the Mappers' Guild" https://osu.ppy.sh/wiki/en/Community/Mappers_Guild#additional-rewards`,1)):g("",!0),d.total>=3&&!d.isQuestTrailblazer?(m(),l("button",{key:1,class:"btn btn-outline-info btn-sm ms-2",href:"#",onClick:U(o=>t.toggleIsQuestTrailblazer(d.osuId,o),["prevent"])}," click this after giving user badge ",8,st)):g("",!0)]))),128))])}const et=I(Xs,[["render",tt]]),it=y({components:{DataTable:_,SubmitMissionModal:cs,MissionInfo:Ks,MissionWinners:et},data(){return{selectedMissionId:""}},computed:{...V({missions:t=>t.missionsAdmin.missions}),selectedMission(){return this.missions.find(t=>t.id===this.selectedMissionId)}},beforeCreate(){this.$store.hasModule("missionsAdmin")||this.$store.registerModule("missionsAdmin",hs)},unmounted(){this.$store.hasModule("missionsAdmin")&&this.$store.unregisterModule("missionsAdmin")},async created(){const t=await this.$http.initialRequest("/admin/missions/load");this.$http.isError(t)||this.$store.commit("setMissions",t)},methods:{updateMission(t){const s=this.missions.findIndex(i=>i.id==t.id);s!==-1&&(this.missions[s]=t)},findTierImage(t){switch(t){case 1:return"/images/bronze.png";case 2:return"/images/silver.png";case 3:return"/images/gold.png";case 4:return"/images/platinum.png";default:return"/images/bronze.png"}}}});const ot=t=>(T("data-v-e57f7ab8"),t=t(),L(),t),nt={class:"container card card-body py-1"},at={class:"row"},dt={class:"col"},mt=ot(()=>e("button",{class:"btn btn-sm btn-info w-100 mb-1","data-bs-toggle":"modal","data-bs-target":"#submitMission"}," Add mission ",-1)),lt=["src"];function ut(t,s,i,a,w,v){const f=c("data-table"),d=c("mission-winners"),o=c("submit-mission-modal"),S=c("mission-info");return m(),l("div",null,[e("div",nt,[e("div",at,[e("div",dt,[mt,r(f,{data:t.missions,headers:["name","tier","status","announce"],"custom-data-target":"#editMission","onUpdate:selectedId":s[0]||(s[0]=n=>t.selectedMissionId=n)},{default:k(({obj:n})=>[e("td",null,u(n.name),1),e("td",null,[e("img",{src:t.findTierImage(n.tier),class:"table-mission-tier"},null,8,lt)]),e("td",null,u(n.status),1),e("td",null,[e("span",{class:A(n.openingAnnounced?"text-success":"text-danger")},"open",2),h("/"),e("span",{class:A(n.closingAnnounced?"text-success":"text-danger")},"close",2)])]),_:1},8,["data"])])])]),r(d),r(o),t.selectedMission?(m(),C(S,{key:0,mission:t.selectedMission,onUpdateMission:s[1]||(s[1]=n=>t.updateMission(n))},null,8,["mission"])):g("",!0)])}const ht=I(it,[["render",ut],["__scopeId","data-v-e57f7ab8"]]);export{ht as default};
