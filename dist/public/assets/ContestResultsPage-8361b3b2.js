import{d as y,m as $,_ as k,o,e as n,a as e,k as a,t as l,j as w,y as R,l as g,F as m,f as h,b as f,r as v,q as j,n as T,C as J,c as C}from"./index-10894155.js";const N={state:{contest:null,submissions:[],submission:null},mutations:{setContest(s,t){s.contest=t},setSubmissions(s,t){s.submissions=t},setSubmission(s,t){s.submission=t}}},U=N,z=y({name:"SubmissionResult",computed:{...$({submission:s=>s.contestResults.submission,loggedInUser:s=>s.loggedInUser}),voteCount(){let s=0;return this.submission.screenings.forEach(t=>{isNaN(t.vote)||(s+=t.vote)}),s},emptyScreeningCount(){return this.submission.contest.screeners.length-this.submission.screenings.length},randomizedJudging(){let s=[...this.submission.judgings];return s=s.sort(()=>Math.random()-.5),s},randomizedScreening(){let s=[...this.submission.screenings];return s=s.sort(()=>Math.random()-.5),s}},methods:{findTotalJudgingPoints(s){let t=0;return s.forEach(r=>{t+=r.score}),t},findTotalCriteriaPoints(s){let t=0;return s.forEach(r=>{t+=r.criteria.maxScore}),t},findJudgeComment(s){let t="";return s.forEach(r=>{r.criteria.name=="comments"&&(t=r.comment)}),t},filteredAndSortedJudgingScores(s){s=s.filter(r=>r.criteria.name!="comments");const t=["musical representation","creativity","limitation","gameplay"];return[...s].sort(function(r,c){return t.indexOf(r.criteria.name)-t.indexOf(c.criteria.name)})}}}),M={key:0,class:"container p-3"},E=["href"],P=e("i",{class:"fa fa-arrow-left"},null,-1),V={key:0},q={key:1,class:"mt-2"},A=["href"],I=e("hr",null,null,-1),D={class:"mx-2"},B=e("h5",null," Screening results ",-1),O={key:0},F=e("p",{class:"ms-3"}," Comments are usually each screener's initial thoughts. They're not intended to be constructive feedback and many screeners use comments as notes for determining their top 5. ",-1),L={class:"ms-3"},G={key:0,class:"fas fa-check text-done"},Y={class:"ms-4 mb-2 small text-secondary",style:{"word-break":"break-word"}},H={class:"ms-3"},K=e("div",{class:"ms-4 mb-2 small text-secondary",style:{"word-break":"break-word"}}," [no comment] ",-1),Q={key:1,class:"ms-3"},W=e("hr",null,null,-1),X={class:"mx-2"},Z=e("h5",null," Judging results ",-1),x={key:0},ss={class:"ms-3"},es={class:"row ms-3"},ts={class:"col-sm-5"},os={class:"table table-sm table-responsive-sm"},ns=e("thead",null,[e("tr",null,[e("th",{class:"text-start"}," Category "),e("th",{class:"text-start"}," Score ")])],-1),is={class:"text-start text-capitalize"},rs={class:"text-start"},ls=e("td",{class:"text-start"}," TOTAL ",-1),cs={class:"text-start"},as={class:"col-sm-7 small"},us={class:"text-secondary",style:{"white-space":"pre-line"}},ds={key:1,class:"ms-3"};function ms(s,t,r,c,u,S){const p=v("user-link"),d=j("bs-tooltip");return o(),n("div",null,[s.submission?(o(),n("div",M,[e("div",null,[e("h3",null,[e("a",{href:"/contests/results?contest="+s.submission.contest.id},[P,a(" "+l(s.submission.contest.name),1)],8,E)]),e("h4",null,[a(" Submission by "),w(p,{user:s.submission.creator},null,8,["user"])]),e("h5",null,' Anonymized as "'+l(s.submission.name)+'" ',1),s.loggedInUser&&s.loggedInUser.id==s.submission.creator.id?(o(),n("div",V,[e("a",{href:"#",onClick:t[0]||(t[0]=R(i=>s.$store.commit("setSubmission",null),["prevent"]))}," Your other contest submissions ")])):g("",!0),s.submission.contest.download?(o(),n("div",q,[e("div",null,[e("a",{href:s.submission.contest.download,target:"_blank"}," Download all submissions ",8,A)])])):g("",!0)]),I,e("div",D,[B,s.submission.screenings&&s.submission.screenings.length?(o(),n("div",O,[F,(o(!0),n(m,null,h(s.randomizedScreening,(i,_)=>(o(),n("div",{key:i.id},[e("div",null,[e("div",L,[a(" User "+l(_+1)+" ",1),i.vote?f((o(),n("i",G,null,512)),[[d,"user placed in top 5"]]):g("",!0)]),e("div",Y,l(i.comment?i.comment:"[no comment]"),1)])]))),128)),(o(!0),n(m,null,h(s.emptyScreeningCount,i=>(o(),n("div",{key:i},[e("div",null,[e("div",H," User "+l(s.submission.screenings.length+i),1),K])]))),128))])):(o(),n("div",Q," This contest skipped screening. "))]),W,e("div",X,[Z,s.submission.judgings&&s.submission.judgings.length?(o(),n("div",x,[(o(!0),n(m,null,h(s.randomizedJudging,(i,_)=>(o(),n("div",{key:i.id},[e("div",null,[e("p",ss," User "+l(_+1),1),e("div",es,[e("div",ts,[e("table",os,[ns,e("tbody",null,[(o(!0),n(m,null,h(s.filteredAndSortedJudgingScores(i.judgingScores),b=>(o(),n("tr",{key:b.id},[e("td",is,l(b.criteria.name),1),e("td",rs,l(b.score)+"/"+l(b.criteria.maxScore),1)]))),128)),e("tr",null,[ls,e("td",cs,l(s.findTotalJudgingPoints(i.judgingScores))+"/"+l(s.findTotalCriteriaPoints(i.judgingScores)),1)])])])]),e("div",as,[a(" Comment: "),e("span",us,l(s.findJudgeComment(i.judgingScores)),1)])])])]))),128))])):(o(),n("div",ds," This entry did not receive enough screening votes to reach the judging stage. :( "))])])):g("",!0)])}const hs=k(z,[["render",ms]]),_s=y({name:"ContestResults",computed:{...$({contest:s=>s.contestResults.contest}),maxScore(){let s=0;for(const t of this.contest.criterias)s+=t.maxScore;return s*this.contest.judges.length},sortedSubmissions(){return[...this.contest.submissions].sort((s,t)=>{const r=this.judgeScore(s.judgings);return this.judgeScore(t.judgings)-r})}},methods:{voteCount(s,t){let r=0;for(const c of s)c.vote&&!isNaN(c.vote)&&(t?r+=c.vote:r++);return r},judgeScore(s){let t=0;for(const r of s)for(const c of r.judgingScores)t+=c.score;return t==0?"N/A":t}}}),gs={key:0,class:"container p-3"},ps=["href"],bs={key:1},fs=["href"],vs={class:"table table-sm"},ys={scope:"col"},$s=e("th",{scope:"col"}," Creator ",-1),ks={scope:"col"},Ss={scope:"col"},Cs={scope:"row"},ws=["href"],Rs=e("i",{class:"fa fa-arrow-right"},null,-1),js={scope:"row"},Ts={key:0},Js=e("i",{class:"fas fa-check text-done me-1"},null,-1),Ns=[Js],Us={key:0},zs={key:1};function Ms(s,t,r,c,u,S){const p=v("user-link"),d=j("bs-tooltip");return o(),n("div",null,[s.contest?(o(),n("div",gs,[e("h4",null,[s.contest.url||s.contest.resultsUrl?(o(),n("a",{key:0,href:s.contest.resultsUrl?s.contest.resultsUrl:s.contest.url,target:"_blank"},l(s.contest.name)+" results ",9,ps)):(o(),n("span",bs,l(s.contest.name)+" results",1))]),e("div",null,[e("a",{href:s.contest.download,target:"_blank"}," Download all submissions ",8,fs)]),e("table",vs,[e("thead",null,[e("tr",null,[f((o(),n("th",ys,[a(" Submission ")])),[[d,"anonymized name seen by screeners/judges"]]),$s,f((o(),n("th",ks,[a(" Screener votes ("+l(s.contest.screeners.length*5)+") ",1)])),[[d,"screeners sort entries in their ordered top 5. #1 adds 5 points, #2 adds 4 points, etc."]]),f((o(),n("th",Ss,[a(" Judge scores ("+l(s.maxScore)+") ",1)])),[[d,"see results news/forum post for cases where standardized scores affect outcome"]])])]),e("tbody",null,[(o(!0),n(m,null,h(s.sortedSubmissions,i=>(o(),n("tr",{key:i.id+"screen"},[e("td",Cs,[e("a",{href:"/contests/results?submission="+i.id},[a(l(i.name)+" ",1),Rs],8,ws)]),e("td",js,[w(p,{user:i.creator},null,8,["user"])]),s.contest.judgingThreshold?(o(),n("td",Ts,[(o(!0),n(m,null,h(s.voteCount(i.screenings),_=>(o(),n("span",{key:_},Ns))),128)),s.voteCount(i.screenings,!0)>0?(o(),n("span",Us," ("+l(s.voteCount(i.screenings,!0))+") ",1)):g("",!0)])):(o(),n("td",zs," N/A ")),e("td",null,[e("span",{class:T(s.judgeScore(i.judgings)>0?"text-done":"")},l(s.judgeScore(i.judgings)),3)])]))),128))])])])):g("",!0)])}const Es=k(_s,[["render",Ms]]),Ps=y({name:"ContestResultsPage",components:{SubmissionResult:hs,ContestResults:Es},computed:{...$({contest:s=>s.contestResults.contest,submissions:s=>s.contestResults.submissions,submission:s=>s.contestResults.submission})},beforeCreate(){this.$store.hasModule("contestResults")||this.$store.registerModule("contestResults",U)},unmounted(){this.$store.hasModule("contestResults")&&this.$store.unregisterModule("contestResults")},async created(){const s=this.$route.query.contest,t=this.$route.query.submission;let r,c,u;s?(r=await this.$http.initialRequest("/contests/results/searchContest/"+s),this.$http.isError(r)||this.setContest(r)):t?([u,c]=await Promise.all([this.$http.initialRequest("/contests/results/searchSubmission/"+t),this.$http.executeGet("/contests/results/participated")]),!u||this.$http.isError(u)?this.$router.replace("/contests/results"):this.setSubmission(u)):c=await this.$http.initialRequest("/contests/results/participated"),this.$http.isError(c)||this.setSubmissions(c)},methods:{...J(["setContest","setSubmissions","setSubmission"])}}),Vs={class:"container card card-body"},qs={key:2,class:"row"},As=["onClick"],Is={class:"card card-hover card-level-2 card-body"},Ds={key:3,class:"text-center"};function Bs(s,t,r,c,u,S){const p=v("contest-results"),d=v("submission-result");return o(),n("div",Vs,[s.contest?(o(),C(p,{key:0})):s.submission?(o(),C(d,{key:1})):s.submissions.length?(o(),n("div",qs,[(o(!0),n(m,null,h(s.submissions,i=>(o(),n("div",{key:i.id,class:"col-sm-4 my-2",onClick:_=>s.setSubmission(i)},[e("div",Is,[e("p",null,l(i.contest.name),1),e("a",{href:"#",class:"text-secondary small text-end",onClick:t[0]||(t[0]=R(()=>{},["prevent"]))}," details ")])],8,As))),128))])):(o(),n("div",Ds," Contests you participated in will show up here! "))])}const Fs=k(Ps,[["render",Bs]]);export{Fs as default};
