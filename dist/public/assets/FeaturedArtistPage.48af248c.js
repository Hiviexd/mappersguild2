var t=Object.defineProperty,e=Object.defineProperties,s=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(e,s,a)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[s]=a;import{d,i as n,o as u,q as l,w as c,b as p,t as f,k as h,f as m,G as g,N as A,H as b,g as I,F as $,m as S,j as w}from"./vendor.cb33bf1d.js";import{_ as y}from"./ModalDialog.0d82a3c5.js";import{_ as v}from"./DataTable.26a71e50.js";var x=d({name:"FeaturedArtistInfo",components:{ModalDialog:y},props:{featuredArtist:{type:Object,default:null}},data:()=>({osuId:0,name:"",status:"",selectedSong:null,artist:"",title:""}),computed:{alphabeticalSongs(){return[...this.featuredArtist.songs].sort(((t,e)=>t.title.toLowerCase()>e.title.toLowerCase()?1:e.title.toLowerCase()>t.title.toLowerCase()?-1:0))}},watch:{featuredArtist(){this.osuId=this.featuredArtist.osuId,this.name=this.featuredArtist.label,this.status=this.featuredArtist.status,this.title=""},selectedSong(){this.selectedSong&&(this.artist=this.selectedSong.artist,this.title=this.selectedSong.title)}},methods:{async updateOsuId(t){const e=await this.$http.executePost(`/admin/featuredArtists/${this.featuredArtist.id}/updateOsuId`,{osuId:this.osuId},t);this.$http.isError(e)||(this.$store.dispatch("updateToastMessages",{message:"updated osu id",type:"info"}),this.$store.commit("updateOsuId",{featuredArtistId:this.featuredArtist.id,osuId:e})),await this.$http.executePost("/artists/toggleIsUpToDate/"+this.featuredArtist.id,{value:!0})},async updateName(t){const e=await this.$http.executePost(`/admin/featuredArtists/${this.featuredArtist.id}/updateName`,{name:this.name},t);this.$http.isError(e)||(this.$store.dispatch("updateToastMessages",{message:"updated name",type:"info"}),this.$store.commit("updateName",{featuredArtistId:this.featuredArtist.id,name:e}))},async updateStatus(t){const e=await this.$http.executePost(`/admin/featuredArtists/${this.featuredArtist.id}/updateStatus`,{status:this.status},t);this.$http.isError(e)||(this.$store.dispatch("updateToastMessages",{message:"updated status",type:"info"}),this.$store.commit("updateStatus",{featuredArtistId:this.featuredArtist.id,status:e}))},async addSong(t){const e=await this.$http.executePost(`/admin/featuredArtists/${this.featuredArtist.id}/songs/create`,{artist:this.artist,title:this.title},t);this.$http.isError(e)||(this.$store.dispatch("updateToastMessages",{message:"added song",type:"info"}),this.$store.commit("addSong",{featuredArtistId:this.featuredArtist.id,song:e}))},async editSong(t){if(!this.selectedSong)return void this.$store.dispatch("updateToastMessages",{message:"Select a song"});const e=await this.$http.executePost(`/admin/featuredArtists/${this.featuredArtist.id}/songs/${this.selectedSong.id}/update`,{artist:this.artist,title:this.title},t);this.$http.isError(e)||(this.$store.dispatch("updateToastMessages",{message:"updated song",type:"info"}),this.$store.commit("updateSong",{featuredArtistId:this.featuredArtist.id,song:e}))},async deleteSong(t){if(!this.selectedSong)return void this.$store.dispatch("updateToastMessages",{message:"Select a song"});const e=await this.$http.executePost(`/admin/featuredArtists/${this.featuredArtist.id}/songs/${this.selectedSong.id}/delete`,{},t);this.$http.isError(e)||(this.$store.dispatch("updateToastMessages",{message:"deleted song",type:"info"}),this.$store.commit("deleteSong",{featuredArtistId:this.featuredArtist.id,songId:this.selectedSong.id}))}}});const O=["href"],k={key:1},M={class:"container"},P={class:"row"},T={class:"row"},j={class:"row"},C=[m("option",{value:"public"}," Public ",-1),m("option",{value:"private"}," Private ",-1),m("option",{value:"showcase"}," Showcase ",-1)],F=m("hr",null,null,-1),E={class:"row"},D=["value"],U={class:"row"},N={class:"row"};x.render=function(t,e,s,a,i,o){const r=n("modal-dialog");return u(),l(r,{id:"edit",loaded:Boolean(t.featuredArtist)},{header:c((()=>[t.featuredArtist.osuId?(u(),p("a",{key:0,href:"https://osu.ppy.sh/beatmaps/artists/"+t.featuredArtist.osuId,target:"_blank"},f(t.featuredArtist.label),9,O)):(u(),p("span",k,f(t.featuredArtist.label),1)),h(" ("+f(t.featuredArtist.songs.length)+") ",1)])),default:c((()=>[m("div",M,[m("p",P,[g(m("input",{"onUpdate:modelValue":e[0]||(e[0]=e=>t.osuId=e),class:"form-control form-control-sm mx-2 w-50",type:"text",autocomplete:"off",placeholder:"osu id..."},null,512),[[A,t.osuId]]),m("button",{class:"btn btn-sm btn-outline-info w-25",onClick:e[1]||(e[1]=e=>t.updateOsuId(e))}," Save osu! ID ")]),m("p",T,[g(m("input",{"onUpdate:modelValue":e[2]||(e[2]=e=>t.name=e),class:"form-control form-control-sm mx-2 w-50",type:"text",autocomplete:"off",placeholder:"artist name..."},null,512),[[A,t.name]]),m("button",{class:"btn btn-sm btn-outline-info w-25",onClick:e[3]||(e[3]=e=>t.updateName(e))}," Save name ")]),m("p",j,[g(m("select",{"onUpdate:modelValue":e[4]||(e[4]=e=>t.status=e),class:"form-select form-select-sm w-50 mx-2"},C,512),[[b,t.status]]),m("button",{class:"btn btn-sm btn-outline-info w-25",onClick:e[5]||(e[5]=e=>t.updateStatus(e))}," Save status ")]),F,m("p",E,[g(m("select",{id:"editSongSelection","onUpdate:modelValue":e[6]||(e[6]=e=>t.selectedSong=e),class:"form-select form-select-sm"},[(u(!0),p($,null,I(t.alphabeticalSongs,(t=>(u(),p("option",{key:t.id,value:t},f(t.title)+" --- ("+f(t.artist)+") ",9,D)))),128))],512),[[b,t.selectedSong]])]),m("p",U,[g(m("input",{"onUpdate:modelValue":e[7]||(e[7]=e=>t.artist=e),class:"form-control form-control-sm mx-2 w-75",type:"text",autocomplete:"off",placeholder:"artist..."},null,512),[[A,t.artist]])]),m("p",N,[g(m("input",{"onUpdate:modelValue":e[8]||(e[8]=e=>t.title=e),class:"form-control form-control-sm mx-2 w-75",type:"text",autocomplete:"off",placeholder:"title..."},null,512),[[A,t.title]])]),m("p",null,[m("button",{class:"btn btn-sm btn-outline-info mx-1",onClick:e[9]||(e[9]=e=>t.addSong(e))}," Add song "),m("button",{class:"btn btn-sm btn-outline-info mx-1",onClick:e[10]||(e[10]=e=>t.editSong(e))}," Edit song "),m("button",{class:"btn btn-sm btn-outline-danger mx-1",onClick:e[11]||(e[11]=e=>t.deleteSong(e))}," Delete song ")])])])),_:1},8,["loaded"])};var V,_,L={state:{featuredArtists:[]},mutations:{setFeaturedArtists(t,e){t.featuredArtists=e},updateOsuId(t,e){const s=t.featuredArtists.find((t=>t.id==e.featuredArtistId));s&&(s.osuId=e.osuId)},updateName(t,e){const s=t.featuredArtists.find((t=>t.id==e.featuredArtistId));s&&(s.label=e.name)},addSong(t,e){const s=t.featuredArtists.find((t=>t.id==e.featuredArtistId));s&&s.songs.push(e.song)},updateSong(t,e){const s=t.featuredArtists.find((t=>t.id==e.featuredArtistId));if(s){const t=s.songs.findIndex((t=>t.id==e.song.id));-1!==t&&(s.songs[t]=e.song)}},deleteSong(t,e){const s=t.featuredArtists.find((t=>t.id==e.featuredArtistId));if(s){const t=s.songs.findIndex((t=>t.id==e.songId));-1!==t&&s.songs.splice(t,1)}}}},q=d({components:{DataTable:v,FeaturedArtistInfo:x},data:()=>({selectedFeaturedArtistId:""}),computed:(V=((t,e)=>{for(var s in e||(e={}))i.call(e,s)&&r(t,s,e[s]);if(a)for(var s of a(e))o.call(e,s)&&r(t,s,e[s]);return t})({},S({featuredArtists:t=>t.artistsAdmin.featuredArtists})),_={selectedFeaturedArtist(){return this.featuredArtists.find((t=>t.id===this.selectedFeaturedArtistId))}},e(V,s(_))),beforeCreate(){this.$store.hasModule("artistsAdmin")||this.$store.registerModule("artistsAdmin",L)},unmounted(){this.$store.hasModule("artistsAdmin")&&this.$store.unregisterModule("artistsAdmin")},async created(){const t=await this.$http.initialRequest("/admin/featuredArtists/load");this.$http.isError(t)||this.$store.commit("setFeaturedArtists",t)}});const R={class:"container card card-body py-1"},B={class:"row"},G={class:"col-sm"},H=["href"],z={key:1};q.render=function(t,e,s,a,i,o){const r=n("data-table"),d=n("featured-artist-info");return u(),p("div",null,[m("div",R,[m("div",B,[m("div",G,[w(r,{data:t.featuredArtists,headers:["ARTIST"],"onUpdate:selectedId":e[0]||(e[0]=e=>t.selectedFeaturedArtistId=e)},{default:c((({obj:t})=>[m("td",null,[t.osuId?(u(),p("a",{key:0,href:"https://osu.ppy.sh/beatmaps/artists/"+t.osuId,target:"_blank"},f(t.label),9,H)):(u(),p("span",z,f(t.label),1))])])),_:1},8,["data"])])])]),w(d,{"featured-artist":t.selectedFeaturedArtist},null,8,["featured-artist"])])};export{q as default};
