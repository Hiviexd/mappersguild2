import{N as q,d as y,O as S,P as E,R as D,m as f,A as V,V as M,_ as v,o as n,c as _,w as C,a as e,j as t,t as g,e as m,k as b,i as u,q as r,u as T,x as B,W as P,z as $,y as N,X as U,F,r as x}from"./index-1f62f7df.js";import{F as A,M as z}from"./extras-b15ff8cd.js";import{M as G}from"./ModalDialog-43f64de1.js";import{F as O}from"./FilterBox-aaa5afb5.js";const R={namespaced:!0,state:{filterValue:"",filterMode:"",selectedMissionId:null,missions:[],userBeatmaps:[],isLoadingMissions:!0,isFirstLoadDone:!1,exampleMission:null},mutations:{setFirstLoadDone(s){s.isFirstLoadDone=!0},setMissions(s,i){s.missions=i},addMissions(s,i){s.missions=s.missions.concat(i)},addMissionIfNotExists(s,i){s.missions.some(l=>l.id===i.id)||s.missions.push(i)},setUserBeatmaps(s,i){s.userBeatmaps=i},setFilterValue(s,i){s.filterValue=i},setExampleMission(s,i){s.exampleMission=i},setFilterMode(s,i){s.filterMode=i},setSelectedMissionId(s,i){s.selectedMissionId=i},updateMission(s,i){const o=s.missions.findIndex(l=>l.id===i.id);o!==-1&&(s.missions[o]=i)}},getters:{filteredMissions:s=>{let i=[...s.missions];if(s.filterMode!==A.any){const o=s.filterMode;i=i.filter(l=>l.modes&&l.modes.includes(o))}return s.filterValue.length>2&&(i=i.filter(o=>o.name.toLowerCase().includes(s.filterValue.toLowerCase()))),i},openMissions:(s,i)=>i.filteredMissions.filter(o=>o.status==q.Open&&!o.isSeparate),separateMissions:(s,i)=>i.filteredMissions.filter(o=>o.status==q.Open&&o.isSeparate),closedMissions:(s,i)=>i.filteredMissions.filter(o=>o.status==q.Closed),selectedMission:s=>s.missions.find(i=>i.id===s.selectedMissionId)},actions:{updateFilterValue({commit:s},i){s("setFilterValue",i)},updateFilterMode({commit:s},i){s("setFilterValue",""),s("setFilterMode",i)}}},Y=R,j=y({name:"MissionCard",components:{AssociatedBeatmaps:S,AddBeatmapToMission:E,MissionDetails:D,ModalDialog:G},computed:{...f(["loggedInUser"]),...V("missions",["selectedMission"]),findTierImage(){switch(this.selectedMission.tier){case 1:return"/images/bronze.png";case 2:return"/images/silver.png";case 3:return"/images/gold.png";case 4:return"/images/platinum.png";default:return"/images/bronze.png"}},cleanModes(){const s=[];for(const i of this.selectedMission.modes)switch(i){case M.Osu:s.push("osu!");break;case M.Taiko:s.push("osu!taiko");break;case M.Catch:s.push("osu!catch");break;case M.Mania:s.push("osu!mania");break}return s}}});const L=s=>(T("data-v-19b06947"),s=s(),B(),s),H=["href"],W={key:0,class:"text-primary small"},Q={class:"container"},X={class:"text-center"},J=["src"],K={class:"fs-4"},Z=L(()=>e("hr",null,null,-1)),ss=L(()=>e("hr",null,null,-1));function es(s,i,o,l,w,k){const p=r("mission-details"),h=r("add-beatmap-to-mission"),c=r("associated-beatmaps"),I=r("modal-dialog");return n(),_(I,{id:"editMission","header-class":`bg-rank-${s.selectedMission?s.selectedMission.tier:1}`,loaded:!!s.selectedMission},{header:C(()=>[e("a",{href:`/missions?id=${s.selectedMission.id}`,target:"_blank",class:"text-dark"},[t(g(s.selectedMission.name)+" ",1),s.selectedMission.modes&&s.selectedMission.modes.length&&s.selectedMission.modes.length<4?(n(),m("span",W,"("+g(s.cleanModes.join(", ")+" only")+")",1)):b("",!0)],8,H)]),default:C(()=>[e("div",Q,[e("div",X,[e("img",{src:s.findTierImage,class:"info-mission-tier"},null,8,J),e("div",K,[e("b",null,g(s.selectedMission.name.trim()),1)]),e("div",null,[e("b",null,"Tier "+g(s.selectedMission.tier),1),t(" priority quest")]),Z]),u(p,{mission:s.selectedMission},null,8,["mission"]),ss,e("div",null,[s.selectedMission.status=="open"?(n(),_(h,{key:0,mission:s.selectedMission},null,8,["mission"])):b("",!0),u(c,{mission:s.selectedMission},null,8,["mission"])])])]),_:1},8,["header-class","loaded"])}const is=v(j,[["render",es],["__scopeId","data-v-19b06947"]]),os=y({name:"MissionInformation",components:{ExampleMission:P},computed:{...f("missions",["exampleMission"])}});const a=s=>(T("data-v-4530def1"),s=s(),B(),s),ts={class:"container card card-body py-3 mb-2"},ns=a(()=>e("i",{class:"fas fa-angle-down"},null,-1)),as={id:"missionInformation",class:"collapse ms-4 mb-2"},ls=a(()=>e("div",{class:"small text-secondary"},[t(" Priority quests differ from "),e("a",{href:"/quests"},"normal quests"),t(" in a few ways: "),e("ol",null,[e("li",null,[e("b",null,"You don't need to claim a priority quest to participate."),t(" You only need to make a map and connect it to the quest!")]),e("li",null,[e("b",null,"Some priority quests have user-specific requirements."),t(" These generally aim to give newer mappers an opportunity to get involved, like only allowing users without ranked maps to participate.")]),e("li",null,[e("b",null,"Multiple users can complete the same quest."),t(" This depends on the quest's win condition.")])]),t(" Here's a breakdown of this example priority quest: ")],-1)),rs=a(()=>e("i",{class:"fas fa-angle-down"},null,-1)),ds={id:"missionRewards",class:"collapse ms-4 mb-2 small text-secondary"},cs=a(()=>e("b",null,"The host",-1)),ms=a(()=>e("li",null,[e("b",null,"Progress towards a profile badge specific to priority quests."),t(" You'll need to host 3 beatmapsets that complete priority quests to earn the badge!")],-1)),us=["src"],ps=a(()=>e("li",null,[e("b",null,"Customized mapping keychain for each priority quest completed:")],-1)),hs={class:"row"},_s={class:"col-sm-4"},fs=["src"],Ms=a(()=>e("ul",null,[e("li",null," Front: Pattern from your beatmap. "),e("li",null," Back: Your username and Mappers' Guild logos. "),e("li",null," Depending on your country, shipping may be difficult (or even impossible). These are being made and shipped individually by pishifat, so don't expect the efficiency of a professional company! ")],-1)),gs={class:"col-sm-6"},bs=["src"],$s=a(()=>e("b",null,"All users",-1)),ys=a(()=>e("li",null,[e("b",null,"+2 bonus points per difficulty on a ranked beatmap."),t(" This scales with length, so longer maps earn more points")],-1)),vs=a(()=>e("li",null,[e("b",null,"Variable points for completing a priority quest."),t(" This depends on the quest's difficulty tier:")],-1)),ws=["src"],ks=a(()=>e("b",null,"Tier 1:",-1)),Is=["src"],qs=a(()=>e("b",null,"Tier 2:",-1)),Fs=["src"],xs=a(()=>e("b",null,"Tier 3:",-1)),Cs=["src"],Vs=a(()=>e("b",null,"Tier 4:",-1));function Ts(s,i,o,l,w,k){const p=r("example-mission");return n(),m("div",ts,[e("a",{href:"#missionInformation","data-bs-toggle":"collapse",onClick:i[0]||(i[0]=$(()=>{},["prevent"]))},[t(" How do priority quests work? "),ns]),e("div",as,[ls,u(p,{mission:s.exampleMission},null,8,["mission"])]),e("a",{href:"#missionRewards","data-bs-toggle":"collapse",onClick:i[1]||(i[1]=$(()=>{},["prevent"]))},[t(" What are the rewards for completing a priority quest? "),rs]),e("div",ds,[cs,t(" of a beatmap that completes a priority quest earns: "),e("ul",null,[ms,e("img",{class:"ms-2 text-center rounded",src:"/images/questbadge.png"},null,8,us),ps,e("div",hs,[e("div",_s,[e("img",{class:"text-center w-100 ms-2 rounded",src:"/images/examplemap.png"},null,8,fs),Ms]),e("div",gs,[e("img",{class:"ms-2 text-center w-100 rounded",src:"/images/keychain.jpg"},null,8,bs)])])]),$s,t(" involved in a beatmap that completes a priority quest earn: "),e("ul",null,[ys,vs,e("ul",null,[e("li",null,[e("img",{class:"tier-example me-1",src:"/images/bronze.png"},null,8,ws),ks,t(" 7 points ")]),e("li",null,[e("img",{class:"tier-example me-1",src:"/images/silver.png"},null,8,Is),qs,t(" 10 points ")]),e("li",null,[e("img",{class:"tier-example me-1",src:"/images/gold.png"},null,8,Fs),xs,t(" 13 points ")]),e("li",null,[e("img",{class:"tier-example me-1",src:"/images/platinum.png"},null,8,Cs),Vs,t(" 20 points ")])])])])])}const Bs=v(os,[["render",Ts],["__scopeId","data-v-4530def1"]]),Ls=y({name:"MissionPageFilters",components:{FilterBox:O,ModeFilters:z},computed:{...f("missions",["filterMode"])},methods:N("missions",["updateFilterValue","updateFilterMode"])}),Ss={class:"container card card-body py-3 mb-2"};function Es(s,i,o,l,w,k){const p=r("mode-filters"),h=r("filter-box");return n(),m("div",Ss,[u(h,{placeholder:"filter by quest name...","onUpdate:filterValue":i[1]||(i[1]=c=>s.updateFilterValue(c))},{filters:C(()=>[u(p,{"filter-mode":s.filterMode,"onUpdate:filterMode":i[0]||(i[0]=c=>s.updateFilterMode(c))},null,8,["filter-mode"])]),_:1})])}const Ds=v(Ls,[["render",Es]]),Ps=y({name:"MissionPage",components:{MissionCard:U,MissionInformation:Bs,MissionPageFilters:Ds,MissionInfoModal:is},computed:{...f(["loggedInUser"]),...f("missions",["isFirstLoadDone","isLoadingMissions"]),...V("missions",["openMissions","closedMissions","selectedMission","separateMissions"])},beforeCreate(){this.$store.hasModule("missions")||this.$store.registerModule("missions",Y)},async created(){const s=this.$route.query.id;let i,o;s?[i,o]=await Promise.all([this.$http.initialRequest("/missions/relevantInfo"),this.$http.executeGet("/missions/searchOnLoad/"+s)]):i=await this.$http.initialRequest("/missions/relevantInfo"),this.$http.isError(i)||(this.$store.commit("missions/setMissions",i.missions),this.$store.commit("missions/setUserBeatmaps",i.beatmaps),this.$store.commit("missions/setFilterMode",this.loggedInUser.mainMode),this.$store.commit("missions/setFirstLoadDone"),s&&!this.$http.isError(o)&&(this.$store.commit("missions/addMissionIfNotExists",o),this.$store.commit("missions/setSelectedMissionId",s),this.$bs.showModal("editMission")));const l=await this.$http.executeGet("/exampleMission");this.$http.isError(l)||this.$store.commit("missions/setExampleMission",l)},methods:{async loadInactiveMissions(s){const i=await this.$http.executeGet("/missions/loadInactiveMissions",s);this.$http.isError(i)||this.$store.commit("missions/addMissions",i.missions)}}}),Ns=e("div",{class:"radial-divisor"},null,-1),Us={class:"container card card-body my-2"},As=e("i",{class:"fas fa-angle-down"},null,-1),zs={id:"openMissions",class:"collapse show"},Gs=e("hr",null,null,-1),Os={key:0},Rs=e("h6",null,"Quests below are only accessible if you selected a song before the deadline",-1),Ys={class:"container card card-body my-4"},js=e("i",{class:"fas fa-angle-down"},null,-1),Hs={id:"closedMissions",class:"show"},Ws=e("h6",null,"Load inactive priority quests",-1),Qs=[Ws];function Xs(s,i,o,l,w,k){const p=r("mission-page-filters"),h=r("mission-information"),c=r("mission-card"),I=r("mission-info-modal");return n(),m("div",null,[u(p),u(h),Ns,e("div",Us,[e("h4",null,[e("a",{href:"#openMissions","data-bs-toggle":"collapse",onClick:i[0]||(i[0]=$(()=>{},["prevent"]))},[t(" Active priority quests "),As])]),e("div",zs,[(n(!0),m(F,null,x(s.openMissions,d=>(n(),_(c,{key:d.id,mission:d},null,8,["mission"]))),128)),Gs,s.separateMissions&&s.separateMissions.length?(n(),m("div",Os,[Rs,(n(!0),m(F,null,x(s.separateMissions,d=>(n(),_(c,{key:d.id,mission:d},null,8,["mission"]))),128))])):b("",!0)])]),e("div",Ys,[e("h4",null,[e("a",{href:"#closedMissions","data-bs-toggle":"collapse",onClick:i[1]||(i[1]=$(()=>{},["prevent"]))},[t(" Inactive priority quests "),js])]),e("div",Hs,[(n(!0),m(F,null,x(s.closedMissions,d=>(n(),_(c,{key:d.id,mission:d},null,8,["mission"]))),128))]),!s.closedMissions.length||s.closedMissions.length==1?(n(),m("button",{key:0,class:"btn btn-sm w-100 btn-outline-info mb-2 pt-3 pb-2",onClick:i[2]||(i[2]=d=>s.loadInactiveMissions(d))},Qs)):b("",!0)]),u(I)])}const ee=v(Ps,[["render",Xs]]);export{ee as default};
