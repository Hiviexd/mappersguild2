import{d as v,m as S,_ as M,o,e as r,a as s,i as U,t as d,j as m,k as l,n as b,p as g,s as B,u as D,b as A,q as I,M as N,A as T,D as C,c as u,w,r as $,F as f,x as V,y as q,T as F}from"./index-913aa234.js";import{M as O}from"./ModalDialog-ec78811d.js";import{T as G}from"./task-21eeb954.js";import{F as L}from"./FilterBox-fa4708d3.js";import{M as E,F as Q}from"./extras-50dce1b1.js";const R=v({name:"UserCard",props:{user:{type:Object,required:!0}},computed:S("users",["filterMode"]),methods:{selectUser(){this.$store.commit("users/setSelectedUserId",this.user.id)}}});const j=e=>(B("data-v-096980af"),e=e(),D(),e),J=["src"],H={class:"mb-2"},W={class:"text-secondary"},z={class:"card-text small"},K={class:"card-text small"},X=j(()=>s("i",{class:"fas fa-coins"},null,-1)),Y={key:0,class:"card-text small"},Z={key:1,class:"card-text small"},x={key:2,class:"card-text small"},ee={key:3,class:"card-text small"};function se(e,t,n,a,_,P){const p=g("user-link");return o(),r("div",{class:"col-sm-6 col-md-4 col-lg-4 col-xl-3 my-2",onClick:t[0]||(t[0]=c=>e.selectUser())},[s("div",{class:b(["card card-hover card-level-2 card-body","border-rank-"+e.user.rank]),"data-bs-toggle":"modal","data-bs-target":"#extendedInfo"},[s("img",{src:"https://a.ppy.sh/"+e.user.osuId,class:"card-avatar-img"},null,8,J),s("div",H,[U(p,{user:e.user},null,8,["user"])]),s("div",W,[s("div",z,[s("b",null,"Total points: "+d(e.user.totalPoints),1)]),s("div",K,[m(" Available points: "+d(e.user.availablePoints)+" ",1),X]),e.filterMode=="osu"?(o(),r("p",Y," osu! points: "+d(Math.round(e.user.osuPoints*10)/10),1)):e.filterMode=="taiko"?(o(),r("p",Z," osu!taiko points: "+d(Math.round(e.user.taikoPoints*10)/10),1)):e.filterMode=="catch"?(o(),r("p",x," osu!catch points: "+d(Math.round(e.user.catchPoints*10)/10),1)):e.filterMode=="mania"?(o(),r("p",ee," osu!mania points: "+d(Math.round(e.user.maniaPoints*10)/10),1)):l("",!0)])],2)])}const te=M(R,[["render",se],["__scopeId","data-v-096980af"]]),oe=v({name:"UserListElement",props:{user:{type:Object,required:!0}},computed:S("users",["filterMode"]),methods:{selectUser(){this.$store.commit("users/setSelectedUserId",this.user.id)}}});const ie=e=>(B("data-v-de1752fb"),e=e(),D(),e),re={class:"row"},ne={class:"col-sm-4"},ae=["src"],le={class:"col-sm-4 text-secondary"},de={class:"card-text small"},ce={class:"col-sm-4 text-secondary"},ue={key:0,class:"card-text small"},pe=ie(()=>s("i",{class:"fas fa-coins"},null,-1)),he={key:1,class:"card-text small"},me={key:2,class:"card-text small"},fe={key:3,class:"card-text small"},_e={key:4,class:"card-text small"};function ye(e,t,n,a,_,P){const p=g("user-link"),c=I("bs-tooltip");return o(),r("div",{class:b(["card card-body card-level-2 p-1","left-border-rank-"+e.user.rank]),"data-bs-toggle":"modal","data-bs-target":"#extendedInfo",onClick:t[0]||(t[0]=y=>e.selectUser())},[s("div",re,[s("div",ne,[e.user.rank?A((o(),r("i",{key:0,class:b(["fas fa-crown mx-1 me-2","text-rank-"+e.user.rank])},null,2)),[[c,`rank ${e.user.rank} user`]]):l("",!0),s("img",{src:"https://a.ppy.sh/"+e.user.osuId,class:"list-avatar-img"},null,8,ae),U(p,{class:"ms-1",user:e.user},null,8,["user"])]),s("div",le,[s("div",de,[m(" Total points: "),s("b",null,d(e.user.totalPoints),1)])]),s("div",ce,[e.filterMode=="any"?(o(),r("div",ue,[m(" Available points: "+d(e.user.availablePoints)+" ",1),pe])):l("",!0),e.filterMode=="osu"?(o(),r("div",he,[m(" osu! points: "),s("b",null,d(Math.round(e.user.osuPoints*10)/10),1)])):e.filterMode=="taiko"?(o(),r("div",me,[m(" osu!taiko points: "),s("b",null,d(Math.round(e.user.taikoPoints*10)/10),1)])):e.filterMode=="catch"?(o(),r("div",fe,[m(" osu!catch points: "),s("b",null,d(Math.round(e.user.catchPoints*10)/10),1)])):e.filterMode=="mania"?(o(),r("div",_e,[m(" osu!mania points: "),s("b",null,d(Math.round(e.user.maniaPoints*10)/10),1)])):l("",!0)])])],2)}const ge=M(oe,[["render",ye],["__scopeId","data-v-de1752fb"]]),ke=v({name:"UserPointsRow",props:{points:{type:Number,required:!0},display:{type:String,required:!0},tooltipTitle:{type:String,required:!0}}}),$e={class:"text-secondary"},Ue={scope:"row"},Pe={scope:"row"};function be(e,t,n,a,_,P){const p=I("bs-tooltip");return o(),r("tr",$e,[A((o(),r("td",Ue,[m(d(e.display),1)])),[[p,e.tooltipTitle,"left"]]),s("td",Pe,d(Math.round(e.points*10)/10),1)])}const ve=M(ke,[["render",be]]),Me=v({name:"UserInfo",components:{UserPointsRow:ve,ModalDialog:O,ModesIcons:N},data(){return{currentQuests:[],currentMissions:[],createdQuestNames:[],spentPoints:[],userBeatmaps:[],sortOrder:Object.values(G)}},computed:{...S(["loggedInUser"]),...T("users",["selectedUser"])},watch:{async selectedUser(){await this.loadEverything()}},async created(){await this.loadEverything()},methods:{async loadEverything(){if(!this.selectedUser)return;this.$router.push(`/users?id=${this.selectedUser.id}`),this.currentQuests=[],this.currentMissions=[],this.createdQuestNames=[],this.spentPoints=[],this.userBeatmaps=[];const[e,t,n,a,_]=await Promise.all([this.$http.executeGet(`/users/${this.selectedUser.id}/quests`),this.$http.executeGet(`/users/${this.selectedUser.id}/missions`),this.$http.executeGet(`/users/findCreatedQuests/${this.selectedUser.id}`),this.$http.executeGet(`/users/findSpentPoints/${this.selectedUser.id}`),this.$http.executeGet(`/users/findUserBeatmaps/${this.selectedUser.id}`)]);if(this.$http.isError(e)||(this.currentQuests=e),this.$http.isError(t)||(this.currentMissions=t),this.$http.isError(n)||(this.createdQuestNames=n),this.$http.isError(a)||(this.spentPoints=a),!this.$http.isError(_)){const P=["WIP","Done","Qualified","Ranked"];this.userBeatmaps=_.sort(function(p,c){return P.indexOf(p.status)-P.indexOf(c.status)})}},findIcon(e){return e==C.WIP?"fa-ellipsis-h":e==C.Done?"fa-check":e==C.Qualified||e==C.Ranked?"fa-check-circle":""},userTasks(e){[...e.tasks].sort((a,_)=>this.sortOrder.indexOf(a.name)-this.sortOrder.indexOf(_.name));let n="";return e.tasks.forEach(a=>{a.mappers.forEach(_=>{_.id==this.selectedUser.id&&(n+=a.name+", ")})}),n.slice(0,-2)},calculatePoints(e){let t=25;return e.art||(t+=10),e.requiredMapsets<1?t=727:e.requiredMapsets==1?t+=100:e.requiredMapsets<10&&(t+=(10-e.requiredMapsets)*7.5),t},findSpentPointsAction(e){switch(e){case"acceptQuest":return"Accepted quest:";case"reopenQuest":return"Reopened quest:";case"extendDeadline":return"Extended quest deadline:";case"createQuest":return"Created quest:";case"rerollShowcaseMissionSong":return"Rerolled priority quest song:";default:return"undefined action"}},findSpentPointsValue(e,t){switch(e){case"acceptQuest":return t.price;case"reopenQuest":return t.reopenPrice;case"extendDeadline":return 10;case"createQuest":return this.calculatePoints(t);case"rerollShowcaseMissionSong":return 50;default:return 0}}}}),we={class:"row"},Se={class:"col-md-6"},Ce={class:"table table-sm"},Ae=s("thead",null,[s("tr",null,[s("th",{scope:"col"}," Task "),s("th",{scope:"col"}," Points ")])],-1),Ie=s("td",{scope:"row"}," Total points earned ",-1),qe={scope:"row"},Fe=s("td",{scope:"row"}," Available points ",-1),Qe={scope:"row"},Be=s("i",{class:"fas fa-coins"},null,-1),De={class:"col-md-6"},Te={class:"small"},Ne={key:1,class:"text-secondary"},Ve={key:0,class:"small"},Oe={class:"p-0 mb-2 ms-4"},Ge=["href"],Le={key:1,class:"small"},Ee={class:"p-0 mb-2 ms-4"},Re=["href"],je=s("div",{class:"small"}," Completed priority quests: ",-1),Je={class:"p-0 mb-2 ms-4"},He=["href"],We=s("div",{class:"small"}," Completed quests: ",-1),ze={class:"p-0 mb-2 ms-4"},Ke=["href"],Xe={key:4,class:"small"},Ye={class:"p-0 mb-2 ms-4"},Ze=s("div",{class:"radial-divisor"},null,-1),xe={class:"row"},es={class:"col-sm"},ss=s("p",null,"Mappers' Guild beatmaps:",-1),ts={class:"table table-sm"},os=s("thead",null,[s("tr",null,[s("th",{scope:"col"}," Mapset "),s("th",{scope:"col"}," Host "),s("th",{scope:"col"}," Tasks "),s("th",{scope:"col"})])],-1),is={key:0},rs=s("td",{scope:"row"}," ... ",-1),ns=s("td",{scope:"row"}," ... ",-1),as=s("td",{scope:"row"}," ... ",-1),ls=s("td",{scope:"row"},null,-1),ds=[rs,ns,as,ls],cs={scope:"row"},us=["href"],ps={scope:"row"},hs={scope:"row",class:"text-secondary"},ms={scope:"row",class:"text-secondary"},fs=["href"],_s=s("i",{class:"fas fa-link"},null,-1),ys=[_s],gs=s("div",{class:"radial-divisor"},null,-1),ks={class:"row"},$s={class:"col-sm"},Us=s("p",null,"Spent points logs:",-1),Ps={class:"table table-sm"},bs=s("thead",null,[s("tr",null,[s("th",{scope:"col"}," Action "),s("th",{scope:"col"}," Spent points ")])],-1),vs={key:0},Ms=s("td",{scope:"row"}," ... ",-1),ws=s("td",{scope:"row"}," ... ",-1),Ss=[Ms,ws],Cs={scope:"row",class:"text-secondary"},As=["href"],Is=["href"],qs={scope:"row",class:"text-secondary"},Fs=s("i",{class:"fas fa-coins"},null,-1),Qs=s("div",{class:"radial-divisor"},null,-1),Bs={class:"float-end"};function Ds(e,t,n,a,_,P){const p=g("user-link"),c=g("user-points-row"),y=g("modes-icons"),k=g("modal-dialog"),h=I("bs-tooltip");return o(),u(k,{id:"extendedInfo",loaded:Boolean(e.selectedUser),"header-class":e.selectedUser?"bg-rank-"+e.selectedUser.rank:""},{header:w(()=>[U(p,{class:"text-dark",user:e.selectedUser},null,8,["user"])]),default:w(()=>[s("div",we,[s("div",Se,[s("table",Ce,[Ae,s("tbody",null,[e.selectedUser.easyPoints?(o(),u(c,{key:0,points:e.selectedUser.easyPoints,display:"mapping Easy difficulties","tooltip-title":"~5 points per difficulty. +2 if quest mapset"},null,8,["points","tooltip-title"])):l("",!0),e.selectedUser.normalPoints?(o(),u(c,{key:1,points:e.selectedUser.normalPoints,display:"mapping Normal difficulties","tooltip-title":"~6 points per difficulty. +2 if quest mapset"},null,8,["points","tooltip-title"])):l("",!0),e.selectedUser.hardPoints?(o(),u(c,{key:2,points:e.selectedUser.hardPoints,display:"mapping Hard difficulties","tooltip-title":"~7 points per difficulty. +2 if quest mapset"},null,8,["points","tooltip-title"])):l("",!0),e.selectedUser.insanePoints?(o(),u(c,{key:3,points:e.selectedUser.insanePoints,display:"mapping Insane difficulties","tooltip-title":"~8 points per difficulty. +2 if quest mapset"},null,8,["points","tooltip-title"])):l("",!0),e.selectedUser.expertPoints?(o(),u(c,{key:4,points:e.selectedUser.expertPoints,display:"mapping Expert difficulties","tooltip-title":"~8 points per difficulty. +2 if quest mapset"},null,8,["points","tooltip-title"])):l("",!0),e.selectedUser.hitsoundPoints?(o(),u(c,{key:5,points:e.selectedUser.hitsoundPoints,display:"hitsounding","tooltip-title":"~2 points per mapset"},null,8,["points"])):l("",!0),e.selectedUser.storyboardPoints?(o(),u(c,{key:6,points:e.selectedUser.storyboardPoints,display:"creating storyboards","tooltip-title":"2, 7.5, or 10 points per storyboard"},null,8,["points","tooltip-title"])):l("",!0),e.selectedUser.questPoints?(o(),u(c,{key:7,points:e.selectedUser.questPoints,display:"completing quests","tooltip-title":"7 bonus points for completing quests on time"},null,8,["points"])):l("",!0),e.selectedUser.missionPoints?(o(),u(c,{key:8,points:e.selectedUser.missionPoints,display:"completing priority quests","tooltip-title":"5-24 bonus points for completing priority quests"},null,8,["points"])):l("",!0),e.selectedUser.modPoints?(o(),u(c,{key:9,points:e.selectedUser.modPoints,display:"modding mapsets","tooltip-title":"~1 point per mod"},null,8,["points"])):l("",!0),e.selectedUser.hostPoints?(o(),u(c,{key:10,points:e.selectedUser.hostPoints,display:"hosting mapsets","tooltip-title":"3 points per mapset hosted"},null,8,["points"])):l("",!0),e.selectedUser.contestCreatorPoints?(o(),u(c,{key:11,points:e.selectedUser.contestCreatorPoints,display:"FA contest creation","tooltip-title":"creation of FA beatmapping contests hosted on Mappers' Guild"},null,8,["points"])):l("",!0),e.selectedUser.contestParticipantPoints?(o(),u(c,{key:12,points:e.selectedUser.contestParticipantPoints,display:"FA contest participation","tooltip-title":"participating in FA beatmapping contests hosted on Mappers' Guild"},null,8,["points"])):l("",!0),e.selectedUser.contestScreenerPoints?(o(),u(c,{key:13,points:e.selectedUser.contestScreenerPoints,display:"FA contest screening","tooltip-title":"screening entries in FA beatmapping contests hosted on Mappers' Guild"},null,8,["points"])):l("",!0),e.selectedUser.contestJudgePoints?(o(),u(c,{key:14,points:e.selectedUser.contestJudgePoints,display:"FA contest judging","tooltip-title":"judging entries in FA beatmapping contests hosted on Mappers' Guild"},null,8,["points"])):l("",!0),e.selectedUser.legacyPoints?(o(),u(c,{key:15,points:e.selectedUser.legacyPoints,display:"legacy","tooltip-title":"points for things that are no longer applicable to Mappers' Guild"},null,8,["points"])):l("",!0),e.selectedUser.osuPoints?(o(),u(c,{key:16,points:e.selectedUser.osuPoints,display:"Total osu! points","tooltip-title":"mapping osu! game mode"},null,8,["points"])):l("",!0),e.selectedUser.taikoPoints?(o(),u(c,{key:17,points:e.selectedUser.taikoPoints,display:"Total osu!taiko points","tooltip-title":"mapping osu!taiko game mode"},null,8,["points"])):l("",!0),e.selectedUser.catchPoints?(o(),u(c,{key:18,points:e.selectedUser.catchPoints,display:"Total osu!catch points","tooltip-title":"mapping osu!catch game mode"},null,8,["points"])):l("",!0),e.selectedUser.maniaPoints?(o(),u(c,{key:19,points:e.selectedUser.maniaPoints,display:"Total osu!mania points","tooltip-title":"mapping osu!mania game mode"},null,8,["points"])):l("",!0),s("tr",null,[Ie,s("td",qe,d(e.selectedUser.totalPoints),1)]),s("tr",null,[Fe,s("td",Qe,[m(d(e.selectedUser.availablePoints)+" ",1),Be])])])])]),s("div",De,[s("p",Te,[m(" Rank: "),e.selectedUser.rank>0?A((o(),r("i",{key:0,class:b(["fas fa-crown","text-rank-"+e.selectedUser.rank])},null,2)),[[h,`rank ${e.selectedUser.rank} user`]]):(o(),r("span",Ne," None "))]),e.currentMissions.length?(o(),r("div",Ve," Current missions: ")):l("",!0),s("ul",Oe,[(o(!0),r(f,null,$(e.currentMissions,i=>(o(),r("li",{key:i.id,class:"small text-secondary"},[s("a",{href:"/missions?id="+i.id,target:"_blank"},d(i.name.length>40?i.name.slice(0,40)+"...":i.name),9,Ge)]))),128))]),e.currentQuests.length?(o(),r("div",Le," Current quests: ")):l("",!0),s("ul",Ee,[(o(!0),r(f,null,$(e.currentQuests,i=>(o(),r("li",{key:i.id,class:"small text-secondary"},[s("a",{href:"/quests?id="+i.id,target:"_blank"},d(i.name.length>40?i.name.slice(0,40)+"...":i.name),9,Re)]))),128))]),e.selectedUser.completedMissions&&e.selectedUser.completedMissions.length?(o(),r(f,{key:2},[je,s("ul",Je,[(o(!0),r(f,null,$(e.selectedUser.completedMissions,i=>(o(),r("li",{key:i.id,class:"small text-secondary"},[s("a",{href:"/missions?id="+i.id,target:"_blank"},d(i.name.length>40?i.name.slice(0,40)+"...":i.name),9,He)]))),128))])],64)):l("",!0),e.selectedUser.completedQuests&&e.selectedUser.completedQuests.length?(o(),r(f,{key:3},[We,s("ul",ze,[(o(!0),r(f,null,$(e.selectedUser.completedQuests,i=>(o(),r("li",{key:i.id,class:"small text-secondary"},[s("a",{href:"/quests?id="+i.id,target:"_blank"},d(i.name.length>40?i.name.slice(0,40)+"...":i.name),9,Ke)]))),128))])],64)):l("",!0),e.createdQuestNames.length?(o(),r("div",Xe," Created quests: ")):l("",!0),s("ul",Ye,[(o(!0),r(f,null,$(e.createdQuestNames,i=>(o(),r("li",{key:i,class:"small text-secondary"},d(i.length>40?i.slice(0,40)+"...":i),1))),128))])])]),Ze,s("div",xe,[s("div",es,[ss,s("table",ts,[os,s("tbody",null,[e.userBeatmaps.length?l("",!0):(o(),r("tr",is,ds)),(o(!0),r(f,null,$(e.userBeatmaps,i=>(o(),r("tr",{key:i.id},[s("td",cs,[A(s("i",{class:b(["fas me-1",["text-"+i.status.toLowerCase(),e.findIcon(i.status)]])},null,2),[[h,i.status]]),s("a",{href:"/beatmaps?id="+i.id,target:"_blank",class:"me-1"},d(i.song.artist)+" - "+d(i.song.title),9,us),i.mode!=="osu"?(o(),u(y,{key:0,modes:[i.mode],color:"secondary"},null,8,["modes"])):l("",!0)]),s("td",ps,[U(p,{user:i.host},null,8,["user"])]),s("td",hs,d(e.userTasks(i)),1),s("td",ms,[i.url?(o(),r("a",{key:0,href:i.url,target:"_blank"},ys,8,fs)):l("",!0)])]))),128))])])])]),gs,s("div",ks,[s("div",$s,[Us,s("table",Ps,[bs,s("tbody",null,[e.spentPoints.length?l("",!0):(o(),r("tr",vs,Ss)),(o(!0),r(f,null,$(e.spentPoints,i=>(o(),r("tr",{key:i.id},[s("td",Cs,[m(d(e.findSpentPointsAction(i.category))+" ",1),i.quest?(o(),r("a",{key:0,href:"/quests/?id="+i.quest.id,target:"_blank"},d(i.quest.name),9,As)):i.mission?(o(),r("a",{key:1,href:"/missions/?id="+i.mission.id,target:"_blank"},d(i.mission.name),9,Is)):l("",!0)]),s("td",qs,[m(d(e.findSpentPointsValue(i.category,i.quest))+" ",1),Fs])]))),128))])])])]),Qs,s("p",Bs," Joined: "+d(e.selectedUser.createdAt.slice(0,10)),1)]),_:1},8,["loaded","header-class"])}const Ts=M(Me,[["render",Ds]]),Ns=v({name:"UserPageFilters",components:{FilterBox:L,ModeFilters:E},data(){return{sorted:!1,sortOptions:{username:"Name",rank:"Rank",createdAt:"Joined"},displayOptions:{list:"List",cards:"Cards"}}},computed:S("users",["sortBy","displayAs","filterMode","filterValue"]),methods:{...V("users",["updateDisplay","updateSorting","updateFilterValue","updateFilterMode"])}}),Vs={class:"card card-body mb-2"},Os={class:"container"},Gs={class:"row small mt-3"},Ls=s("div",{class:"col-auto filter-title"}," Sort ",-1),Es={class:"col"},Rs=["onClick"],js={class:"row small mt-3"},Js=s("div",{class:"col-auto filter-title"}," Display ",-1),Hs={class:"col"},Ws=["onClick"];function zs(e,t,n,a,_,P){const p=g("mode-filters"),c=g("filter-box");return o(),r("div",Vs,[s("div",Os,[U(c,{placeholder:"enter to search for username...","filter-value":e.filterValue,"onUpdate:filterValue":t[1]||(t[1]=y=>e.updateFilterValue(y))},{filters:w(()=>[U(p,{"filter-mode":e.filterMode,"onUpdate:filterMode":t[0]||(t[0]=y=>e.updateFilterMode(y))},null,8,["filter-mode"])]),_:1},8,["filter-value"]),s("div",Gs,[Ls,s("div",Es,[(o(!0),r(f,null,$(e.sortOptions,(y,k)=>(o(),r("a",{key:k,class:b(e.sortBy===k?"sorted":"unsorted"),href:"#",onClick:q(h=>e.updateSorting(k),["prevent"])},d(y),11,Rs))),128))])]),s("div",js,[Js,s("div",Hs,[(o(!0),r(f,null,$(e.displayOptions,(y,k)=>(o(),r("a",{key:k,class:b(e.displayAs===k?"sorted":"unsorted"),href:"#",onClick:q(h=>e.updateDisplay(k),["prevent"])},d(y),11,Ws))),128))])])])])}const Ks=M(Ns,[["render",zs]]),Xs={namespaced:!0,state:{users:[],selectedUserId:null,filterValue:"",filterMode:Q.any,sortBy:"rank",displayAs:"list",sortDesc:!0,pagination:{page:1,limit:16,maxPages:1}},mutations:{setUsers(e,t){e.users=t},setFilterValue(e,t){e.filterValue=t},setFilterMode(e,t){e.filterMode=t},setSelectedUserId(e,t){e.selectedUserId=t},updateUser(e,t){const n=e.users.findIndex(a=>a.id===t.id);n!==-1&&(e.users[n]=t)},setSortBy(e,t){e.sortBy=t},setSortDesc(e,t){e.sortDesc=t},setDisplayAs(e,t){e.displayAs=t},increasePaginationPage(e){e.pagination.page+=1},decreasePaginationPage(e){e.pagination.page-=1},resetPaginationPage(e){e.pagination.page=1},updatePaginationMaxPages(e,t){e.pagination.maxPages=t}},getters:{filteredUsers:e=>{let t=[...e.users];if(e.filterMode!==Q.any){const n=e.filterMode;t=t.filter(a=>!!(n=="osu"&&a.osuPoints||n=="taiko"&&a.taikoPoints||n=="catch"&&a.catchPoints||n=="mania"&&a.maniaPoints))}return e.filterValue.length>2&&(t=t.filter(n=>n.username.toLowerCase().includes(e.filterValue.toLowerCase()))),e.sortBy==="createdAt"?t.sort((n,a)=>+n.createdAt-+a.createdAt):e.sortBy==="username"?t.sort((n,a)=>a.username.toLowerCase().localeCompare(n.username.toLowerCase())):e.sortBy==="rank"&&(e.filterMode==="osu"?t.sort((n,a)=>n.osuPoints-a.osuPoints):e.filterMode==="taiko"?t.sort((n,a)=>n.taikoPoints-a.taikoPoints):e.filterMode==="catch"?t.sort((n,a)=>n.catchPoints-a.catchPoints):e.filterMode==="mania"?t.sort((n,a)=>n.maniaPoints-a.maniaPoints):t.sort((n,a)=>n.totalPoints-a.totalPoints)),e.sortDesc&&t.reverse(),t},paginatedUsers:(e,t)=>t.filteredUsers.slice(e.pagination.limit*(e.pagination.page-1),e.pagination.limit*e.pagination.page),selectedUser:e=>e.users.find(t=>t.id===e.selectedUserId),allUsers:e=>e.users},actions:{updateFilterMode({commit:e},t){e("resetPaginationPage"),e("setFilterMode",t)},updateFilterValue({commit:e},t){e("resetPaginationPage"),e("setFilterValue",t)},updatePaginationMaxPages({commit:e,getters:t,state:n}){const a=Math.ceil(t.filteredUsers.length/n.pagination.limit);e("updatePaginationMaxPages",a)},updateSorting({commit:e,state:t},n){t.sortBy!==n||t.sortDesc===!1?e("setSortDesc",!0):e("setSortDesc",!1),e("setSortBy",n)},updateDisplay({commit:e,state:t},n){t.displayAs!==n&&(e("setDisplayAs",n),console.log(n))}}},Ys=Xs,Zs=v({name:"UserPage",components:{UserCard:te,UserInfo:Ts,UserPageFilters:Ks,UserListElement:ge},computed:{...S("users",["pagination","displayAs"]),...T("users",["paginatedUsers","allUsers","filteredUsers"])},watch:{paginatedUsers(){this.$store.dispatch("users/updatePaginationMaxPages")}},beforeCreate(){this.$store.hasModule("users")||this.$store.registerModule("users",Ys)},async created(){const e=await this.$http.initialRequest("/users/query");if(!this.$http.isError(e)){this.$store.commit("users/setUsers",e.users);const t=this.$route.query.id;t&&this.allUsers.findIndex(a=>a.id==t)>=0&&(this.$store.commit("users/setSelectedUserId",t),this.$bs.showModal("extendedInfo"))}},methods:{showOlder(){this.$store.commit("users/increasePaginationPage")},showNewer(){this.$store.commit("users/decreasePaginationPage")}}}),xs={key:0,class:"container card card-body py-3"},et=["disabled"],st=s("i",{class:"fas fa-angle-up me-1"},null,-1),tt=s("i",{class:"fas fa-angle-up ms-1"},null,-1),ot={class:"small text-center mx-auto"},it=["disabled"],rt=s("i",{class:"fas fa-angle-down me-1"},null,-1),nt=s("i",{class:"fas fa-angle-down ms-1"},null,-1),at={key:1,class:"container card card-body py-3"};function lt(e,t,n,a,_,P){const p=g("user-page-filters"),c=g("user-card"),y=g("user-list-element"),k=g("user-info");return o(),r("div",null,[U(p),e.displayAs=="cards"?(o(),r("div",xs,[s("button",{disabled:e.pagination.page==1,class:"btn btn-sm btn-primary mx-auto my-2 d-block",type:"button",onClick:t[0]||(t[0]=(...h)=>e.showNewer&&e.showNewer(...h))},[st,m(" show newer "),tt],8,et),s("div",null,[U(F,{name:"list",tag:"div",class:"row px-3"},{default:w(()=>[(o(!0),r(f,null,$(e.paginatedUsers,h=>(o(),u(c,{key:h.id,user:h},null,8,["user"]))),128))]),_:1}),s("div",ot,d(e.paginatedUsers.length===0?"0":e.pagination.page)+" of "+d(e.pagination.maxPages),1),s("button",{disabled:e.pagination.page>=e.pagination.maxPages,class:"btn btn-sm btn-primary mx-auto my-2 d-block",type:"button",onClick:t[1]||(t[1]=(...h)=>e.showOlder&&e.showOlder(...h))},[rt,m(" show older "),nt],8,it)])])):e.displayAs=="list"?(o(),r("div",at,[U(F,{name:"list",tag:"div",class:"row px-3"},{default:w(()=>[(o(!0),r(f,null,$(e.filteredUsers,h=>(o(),u(y,{key:h.id,user:h},null,8,["user"]))),128))]),_:1})])):l("",!0),U(k)])}const mt=M(Zs,[["render",lt]]);export{mt as default};
