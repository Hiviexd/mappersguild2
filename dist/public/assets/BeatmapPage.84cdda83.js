var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a,n=(e,t)=>{for(var s in t||(t={}))o.call(t,s)&&i(e,s,t[s]);if(a)for(var s of a(t))l.call(t,s)&&i(e,s,t[s]);return e},d=(e,a)=>t(e,s(a));import{d as r,m as c,p as m,a as u,h as p,i as h,o as b,s as k,w as f,f as g,l as y,v,b as B,g as w,t as x,F as I,H as L,I as T,J as M,j as C,k as $,e as S,n as O,y as P,K as A,L as U,q,N as E,O as Q,P as j,B as D}from"./vendor.b9ef672a.js";import{_ as F}from"./ModalDialog.4a9168b4.js";import{_ as V,B as H,a as N}from"./index.85c79094.js";import{_}from"./UserLinkList.9aab0eb3.js";import{_ as R}from"./FilterBox.b3263039.js";import{_ as G,F as W}from"./extras.acd395c6.js";import{T as K,a as Y}from"./task.5925ddbb.js";var z=r({name:"CreateBeatmapModal",components:{ModalDialog:F,UserLinkList:_,ModesIcons:V},data:()=>({featuredArtists:[],featuredSongs:[],selectedArtist:"",artistInput:"",selectedSong:"",selectedMode:"osu",selectedTaskStatus:"",previousSelectedMode:"",selectedTaskMode:"osu",checkedLocks:[],modes:[{value:"osu",name:"osu!"},{value:"taiko",name:"osu!taiko"},{value:"catch",name:"osu!catch"},{value:"mania",name:"osu!mania"},{value:"hybrid",name:"Multiple modes"}],tasks:["Easy","Normal","Hard","Insane","Expert","Storyboard"],newTaskName:"",newTaskMapper:"",tempTasks:[]}),computed:d(n({},c(["loggedInUser"])),{sortedTasks(){const e=["Easy","Normal","Hard","Insane","Expert","Storyboard"],t=["osu","taiko","catch","mania","sb"];return[...this.tempTasks].sort((function(t,s){return e.indexOf(t.name)-e.indexOf(s.name)})).sort((function(e,s){return t.indexOf(e.mode)-t.indexOf(s.mode)}))}}),watch:{selectedMode(){"hybrid"==this.selectedMode&&(this.tempTasks=[]),"hybrid"==this.previousSelectedMode&&(this.tempTasks=[]),this.previousSelectedMode=this.selectedMode}},async created(){const e=await this.$http.executeGet("/featuredArtists");e&&(this.featuredArtists=e.sort(((e,t)=>e.label.toLowerCase()>t.label.toLowerCase()?1:t.label.toLowerCase()>e.label.toLowerCase()?-1:0)))},methods:{async setArtist(e){if(!this.selectedArtist&&!this.artistInput)return void this.$store.dispatch("updateToastMessages",{message:"Select or type an artist!",type:"danger"});if(this.artistInput){const e=this.featuredArtists.find((e=>e.label.toLowerCase().includes(this.artistInput.toLowerCase())));e&&(this.selectedArtist=e.id)}if(!this.selectedArtist)return void this.$store.dispatch("updateToastMessages",{message:"Couldn't find artist! Check your typing or select one from the list.",type:"danger"});e.target.disabled=!0;const t=await this.$http.executeGet(`/featuredArtists/${this.selectedArtist}/songs`);t&&(this.featuredSongs=t.sort(((e,t)=>e.title.toLowerCase()>t.title.toLowerCase()?1:t.title.toLowerCase()>e.title.toLowerCase()?-1:0))),e.target.disabled=!1},async addTempTask(e){if(!this.newTaskName.length||!this.selectedTaskStatus.length)return void this.$store.dispatch("updateToastMessages",{message:"Missing task or status",type:"danger"});const t=await this.$http.executeGet(`/beatmaps/validateUsers/${this.newTaskMapper.length?this.newTaskMapper:this.loggedInUser.username}`,e);t&&t.length&&this.tempTasks.push({name:this.newTaskName,mappers:t,mode:this.selectedTaskMode,status:this.selectedTaskStatus,random:Math.random().toString()})},removeTempTask(e){const t=this.tempTasks.findIndex((t=>t.random==e));this.tempTasks.splice(t,1)},async saveNewMap(e){if(!this.selectedSong)return void this.$store.dispatch("updateToastMessages",{message:"Select a song!",type:"info"});const t=await this.$http.executePost("/beatmaps/create/",{song:this.selectedSong,tasks:this.tempTasks,tasksLocked:this.checkedLocks,mode:this.selectedMode},e);this.$http.isError(t)||(this.$bs.hideModal("addBeatmap"),this.$store.commit("beatmaps/addBeatmap",t))}}});m("data-v-3e767abe");const J={class:"container"},X={class:"mb-3 row"},Z=g("div",{class:"col-lg-1"},[g("p",{style:{"margin-top":"3px"}}," Artist: ")],-1),ee={class:"col-lg-11"},te={id:"artistForm",class:"input-group input-group-sm mb-3"},se=g("option",{value:""}," Select an artist ",-1),ae=g("option",{value:"-",disabled:""}," --- ",-1),oe=["value"],le=g("div",{class:"col-lg-1"},[g("p",{style:{"margin-top":"3px"}}," Song: ")],-1),ie={class:"col-lg-11"},ne=["disabled"],de=g("option",{value:"",disabled:""}," Select an artist to view songs ",-1),re=g("option",{value:"-",disabled:""}," --- ",-1),ce=["value"],me=g("hr",null,null,-1),ue=g("p",null," Game-mode: ",-1),pe={class:"mb-3 row"},he={class:"col-sm-10"},be=["id","value"],ke=["for"],fe=g("br",null,null,-1),ge=g("hr",null,null,-1),ye=g("div",{class:"mb-2"},[$(" Set your mapset's difficulties "),g("div",{class:"small text-secondary"}," These can be changed later. ")],-1),ve={key:0,class:"table table-sm"},Be=g("thead",null,[g("tr",null,[g("th",null,"Difficulty"),g("th",null,"Mapper(s)"),g("th",null,"Status"),g("th")])],-1),we={class:"text-secondary"},xe=["onClick"],Ie=[g("i",{class:"fas fa-times"},null,-1)],Le={class:"col-sm-12"},Te={class:"input-group input-group-sm mx-auto"},Me=g("option",{value:"",disabled:"",selected:""}," Select a task ",-1),Ce=["value"],$e=[g("option",{value:"osu"}," osu! ",-1),g("option",{value:"taiko"}," osu!taiko ",-1),g("option",{value:"catch"}," osu!catch ",-1),g("option",{value:"mania"}," osu!mania ",-1)],Se=[g("option",{value:"",disabled:"",selected:""}," Select a status ",-1),g("option",{value:"WIP"}," Work-in-progress ",-1),g("option",{value:"Done"}," Done ",-1)],Oe=[g("i",{class:"fas fa-plus"},null,-1)],Pe=g("div",{class:"text-secondary small mt-1"},[g("ul",{class:"small"},[g("li",null,'You can leave the "mapper" field empty for your own difficulties.'),g("li",null,'Use comma separation for collabs, like "mapper1, mapper2"')])],-1),Ae=g("hr",null,null,-1),Ue=g("div",{class:"mb-2"},[$(" Set any difficulties that nobody else is allowed to claim. "),g("div",{class:"small text-secondary"}," For example, if you don't want any guest difficulties, you should select all. These can be changed later. ")],-1),qe={class:"mb-3 row"},Ee={class:"col-sm-10"},Qe=["id","value"],je=["for"],De=g("div",{class:"radial-divisor"},null,-1),Fe={class:"small text-secondary mt-2"},Ve={class:"small"},He=$(" Note that you can only earn points for beatmaps that fit these requirements: "),Ne=$("Your beatmap was ranked "),_e=g("i",null,"after",-1),Re=$(" you joined the Mappers' Guild ("),Ge=$(")"),We=g("li",null,[$("Your beatmap was ranked "),g("i",null,"after"),$(" the Featured Artist was announced, excluding maps created for the announcement")],-1),Ke=g("li",null,"Difficulties match between Mappers' Guild and osu! website (including difficulty levels and mappers)",-1);u(),z.render=function(e,t,s,a,o,l){const i=p("modes-icons"),n=p("user-link-list"),d=p("modal-dialog"),r=h("bs-tooltip");return b(),k(d,{id:"addBeatmap",title:"Add beatmap"},{default:f((()=>[g("div",J,[g("div",X,[Z,g("div",ee,[g("div",te,[y(g("select",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.selectedArtist=t),class:"form-select"},[se,ae,(b(!0),B(I,null,w(e.featuredArtists,(e=>(b(),B("option",{key:e.id,value:e.id},x(e.label),9,oe)))),128))],512),[[v,e.selectedArtist]]),y(g("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.artistInput=t),type:"text",class:"form-control",placeholder:"or input the artist's name...",onKeyup:t[2]||(t[2]=T((t=>e.setArtist(t)),["enter"]))},null,544),[[L,e.artistInput]]),g("button",{id:"artistButton",class:"btn btn-outline-info",onClick:t[3]||(t[3]=t=>e.setArtist(t))}," Load songs ")])]),le,g("div",ie,[y(g("select",{"onUpdate:modelValue":t[4]||(t[4]=t=>e.selectedSong=t),class:"form-select form-select-sm",disabled:!e.featuredSongs.length},[de,re,(b(!0),B(I,null,w(e.featuredSongs,(e=>(b(),B("option",{key:e.id,value:e.id},x(e.title)+" --- ("+x(e.artist)+") ",9,ce)))),128))],8,ne),[[v,e.selectedSong]])])]),me,ue,g("div",pe,[g("div",he,[(b(!0),B(I,null,w(e.modes,(s=>(b(),B("div",{key:s.value,class:"form-check form-check-inline"},[y(g("input",{id:s.value,"onUpdate:modelValue":t[5]||(t[5]=t=>e.selectedMode=t),class:"form-check-input",type:"radio",value:s.value},null,8,be),[[M,e.selectedMode]]),g("label",{class:"form-check-label",for:s.value},x(s.name),9,ke)])))),128)),fe])]),ge,ye,e.tempTasks.length?(b(),B("table",ve,[Be,C(P,{tag:"tbody",name:"list"},{default:f((()=>[(b(!0),B(I,null,w(e.tempTasks,(t=>(b(),B("tr",{key:t.random},[g("td",we,[$(x(t.name)+" ",1),"hybrid"==e.selectedMode?(b(),k(i,{key:0,modes:[t.mode]},null,8,["modes"])):S("",!0)]),g("td",null,[C(n,{users:t.mappers},null,8,["users"])]),g("td",{class:O("WIP"==t.status?"text-wip":"text-success")},x(t.status),3),g("td",null,[y(g("a",{href:"#",class:"text-danger",onClick:s=>e.removeTempTask(t.random)},Ie,8,xe),[[r,"delete"]])])])))),128))])),_:1})])):S("",!0),g("div",Le,[g("div",Te,[y(g("select",{"onUpdate:modelValue":t[6]||(t[6]=t=>e.newTaskName=t),class:"form-select"},[Me,(b(!0),B(I,null,w(e.tasks,(e=>(b(),B("option",{key:e,value:e},x(e),9,Ce)))),128))],512),[[v,e.newTaskName]]),"hybrid"==e.selectedMode?y((b(),B("select",{key:0,"onUpdate:modelValue":t[7]||(t[7]=t=>e.selectedTaskMode=t),class:"form-select"},$e,512)),[[v,e.selectedTaskMode]]):S("",!0),y(g("select",{"onUpdate:modelValue":t[8]||(t[8]=t=>e.selectedTaskStatus=t),class:"form-select"},Se,512),[[v,e.selectedTaskStatus]]),y(g("input",{"onUpdate:modelValue":t[9]||(t[9]=t=>e.newTaskMapper=t),class:"form-control",type:"text",placeholder:"mapper name or osu! ID...",onKeyup:t[10]||(t[10]=T((t=>e.addTempTask(t)),["enter"]))},null,544),[[L,e.newTaskMapper]]),y(g("button",{class:"btn btn-outline-info",onClick:t[11]||(t[11]=t=>e.addTempTask(t))},Oe,512),[[r,"add difficulty"]])]),Pe]),Ae,Ue,g("div",qe,[g("div",Ee,[(b(!0),B(I,null,w(e.tasks,(s=>(b(),B("div",{key:s,class:"form-check"},[y(g("input",{id:`lock-${s}`,"onUpdate:modelValue":t[12]||(t[12]=t=>e.checkedLocks=t),class:"form-check-input",type:"checkbox",value:s},null,8,Qe),[[A,e.checkedLocks]]),g("label",{class:"form-check-label",for:`lock-${s}`},x(s),9,je)])))),128))])])]),g("button",{type:"submit",class:"btn btn-outline-success w-100",onClick:t[13]||(t[13]=t=>e.saveNewMap(t))}," Create beatmap "),De,g("div",Fe,[g("div",Ve,[He,g("ul",null,[g("li",null,[Ne,_e,Re,g("code",null,x(e.loggedInUser.createdAt),1),Ge]),We,Ke])])])])),_:1})},z.__scopeId="data-v-3e767abe";var Ye=r({name:"BeatmapPageFilters",components:{FilterBox:R,ModeFilters:G},data:()=>({statuses:{any:"Any",WIP:"WIP",Done:"Done",Qualified:"Qualified",Ranked:"Ranked"},quests:{any:"Any",none:"None"}}),computed:c("beatmaps",["filterMode","filterValue","filterStatus","filterQuest"]),methods:d(n({},U("beatmaps",["updateFilterValue","updateFilterMode","updateFilterStatus","updateFilterQuest"])),{getStatusSortClass(e){return this.filterStatus===e?"sorted":"unsorted"},getQuestSortClass(e){return this.filterQuest===e?"sorted":"unsorted"}})});const ze={class:"container card card-body py-3 mb-2"},Je=g("button",{class:"btn btn-primary",href:"#","data-bs-toggle":"modal","data-bs-target":"#addBeatmap"},[$(" Add beatmap "),g("i",{class:"fas fa-plus fa-xs"})],-1),Xe={class:"row mt-3"},Ze=g("div",{class:"col-auto filter-title"}," Status ",-1),et={class:"col"},tt=["onClick"],st={class:"row mt-3"},at=g("div",{class:"col-auto filter-title"}," Quest ",-1),ot={class:"col"},lt=["onClick"];function it(e,t,s){const a={class:["px-1","text-"+t.toLowerCase()]};return s&&(a["data-bs-toggle"]="tooltip",a["data-bs-placement"]="top",a.title=s),E("span",a,e)}Ye.render=function(e,t,s,a,o,l){const i=p("mode-filters"),n=p("filter-box");return b(),B("div",ze,[C(n,{placeholder:"enter to search for song/username...","filter-value":e.filterValue,"onUpdate:filterValue":t[1]||(t[1]=t=>e.updateFilterValue(t))},{filters:f((()=>[C(i,{"filter-mode":e.filterMode,"onUpdate:filterMode":t[0]||(t[0]=t=>e.updateFilterMode(t))},null,8,["filter-mode"]),g("div",Xe,[Ze,g("div",et,[(b(!0),B(I,null,w(e.statuses,((t,s)=>(b(),B("a",{key:s,href:"#",class:O(["status",e.getStatusSortClass(s)]),onClick:q((t=>e.updateFilterStatus(s)),["prevent"])},x(t),11,tt)))),128))])]),g("div",st,[at,g("div",ot,[(b(!0),B(I,null,w(e.quests,((t,s)=>(b(),B("a",{key:s,href:"#",class:O(["quest",e.getQuestSortClass(s)]),onClick:q((t=>e.updateFilterQuest(s)),["prevent"])},x(t),11,lt)))),128))])])])),default:f((()=>[Je])),_:1},8,["filter-value"])])};var nt=r({props:{tasks:{type:Array,required:!0},tasksLocked:{type:Array,required:!0},mode:{type:String,required:!0}},render(){const e=[{name:"Storyboard",short:"SB",locked:!1,status:[]},{name:"Easy",short:"E",locked:!1,status:[]},{name:"Normal",short:"N",locked:!1,status:[]},{name:"Hard",short:"H",locked:!1,status:[]},{name:"Insane",short:"I",locked:!1,status:[]},{name:"Expert",short:"X",locked:!1,status:[]}],t=[{name:"osu",short:"circle",count:0,status:K.Done},{name:"taiko",short:"drum",count:0,status:K.Done},{name:"catch",short:"apple-alt",count:0,status:K.Done},{name:"mania",short:"stream",count:0,status:K.Done}],s=[],a=this.tasks.length>=10,o=this.mode===H.Hybrid;for(const l of e){let e=!1;const i=this.tasksLocked.includes(l.name);for(const s of this.tasks)if(l.name===s.name){l.status.push(s.status),e=!0;const a=t.findIndex((e=>e.name===s.mode));-1!==a&&(t[a].count++,s.status===K.WIP&&(t[a].status=K.WIP))}if(!o){if(a&&l.status.length>1)s.push(it(l.short+"+","secondary",l.status.length.toString()));else for(const e of l.status)s.push(it(l.short,e));e||s.push(it(l.short,i?"blocked":"open"))}}if(o)for(const l of t)s.push(it([E("i",{class:["fas","fa-"+l.short]})],l.count?l.status:"blocked",l.count.toString()));return E("span",{class:"fw-bold"},s)}}),dt=r({props:{beatmap:{type:Object,required:!0}},computed:{url(){var e;if(this.beatmap.mission)switch(this.beatmap.mission.tier){case 1:return"/images/dark-bronze.png";case 2:return"/images/dark-silver.png";case 3:return"/images/dark-gold.png";case 4:return"/images/dark-platinum.png";default:return"/images/dark-bronze.png"}return this.beatmap.isShowcase||!(null==(e=this.beatmap.quest)?void 0:e.art)?"/images/no-art-icon.png":this.beatmap.quest.isMbc?"/images/mbc-icon.png":`https://assets.ppy.sh/artists/${this.beatmap.quest.art}/cover.jpg`}}});m("data-v-f921c8b8");const rt=["src"];u(),dt.render=function(e,t,s,a,o,l){const i=h("bs-tooltip");return e.beatmap.quest||e.beatmap.mission||e.beatmap.isShowcase?y((b(),B("img",{key:0,class:"rounded-circle me-1 quest-icon",src:e.url},null,8,rt)),[[i,e.beatmap.quest&&e.beatmap.quest.name||e.beatmap.mission&&e.beatmap.mission.name||"FA showcase"]]):S("",!0)},dt.__scopeId="data-v-f921c8b8";var ct=r({name:"BeatmapCard",components:{ProcessTasks:nt,QuestImg:dt,ModesIcons:V},props:{beatmap:{type:Object,required:!0}},emits:["update:selectedBeatmap"],data:()=>({defaultUrl:"https://osu.ppy.sh/images/layout/beatmaps/default-bg.png"}),computed:{statusBorder(){return this.beatmap.status?"card-status-"+this.beatmap.status.toLowerCase():""}},methods:{fallbackImage(e){e.target.src=this.defaultUrl},formatMetadata(e,t){const s=e+" - "+t;return s.length>34?s.slice(0,34)+"...":s},processUrl(e){if(e&&-1!==e.indexOf("osu.ppy.sh/beatmapsets/")){const t=e.indexOf("beatmapsets/")+"beatmapsets/".length,s=e.indexOf("#");let a;return a=-1!==s?e.slice(t,s):e.slice(t),`https://assets.ppy.sh/beatmaps/${a}/covers/card.jpg`}return this.defaultUrl}}});m("data-v-4750c6aa");const mt=["src"],ut={class:"card-img-overlay",style:{padding:"0.50rem 0.50rem 0 0.50rem"}},pt={class:"card-title mb-1"},ht={class:"card-text"},bt=$(" Hosted by ");u(),ct.render=function(e,t,s,a,o,l){const i=p("quest-img"),n=p("user-link"),d=p("modes-icons"),r=p("process-tasks");return b(),B("div",{class:"my-2 col-sm-12 col-md-6 col-lg-4",onClick:t[1]||(t[1]=t=>e.$emit("update:selectedBeatmap",e.beatmap))},[g("div",{class:O(["card card-hover map-card bg-dark",e.statusBorder]),"data-bs-toggle":"modal","data-bs-target":"#editBeatmap"},[g("img",{class:"card-img",src:e.processUrl(e.beatmap.url),style:{opacity:"0.2"},onError:t[0]||(t[0]=t=>e.fallbackImage(t))},null,40,mt),g("div",ut,[g("p",pt,x(e.formatMetadata(e.beatmap.song.artist,e.beatmap.song.title)),1),g("small",ht,[C(i,{beatmap:e.beatmap},null,8,["beatmap"]),bt,C(n,{class:"me-1",user:e.beatmap.host},null,8,["user"]),"osu"!==e.beatmap.mode?(b(),k(d,{key:0,modes:[e.beatmap.mode]},null,8,["modes"])):S("",!0),C(r,{class:"float-end pt-1",tasks:e.beatmap.tasks,"tasks-locked":e.beatmap.tasksLocked,mode:e.beatmap.mode},null,8,["tasks","tasks-locked","mode"])])])],2)])},ct.__scopeId="data-v-4750c6aa";var kt=r({components:{BeatmapCard:ct},computed:Q("beatmaps",["hostedBeatmaps"]),methods:j("beatmaps",["setSelectedBeatmap"])});const ft={class:"container card card-body py-3"},gt={class:"ms-2"},yt={href:"#hostedBeatmaps","data-bs-toggle":"collapse"},vt=g("i",{class:"fas fa-angle-down"},null,-1),Bt={key:0,id:"hostedBeatmaps",class:"show"},wt={key:0,class:"ms-5 text-secondary"};kt.render=function(e,t,s,a,o,l){const i=p("beatmap-card");return b(),B("div",ft,[g("h5",gt,[g("a",yt,[$(" My mapsets ("+x(e.hostedBeatmaps?e.hostedBeatmaps.length:"...")+") ",1),vt])]),e.hostedBeatmaps?(b(),B("div",Bt,[C(P,{name:"list",tag:"div",class:"row"},{default:f((()=>[(b(!0),B(I,null,w(e.hostedBeatmaps,(s=>(b(),k(i,{key:s.id,beatmap:s,"onUpdate:selectedBeatmap":t[0]||(t[0]=t=>e.setSelectedBeatmap(t))},null,8,["beatmap"])))),128))])),_:1}),e.hostedBeatmaps.length?S("",!0):(b(),B("p",wt," None... "))])):S("",!0)])};var xt=r({components:{BeatmapCard:ct},props:{isLoadingGuestBeatmaps:Boolean},computed:Q("beatmaps",["guestDifficultyBeatmaps"]),methods:j("beatmaps",["setSelectedBeatmap"])});const It={class:"container card card-body py-3"},Lt={class:"ms-2"},Tt={href:"#guestDifficultyBeatmaps","data-bs-toggle":"collapse"},Mt=g("i",{class:"fas fa-angle-down"},null,-1),Ct={key:0,class:"ms-5 text-secondary"};xt.render=function(e,t,s,a,o,l){const i=p("beatmap-card");return b(),B("div",It,[g("h5",Lt,[g("a",Tt,[$(" My guest difficulties ("+x(e.guestDifficultyBeatmaps&&!e.isLoadingGuestBeatmaps?e.guestDifficultyBeatmaps.length:"...")+") ",1),Mt])]),e.guestDifficultyBeatmaps?(b(),B("div",{key:0,id:"guestDifficultyBeatmaps",class:O(["collapse",{"loading-data":e.isLoadingGuestBeatmaps}])},[e.guestDifficultyBeatmaps.length||e.isLoadingGuestBeatmaps?S("",!0):(b(),B("p",Ct," None... ")),C(P,{name:"list",tag:"div",class:"row"},{default:f((()=>[(b(!0),B(I,null,w(e.guestDifficultyBeatmaps,(s=>(b(),k(i,{key:s.id,beatmap:s,"onUpdate:selectedBeatmap":t[0]||(t[0]=t=>e.setSelectedBeatmap(t))},null,8,["beatmap"])))),128))])),_:1})],2)):S("",!0)])};var $t=r({name:"ModeChoice",props:{beatmap:{type:Object,required:!0}},data(){return{selectedMode:this.beatmap.mode,showInput:!1,modes:[{value:"osu",name:"osu!"},{value:"taiko",name:"osu!taiko"},{value:"catch",name:"osu!catch"},{value:"mania",name:"osu!mania"},{value:"hybrid",name:"Multiple modes"}]}},methods:{async setMode(e){const t=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/setMode`,{mode:this.selectedMode},e);this.$http.isError(t)||this.$store.dispatch("beatmaps/updateBeatmap",t),this.showInput=!1}}});const St={id:"mode"},Ot={class:"row mb-2"},Pt={class:"col"},At=$(" Mode "),Ut=[g("i",{class:"fas fa-edit"},null,-1)],qt={class:"small ms-3 text-secondary"},Et={key:0,class:"row mb-2"},Qt={class:"col"},jt={class:"input-group input-group-sm"},Dt=["value"],Ft=[$(" Save ")];$t.render=function(e,t,s,a,o,l){const i=h("bs-tooltip");return b(),B("div",St,[g("div",Ot,[g("div",Pt,[g("div",null,[At,y(g("a",{id:"editMode",href:"#",class:O([e.showInput?"text-danger":"","text-success small ms-1"]),onClick:t[0]||(t[0]=q((t=>e.showInput=!e.showInput),["prevent"]))},Ut,2),[[i,"edit mode","right"]])]),g("div",qt,x("hybrid"==e.beatmap.mode?"Multiple modes":"osu"==e.beatmap.mode?"osu!":"osu!"+e.beatmap.mode),1)])]),e.showInput?(b(),B("div",Et,[g("div",Qt,[g("div",jt,[y(g("select",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.selectedMode=t),class:"form-select"},[(b(!0),B(I,null,w(e.modes,(e=>(b(),B("option",{key:e.value,value:e.value},x(e.name),9,Dt)))),128))],512),[[v,e.selectedMode]]),y(g("button",{class:"btn btn-outline-info",onClick:t[2]||(t[2]=t=>e.setMode(t))},Ft,512),[[i,"link beatmap to quest"]])])])])):S("",!0)])};var Vt=r({name:"StatusChoice",props:{beatmap:{type:Object,required:!0}},methods:{async setStatus(e,t){const s=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/setStatus`,{status:e},t);this.$http.isError(s)||this.$store.dispatch("beatmaps/updateBeatmap",s)}}});const Ht={id:"mapsetStatus"},Nt=g("div",{class:"d-inline-block me-2"}," Status ",-1),_t=["disabled"],Rt=[$(" WIP ")],Gt=["disabled"],Wt=[$(" Done ")],Kt={class:"small text-secondary"},Yt=g("div",{class:"small text-secondary mt-1"},[g("div",{class:"small"},' Maps marked as "Done" will be processed for points when they reach the Ranked category on osu!. ')],-1);Vt.render=function(e,t,s,a,o,l){const i=h("bs-tooltip");return b(),B("div",Ht,[Nt,y(g("button",{class:O(["btn btn-sm me-1","WIP"==e.beatmap.status?"btn-warning":"btn-outline-warning"]),disabled:"WIP"==e.beatmap.status,onClick:t[0]||(t[0]=t=>e.setStatus("WIP",t))},Rt,10,_t),[[i,"mark mapset as work-in-progress","bottom"]]),y(g("button",{class:O(["btn btn-sm me-1","Done"==e.beatmap.status?"btn-success":"btn-outline-success"]),disabled:"Done"==e.beatmap.status,onClick:t[1]||(t[1]=t=>e.setStatus("Done",t))},Wt,10,Gt),[[i,"mark mapset and all diffs as done","bottom"]]),g("span",Kt,'(currently "'+x(e.beatmap.status)+'")',1),Yt])};var zt=r({name:"NewTask",props:{isHost:Boolean,taskToAddCollaborator:{type:Object,default:null},beatmap:{type:Object,required:!0}},emits:["update:taskToAddCollaborator"],data:()=>({selectedTask:Y.Easy,selectedMode:H.Osu,addTaskUsername:""}),computed:{remainingTasks(){let e=Object.values(Y);return this.beatmap.tasksLocked&&this.beatmap.tasksLocked.length&&!this.isHost&&(e=e.filter((e=>!this.beatmap.tasksLocked.includes(e)))),this.selectedTask=e[0]||"",e}},methods:{async addTask(e){let t;t=this.beatmap.mode==H.Hybrid?this.selectedMode:this.beatmap.mode;const s=await this.$http.executePost("/beatmaps/addTask/"+this.beatmap.id,{user:this.addTaskUsername,taskName:this.selectedTask,username:this.addTaskUsername,mode:t},e);this.$http.isError(s)||this.$store.dispatch("beatmaps/updateBeatmap",s)},async addCollab(e){let t;t=this.beatmap.mode==H.Hybrid?this.taskToAddCollaborator.mode:this.beatmap.mode;const s=await this.$http.executePost("/beatmaps/addCollab/"+this.beatmap.id,{user:this.addTaskUsername,task:this.taskToAddCollaborator,mode:t},e);this.$http.isError(s)||(this.$store.dispatch("beatmaps/updateBeatmap",s),this.$store.dispatch("updateToastMessages",{message:"Added",type:"success"}))}}});const Jt={key:0,class:"row mt-2 mb-3"},Xt={class:"col-sm-12"},Zt={class:"input-group input-group-sm mx-auto"},es=["value"],ts=[g("option",{value:"osu"}," osu! ",-1),g("option",{value:"taiko"}," osu!taiko ",-1),g("option",{value:"catch"}," osu!catch ",-1),g("option",{value:"mania"}," osu!mania ",-1)],ss=[g("i",{class:"fas fa-plus"},null,-1)],as={key:0,class:"col-sm-12 mt-1 text-center"},os=$(" Adding collaborator for the selected difficulty "),ls=[g("i",{class:"fas fa-times-circle"},null,-1)];zt.render=function(e,t,s,a,o,l){const i=h("bs-tooltip");return"WIP"==e.beatmap.status&&e.remainingTasks.length?(b(),B("div",Jt,[g("div",Xt,[g("div",Zt,[e.taskToAddCollaborator?S("",!0):y((b(),B("select",{key:0,"onUpdate:modelValue":t[0]||(t[0]=t=>e.selectedTask=t),class:"form-select"},[(b(!0),B(I,null,w(e.remainingTasks,(e=>(b(),B("option",{key:e,value:e},x(e),9,es)))),128))],512)),[[v,e.selectedTask]]),"hybrid"!=e.beatmap.mode||e.taskToAddCollaborator?S("",!0):y((b(),B("select",{key:1,"onUpdate:modelValue":t[1]||(t[1]=t=>e.selectedMode=t),class:"form-select"},ts,512)),[[v,e.selectedMode]]),e.isHost||e.taskToAddCollaborator?y((b(),B("input",{key:2,"onUpdate:modelValue":t[2]||(t[2]=t=>e.addTaskUsername=t),class:"form-control",type:"text",placeholder:"add user to task...",maxlength:"18",onKeyup:t[3]||(t[3]=T((t=>e.taskToAddCollaborator?e.addCollab(t):e.addTask(t)),["enter"]))},null,544)),[[L,e.addTaskUsername]]):S("",!0),y(g("button",{class:"btn btn-outline-info",onClick:t[4]||(t[4]=t=>e.taskToAddCollaborator?e.addCollab(t):e.addTask(t))},ss,512),[[i,"add difficulty"]])])]),e.taskToAddCollaborator?(b(),B("div",as,[g("small",null,[os,g("a",{class:"text-danger",href:"#",onClick:t[5]||(t[5]=q((t=>e.$emit("update:taskToAddCollaborator",null)),["prevent"]))},ls)])])):S("",!0)])):S("",!0)};var is=r({name:"TasksChoice",components:{NewTask:zt,ModesIcons:V},props:{beatmap:{type:Object,required:!0},isHost:Boolean,isRanked:Boolean,isQualified:Boolean},data:()=>({taskToAddCollaborator:void 0}),computed:d(n({},c(["loggedInUser"])),{sortedTasks(){const e=["Easy","Normal","Hard","Insane","Expert","Storyboard"],t=["osu","taiko","catch","mania","sb"];return[...this.beatmap.tasks].sort((function(t,s){return e.indexOf(t.name)-e.indexOf(s.name)})).sort((function(e,s){return t.indexOf(e.mode)-t.indexOf(s.mode)}))}}),methods:{isOwner(e){return e.some((e=>e.osuId==this.loggedInUser.osuId))},canEditTask(e){return this.isOwner(e.mappers)||this.isHost},async setTaskStatus(e,t,s){s.target.classList.add("fake-button-disable");const a=await this.$http.executePost("/beatmaps/setTaskStatus/"+e,{status:t});this.$http.isError(a)||this.$store.dispatch("beatmaps/updateBeatmap",a),s.target.classList.remove("fake-button-disable")},async removeTask(e,t){t.target.classList.add("fake-button-disable");const s=await this.$http.executePost("/beatmaps/removeTask/"+e,{beatmapId:this.beatmap.id});this.$http.isError(s)||this.$store.dispatch("beatmaps/updateBeatmap",s),t.target.classList.remove("fake-button-disable")},canEditTaskCollaborators(e){return"Done"!=e.status&&!this.isQualified&&"Done"!=this.beatmap.status&&this.canEditTask(e)},async removeCollab(e,t,s){s.target.classList.add("fake-button-disable");const a=await this.$http.executePost("/beatmaps/task/"+e+"/removeCollab",{user:t});this.$http.isError(a)||this.$store.dispatch("beatmaps/updateBeatmap",a),s.target.classList.remove("fake-button-disable")},isAddingCollaborator(e){var t;return(null==(t=this.taskToAddCollaborator)?void 0:t.id)==e.id}}});m("data-v-9a22532c");const ns={class:"row"},ds={class:"col-sm-12"},rs={class:"table table-sm"},cs=g("th",null,"Difficulty",-1),ms=g("th",null,"Mapper(s)",-1),us={key:0},ps=["id"],hs=[g("i",{class:"fas fa-times"},null,-1)],bs=["onClick"],ks=[g("i",{class:"fas fa-plus"},null,-1)],fs=["onClick"],gs=[g("i",{class:"fas fa-minus"},null,-1)],ys={key:0},vs=["onClick"],Bs=[g("i",{class:"fas fa-minus"},null,-1)],ws=["onClick"],xs=[g("i",{class:"fas fa-check"},null,-1)],Is=["onClick"],Ls=[g("i",{class:"fas fa-ellipsis-h"},null,-1)],Ts={key:0,class:"col-sm-12 mt-2"};u(),is.render=function(e,t,s,a,o,l){const i=p("modes-icons"),n=p("user-link"),d=p("new-task"),r=h("bs-tooltip");return b(),B("div",ns,[g("div",ds,[g("table",rs,[g("thead",null,[g("tr",null,[cs,ms,e.isRanked||e.isQualified?S("",!0):(b(),B("th",us))])]),C(P,{tag:"tbody",name:"list"},{default:f((()=>[(b(!0),B(I,null,w(e.sortedTasks,(s=>(b(),B("tr",{id:s.id+"Row",key:s.id},[g("td",{class:O(["text-secondary",`card-status-${s.status.toLowerCase()}`])},[$(x(s.name)+" ",1),"hybrid"==e.beatmap.mode?(b(),k(i,{key:0,modes:[s.mode]},null,8,["modes"])):S("",!0)],2),g("td",null,[(b(!0),B(I,null,w(s.mappers,((a,o)=>(b(),B("div",{key:a.id},[0==o&&e.canEditTaskCollaborators(s)?(b(),B(I,{key:0},[e.isAddingCollaborator(s)?y((b(),B("a",{key:0,href:"#",class:"text-danger",onClick:t[0]||(t[0]=q((t=>e.taskToAddCollaborator=void 0),["prevent"]))},hs,512)),[[r,"cancel"]]):y((b(),B("a",{key:1,href:"#",class:"text-success",onClick:q((t=>e.taskToAddCollaborator=s),["prevent"])},ks,8,bs)),[[r,"add new collaborator"]])],64)):S("",!0),C(n,{class:"mx-1",user:a},null,8,["user"]),s.mappers.length>1&&e.canEditTaskCollaborators(s)&&a.osuId!=e.loggedInUser.osuId?y((b(),B("a",{key:1,href:"#",class:"text-danger",onClick:q((t=>e.removeCollab(s.id,a.id,t)),["prevent"])},gs,8,fs)),[[r,"remove collaborator"]]):S("",!0)])))),128))]),e.isRanked||e.isQualified?S("",!0):(b(),B("td",ys,[e.canEditTask(s)?(b(),B(I,{key:0},[y(g("a",{href:"#",class:"text-danger me-1",onClick:q((t=>e.removeTask(s.id,t)),["prevent"])},Bs,8,vs),[[r,"delete"]]),"WIP"==s.status?y((b(),B("a",{key:0,href:"#",class:"text-success me-1",onClick:q((t=>e.setTaskStatus(s.id,"Done",t)),["prevent"])},xs,8,ws)),[[r,"mark as done"]]):S("",!0),"Done"==s.status&&"Done"!=e.beatmap.status?y((b(),B("a",{key:1,href:"#",class:"text-wip me-1",onClick:q((t=>e.setTaskStatus(s.id,"WIP",t)),["prevent"])},Ls,8,Is)),[[r,"mark as WIP"]]):S("",!0)],64)):S("",!0)]))],8,ps)))),128))])),_:1})])]),e.isRanked||e.isQualified?S("",!0):(b(),B("div",Ts,[C(d,{"task-to-add-collaborator":e.taskToAddCollaborator,"onUpdate:task-to-add-collaborator":t[1]||(t[1]=t=>e.taskToAddCollaborator=t),beatmap:e.beatmap,"is-host":e.isHost},null,8,["task-to-add-collaborator","beatmap","is-host"])]))])},is.__scopeId="data-v-9a22532c";var Ms=r({name:"QuestOrMissionChoice",props:{beatmap:{type:Object,required:!0}},data:()=>({userQuests:[],openMissions:[],showInput:!1,dropdownId:""}),computed:c(["loggedInUser"]),watch:{beatmap(){var e,t;this.showInput=!1,this.dropdownId=(null==(e=this.beatmap.quest)?void 0:e.id)||(null==(t=this.beatmap.mission)?void 0:t.id)||""}},async created(){const e=await this.$http.executeGet(`/users/${this.loggedInUser.id}/quests`),t=await this.$http.executeGet(`/missions/open/${this.beatmap.mode}`);this.$http.isError(e)||(this.userQuests=e),this.$http.isError(t)||(this.openMissions=t)},methods:{async linkQuestOrMission(e){const t=this.userQuests.find((e=>e.id==this.dropdownId)),s=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/${t?"linkQuest":"linkMission"}`,{questOrMissionId:this.dropdownId},e);this.$http.isError(s)||this.$store.dispatch("beatmaps/updateBeatmap",s)}}});const Cs={class:"row mb-2"},$s={class:"col"},Ss=$(" Quest "),Os=[g("i",{class:"fas fa-edit"},null,-1)],Ps={class:"small ms-3 text-secondary"},As=["href"],Us=["href"],qs={key:2},Es={key:0,class:"row mb-2"},Qs={class:"col"},js={class:"input-group input-group-sm"},Ds=g("option",{value:""}," No quest ",-1),Fs={key:0,disabled:""},Vs=["value"],Hs={key:1,disabled:""},Ns=["value"],_s=[$(" Save ")];Ms.render=function(e,t,s,a,o,l){const i=h("bs-tooltip");return b(),B("div",null,[g("div",Cs,[g("div",$s,[g("div",null,[Ss,y(g("a",{id:"editLink",href:"#",class:O([e.showInput?"text-danger":"","text-success small ms-1"]),onClick:t[0]||(t[0]=q((t=>e.showInput=!e.showInput),["prevent"]))},Os,2),[[i,"connect mapset with a quest","right"]])]),g("div",Ps,[e.beatmap.quest?(b(),B("a",{key:0,href:`/quests?id=${e.beatmap.quest.id}`},x(e.beatmap.quest.name),9,As)):e.beatmap.mission?(b(),B("a",{key:1,href:`/missions?id=${e.beatmap.mission.id}`},x(e.beatmap.mission.name),9,Us)):(b(),B("i",qs,"none"))])])]),e.showInput?(b(),B("div",Es,[g("div",Qs,[g("div",js,[y(g("select",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.dropdownId=t),class:"form-select"},[Ds,e.userQuests.length?(b(),B("option",Fs," --- claimed quests --- ")):S("",!0),(b(!0),B(I,null,w(e.userQuests,(e=>(b(),B("option",{key:e.id,value:e.id},x(e.name),9,Vs)))),128)),e.openMissions.length?(b(),B("option",Hs," --- open priority quests --- ")):S("",!0),(b(!0),B(I,null,w(e.openMissions,(e=>(b(),B("option",{key:e.id,value:e.id},x(e.name),9,Ns)))),128))],512),[[v,e.dropdownId]]),y(g("button",{class:"btn btn-outline-info",onClick:t[2]||(t[2]=t=>e.linkQuestOrMission(t))},_s,512),[[i,"link beatmap to quest"]])])])])):S("",!0)])};var Rs=r({name:"ModdersList",components:{UserLinkList:_},props:{canEdit:Boolean,beatmap:{type:Object,required:!0}},computed:d(n({},c(["loggedInUser"])),{isModder(){return this.beatmap.modders.some((e=>e.osuId==this.loggedInUser.osuId))}}),methods:{async updateModder(e){e.target.classList.add("fake-button-disable");const t=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/updateModder`);this.$http.isError(t)||this.$store.dispatch("beatmaps/updateBeatmap",t),e.target.classList.remove("fake-button-disable")}}});const Gs={id:"modders",class:"row mb-2"},Ws={class:"col"},Ks={key:0,class:"ms-1"},Ys={class:"small ms-3"},zs={key:0,class:"text-secondary"};Rs.render=function(e,t,s,a,o,l){const i=p("user-link-list"),n=h("bs-tooltip");return b(),B("div",Gs,[g("div",Ws,[g("div",null,[$(" Modders ("+x(e.beatmap.modders.length)+") ",1),e.canEdit?y((b(),B("small",Ks,[g("a",{href:"#",class:O(e.isModder?"text-danger":"text-success"),onClick:t[0]||(t[0]=q((t=>e.updateModder(t)),["prevent"]))},[g("i",{class:O(["fas",e.isModder?"fa-minus":"fa-plus"])},null,2)],2)],512)),[[n,"add/remove yourself from modder list","right"]]):S("",!0)]),g("div",Ys,[0==e.beatmap.modders.length?(b(),B("i",zs," none ")):(b(),k(i,{key:1,users:e.beatmap.modders},null,8,["users"]))])])])};var Js=r({name:"NominatorsList",components:{UserLinkList:_},props:{canEdit:Boolean,beatmap:{type:Object,required:!0}},computed:d(n({},c(["loggedInUser"])),{isBn(){return this.beatmap.bns.some((e=>e.osuId==this.loggedInUser.osuId))}}),methods:{async updateBn(e){e.target.classList.add("fake-button-disable");const t=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/updateBn`);this.$http.isError(t)||this.$store.dispatch("beatmaps/updateBeatmap",t),e.target.classList.remove("fake-button-disable")}}});const Xs={key:0,class:"ms-1"},Zs=[g("i",{class:"fas fa-minus"},null,-1)],ea=[g("i",{class:"fas fa-plus"},null,-1)],ta={class:"small ms-3"},sa={key:0,class:"text-secondary"};Js.render=function(e,t,s,a,o,l){const i=p("user-link-list"),n=h("bs-tooltip");return b(),B("div",null,[g("div",null,[$(" Nominators ("+x(e.beatmap.bns.length)+") ",1),e.canEdit?y((b(),B("small",Xs,[e.isBn?(b(),B("a",{key:0,href:"#",class:"text-danger",onClick:t[0]||(t[0]=q((t=>e.updateBn(t)),["prevent"]))},Zs)):S("",!0),!e.isBn&&e.beatmap.bns.length<2?(b(),B("a",{key:1,href:"#",class:"text-success",onClick:t[1]||(t[1]=q((t=>e.updateBn(t)),["prevent"]))},ea)):S("",!0)],512)),[[n,"add/remove yourself from potential BN list","right"]]):S("",!0)]),g("div",ta,[0==e.beatmap.bns.length?(b(),B("i",sa,"none")):(b(),k(i,{key:1,users:e.beatmap.bns},null,8,["users"]))])])};var aa=r({name:"BeatmapLink",props:{beatmap:{type:Object,required:!0}},data:()=>({url:"",showLinkInput:!1}),watch:{beatmap(e){e&&(this.showLinkInput=!1,this.url=e.url)}},created(){this.url=this.beatmap.url},methods:{async saveLink(e){const t=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/setLink`,{url:this.url},e);this.$http.isError(t)||(this.showLinkInput=!1,this.$store.dispatch("beatmaps/updateBeatmap",t))}}});const oa={class:"row mb-2"},la={class:"col"},ia=$(" Link "),na=[g("i",{class:"fas fa-edit"},null,-1)],da={class:"small ms-3"},ra=["href"],ca={key:1,class:"text-secondary"},ma={key:0,class:"row mb-2"},ua={class:"col-sm-12"},pa={class:"input-group input-group-sm"};aa.render=function(e,t,s,a,o,l){const i=h("bs-tooltip");return b(),B("div",null,[g("div",oa,[g("div",la,[g("div",null,[ia,y(g("a",{id:"editLink",href:"#",class:O(["text-success small ms-1",{"text-danger":e.showLinkInput}]),onClick:t[0]||(t[0]=q((t=>e.showLinkInput=!e.showLinkInput),["prevent"]))},na,2),[[i,"edit link","right"]])]),g("div",da,[e.beatmap.url?(b(),B("a",{key:0,href:e.beatmap.url,target:"_blank",class:"text-truncate",style:{display:"block"}},x(e.beatmap.url),9,ra)):(b(),B("i",ca,"none"))])])]),e.showLinkInput?(b(),B("div",ma,[g("div",ua,[g("div",pa,[y(g("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.url=t),class:"form-control form-control-sm",type:"text",placeholder:"URL",onKeyup:t[2]||(t[2]=T((t=>e.saveLink(t)),["enter"]))},null,544),[[L,e.url]]),g("button",{id:"addLinkButton",class:"btn btn-outline-info",type:"submit",onClick:t[3]||(t[3]=t=>e.saveLink(t))}," Save ")])])])):S("",!0)])};var ha=r({name:"LocksChoice",props:{beatmap:{type:Object,required:!0},beatmapId:{type:String,required:!0}},data:()=>({lockTaskSelection:"",showLocksInput:!1,phaseEdit:!1}),computed:{remainingTasks(){var e,t;let s=Object.values(Y);return(null==(t=null==(e=this.beatmap)?void 0:e.tasksLocked)?void 0:t.length)&&(s=s.filter((e=>!this.beatmap.tasksLocked.includes(e)))),this.lockTaskSelection=s[0]||"",s}},watch:{beatmapId(){this.showLocksInput=!1},beatmap(){this.beatmap.tasksLocked.length>=6&&(this.showLocksInput=!1)}},methods:{async unlockTask(e,t){t.target.classList.add("fake-button-disable");const s=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/unlockTask`,{task:e});this.$http.isError(s)||this.$store.dispatch("beatmaps/updateBeatmap",s),t.target.classList.remove("fake-button-disable")},async lockTask(e){const t=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/lockTask`,{task:this.lockTaskSelection},e);this.$http.isError(t)||this.$store.dispatch("beatmaps/updateBeatmap",t)}}});const ba={id:"locks",class:"row mb-1"},ka={class:"col"},fa=$(" Locks "),ga=[g("i",{class:"fas fa-edit"},null,-1)],ya={class:"small ms-3"},va={key:0},Ba={key:1},wa=["onClick"],xa=[g("i",{class:"fas fa-minus"},null,-1)],Ia={class:"text-secondary mx-1"},La={key:0,class:"row"},Ta={class:"col"},Ma={class:"input-group input-group-sm"},Ca=["value"],$a=[g("i",{class:"fas fa-lock"},null,-1)];ha.render=function(e,t,s,a,o,l){const i=h("bs-tooltip");return b(),B("div",null,[g("div",ba,[g("div",ka,[g("div",null,[fa,e.beatmap.tasksLocked.length<6?y((b(),B("a",{key:0,class:O(["text-success small ms-1",{"text-danger":e.showLocksInput}]),href:"#",onClick:t[0]||(t[0]=q((t=>e.showLocksInput=!e.showLocksInput),["prevent"]))},ga,2)),[[i,"edit locks","right"]]):S("",!0)]),g("div",ya,[0==e.beatmap.tasksLocked.length?(b(),B("i",va,"none")):S("",!0),e.beatmap.tasksLocked.length>0?(b(),B("div",Ba,[(b(!0),B(I,null,w(e.beatmap.tasksLocked,(t=>(b(),B("div",{key:t},[y(g("a",{href:"#",class:O(["text-danger",e.phaseEdit?"fake-button-disable":""]),onClick:q((s=>e.unlockTask(t,s)),["prevent"])},xa,10,wa),[[i,"unlock","left"]]),g("span",Ia,x(t),1)])))),128))])):S("",!0)])])]),e.showLocksInput?(b(),B("div",La,[g("div",Ta,[g("div",Ma,[y(g("select",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.lockTaskSelection=t),class:"form-select"},[(b(!0),B(I,null,w(e.remainingTasks,(e=>(b(),B("option",{key:e,value:e},x(e),9,Ca)))),128))],512),[[v,e.lockTaskSelection]]),y(g("button",{id:"lockTask",class:"btn btn-outline-info",onClick:t[2]||(t[2]=t=>e.lockTask(t))},$a,512),[[i,"prevent other mappers from claiming a difficulty","right"]])])])])):S("",!0)])};var Sa=r({name:"Points",props:{beatmap:{type:Object,required:!0}},data:()=>({tasksPointsArray:null,usersPointsArrays:null,pointsInfo:null,totalPoints:null,isLoading:!1}),watch:{beatmap(){this.tasksPointsArray=null,this.usersPointsArrays=null,this.pointsInfo=null,this.totalPoints=null,this.isLoading=!1}},methods:{async findPoints(e){this.isLoading=!0;const t=await this.$http.executeGet(`/beatmaps/${this.beatmap.id}/findPoints`,e);this.$http.isError(t)||(this.tasksPointsArray=t.tasksPointsArray,this.usersPointsArrays=t.usersPointsArrays,this.pointsInfo=t.pointsInfo,this.totalPoints=t.totalPoints),this.isLoading=!1}}});const Oa={class:"row"},Pa={class:"col-sm-12"},Aa=[$(" Calculate points ")],Ua={key:1,class:"small text-secondary ms-2"},qa={key:2,class:"small text-secondary ms-2"},Ea={key:0,class:"col-sm-6"},Qa={class:"small text-secondary"},ja={class:"col-sm-6"},Da={key:0,class:"small text-secondary"},Fa={key:1,class:"col-sm-12"},Va={class:"small text-secondary ms-2"};Sa.render=function(e,t,s,a,o,l){const i=h("bs-tooltip");return b(),B("div",null,[g("div",Oa,[g("div",Pa,[e.tasksPointsArray?S("",!0):y((b(),B("button",{key:0,class:"btn btn-sm btn-outline-info ms-1",onClick:t[0]||(t[0]=t=>e.findPoints(t))},Aa,512)),[[i,"calculate points for all difficulties"]]),e.isLoading?(b(),B("span",Ua," calculating... ")):e.pointsInfo?(b(),B("span",qa,x(e.pointsInfo),1)):S("",!0)]),e.tasksPointsArray?(b(),B("div",Ea,[g("ul",Qa,[(b(!0),B(I,null,w(e.tasksPointsArray,((e,t)=>(b(),B("li",{key:t},x(e),1)))),128))])])):S("",!0),g("div",ja,[e.usersPointsArrays?(b(),B("ul",Da,[(b(!0),B(I,null,w(e.usersPointsArrays,((t,s)=>(b(),B("li",{key:s},x(e.usersPointsArrays[s][0])+": "+x(e.usersPointsArrays[s][1]),1)))),128))])):S("",!0)]),e.totalPoints?(b(),B("div",Fa,[g("span",Va," total: "+x(Math.round(10*e.totalPoints)/10),1)])):S("",!0)])])};var Ha=r({name:"BeatmapInfo",components:{ModeChoice:$t,StatusChoice:Vt,TasksChoice:is,QuestOrMissionChoice:Ms,ModdersList:Rs,NominatorsList:Js,BeatmapLink:aa,LocksChoice:ha,Points:Sa},props:{beatmap:{type:Object,required:!0}},data:()=>({userQuests:null}),computed:d(n({},c(["loggedInUser"])),{isHost(){return!(!this.loggedInUser.id||!this.beatmap)&&this.loggedInUser.id===this.beatmap.host.id},isRanked(){return this.beatmap.status===N.Ranked},isQualified(){return this.beatmap.status===N.Qualified}}),methods:{async deleteMap(e){if(confirm("Are you sure you want to delete?")){e.target.disabled=!0;const t=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/delete`,{},e);this.$http.isError(t)||(this.$bs.hideModal("editBeatmap"),this.$store.commit("beatmaps/deleteBeatmap",t)),e.target.disabled=!1}}}});m("data-v-08312034");const Na={key:0,class:"container"},_a={class:"row"},Ra={class:"row mb-2"},Ga={class:"col-sm-6"},Wa={key:0,id:"bns",class:"col-sm-6"},Ka=g("hr",null,null,-1),Ya={class:"row"},za={class:"col-sm"},Ja={key:0,class:"col-lg-5 bm-col-separator-left"},Xa={key:0,class:"row"},Za={class:"col-sm"},eo=g("hr",null,null,-1),to={class:"row"},so={class:"col-sm"},ao=g("hr",null,null,-1),oo={class:"row"},lo={class:"col-sm-4 text-end"},io={class:"small text-secondary"};u(),Ha.render=function(e,t,s,a,o,l){const i=p("modders-list"),n=p("nominators-list"),d=p("tasks-choice"),r=p("status-choice"),c=p("mode-choice"),m=p("quest-or-mission-choice"),u=p("beatmap-link"),h=p("locks-choice"),f=p("points");return e.beatmap?(b(),B("div",Na,[g("div",_a,[g("div",{class:O(e.isHost&&!e.isRanked?"col-lg-7":"col-sm-12")},[g("div",Ra,[g("div",Ga,[C(i,{beatmap:e.beatmap,"can-edit":!e.isHost&&!e.isRanked},null,8,["beatmap","can-edit"])]),!e.isRanked||e.beatmap.bns?(b(),B("div",Wa,[C(n,{beatmap:e.beatmap,"can-edit":!e.isHost&&!e.isRanked},null,8,["beatmap","can-edit"])])):S("",!0)]),Ka,g("div",Ya,[g("div",za,[C(d,{beatmap:e.beatmap,"is-host":e.isHost,"is-ranked":e.isRanked,"is-qualified":e.isQualified},null,8,["beatmap","is-host","is-ranked","is-qualified"])])])],2),e.isHost&&!e.isRanked?(b(),B("div",Ja,[e.isQualified?S("",!0):(b(),B("div",Xa,[g("div",Za,[C(r,{beatmap:e.beatmap},null,8,["beatmap"]),eo])])),g("div",to,[g("div",so,["WIP"==e.beatmap.status?(b(),k(c,{key:0,class:"mb-2",beatmap:e.beatmap},null,8,["beatmap"])):S("",!0)])]),C(m,{beatmap:e.beatmap},null,8,["beatmap"]),e.isQualified?S("",!0):(b(),k(u,{key:1,beatmap:e.beatmap},null,8,["beatmap"])),"WIP"==e.beatmap.status?(b(),k(h,{key:2,beatmap:e.beatmap,"beatmap-id":e.beatmap.id},null,8,["beatmap","beatmap-id"])):S("",!0)])):S("",!0)]),ao,g("div",oo,[C(f,{class:"col-sm-8",beatmap:e.beatmap},null,8,["beatmap"]),g("div",lo,[g("span",io," Created: "+x(e.beatmap.createdAt.toString().slice(0,10)),1),e.isHost&&!e.isRanked?(b(),B("button",{key:0,id:"deleteButton",class:"btn btn-sm btn-outline-danger ms-2",onClick:t[0]||(t[0]=t=>e.deleteMap(t))}," Delete ")):S("",!0)])])])):S("",!0)},Ha.__scopeId="data-v-08312034";var no=r({name:"BeatmapTableRow",components:{BeatmapInfo:Ha,ProcessTasks:nt,QuestImg:dt,ModesIcons:V},props:{beatmap:{type:Object,required:!0}},methods:{selectBeatmap(){this.$route.query.id!==this.beatmap.id&&this.$router.push(`/beatmaps?id=${this.beatmap.id}`)},formatMetadata(){const e=this.beatmap.song.artist+" - "+this.beatmap.song.title;return e.length>70?e.slice(0,70)+"...":e},statusBorder(){return this.beatmap.status?"card-status-"+this.beatmap.status.toLowerCase():""}}});const ro={class:"container"},co={class:"row"},mo={class:"col-sm-6"},uo=["data-bs-target"],po=g("i",{class:"fas fa-angle-down"},null,-1),ho={class:"col-sm-2 small d-flex justify-content-end align-items-center"},bo={class:"col-sm-3 small"},ko=g("span",{class:"text-secondary me-1"},"Hosted by",-1),fo={key:0,class:"text-secondary"},go={key:0,class:"col-sm-1 d-flex justify-content-end align-items-center"},yo=["href"],vo=[g("i",{class:"fas fa-link"},null,-1)],Bo=["id"];no.render=function(e,t,s,a,o,l){const i=p("quest-img"),n=p("process-tasks"),d=p("user-link"),r=p("modes-icons"),c=p("beatmap-info");return b(),B("div",null,[g("div",{class:O(["card card-body card-level-2 my-1 p-1",e.statusBorder()])},[g("div",ro,[g("div",co,[g("div",mo,[C(i,{beatmap:e.beatmap},null,8,["beatmap"]),g("a",{href:"#","data-bs-toggle":"collapse","data-bs-target":"#details"+e.beatmap.id,onClick:t[0]||(t[0]=t=>e.selectBeatmap())},[$(x(e.formatMetadata())+" ",1),po],8,uo)]),g("div",ho,[C(n,{tasks:e.beatmap.tasks,"tasks-locked":e.beatmap.tasksLocked,mode:e.beatmap.mode},null,8,["tasks","tasks-locked","mode"])]),g("div",bo,[ko,C(d,{class:"me-1",user:e.beatmap.host},null,8,["user"]),"osu"!==e.beatmap.mode?(b(),B("span",fo,[C(r,{modes:[e.beatmap.mode]},null,8,["modes"])])):S("",!0)]),e.beatmap.url?(b(),B("div",go,[g("a",{href:e.beatmap.url,target:"_blank"},vo,8,yo)])):S("",!0)])])],2),g("div",{id:"details"+e.beatmap.id,class:O(["collapse my-2 mx-4 row border-end border-start py-3","border-"+e.beatmap.status.toLowerCase()])},[C(c,{beatmap:e.beatmap},null,8,["beatmap"])],10,Bo)])};var wo=r({components:{BeatmapTableRow:no},computed:c("beatmaps",{otherBeatmaps:"allBeatmaps",isLoadingOtherBeatmaps:"isLoadingOtherBeatmaps",filterValue:"filterValue"}),methods:{async showMore(e){e.target.disabled=!0,this.$store.commit("beatmaps/increaseFetchLimit"),await this.$store.dispatch("beatmaps/loadOtherBeatmaps"),e.target.disabled=!1}}});const xo={class:"container card card-body py-3"},Io={class:"ms-2"},Lo={href:"#otherBeatmaps","data-bs-toggle":"collapse"},To=g("i",{class:"fas fa-angle-down"},null,-1),Mo={key:0,id:"otherBeatmaps",class:"collapse"},Co={key:0,class:"ms-5 text-secondary"},$o={key:1,class:"text-center"},So=[g("i",{class:"fas fa-angle-down me-1"},null,-1),$(" show more "),g("i",{class:"fas fa-angle-down ms-1"},null,-1)];wo.render=function(e,t,s,a,o,l){const i=p("beatmap-table-row");return b(),B("div",xo,[g("h5",Io,[g("a",Lo,[$(" Other beatmaps ("+x(e.otherBeatmaps&&!e.isLoadingOtherBeatmaps?e.otherBeatmaps.length:"...")+") ",1),To])]),e.otherBeatmaps?(b(),B("div",Mo,[g("div",{class:O({"loading-data":e.isLoadingOtherBeatmaps})},[e.otherBeatmaps.length||e.isLoadingOtherBeatmaps?S("",!0):(b(),B("p",Co," None... ")),(b(!0),B(I,null,w(e.otherBeatmaps,(e=>(b(),k(i,{key:e.id,beatmap:e},null,8,["beatmap"])))),128)),e.filterValue?S("",!0):(b(),B("div",$o,[g("button",{class:"btn btn-sm btn-outline-info my-4",onClick:t[0]||(t[0]=q((t=>e.showMore(t)),["prevent"]))},So)]))],2)])):S("",!0)])};var Oo=r({components:{BeatmapInfo:Ha,ModalDialog:F,QuestImg:dt,ModesIcons:V},props:{selectedBeatmap:{type:Object,default:()=>({})}},watch:{selectedBeatmap(){this.selectedBeatmap&&this.$route.query.id!==this.selectedBeatmap.id&&this.$router.replace(`/beatmaps?id=${this.selectedBeatmap.id}`)}}});const Po=["href"],Ao=g("i",{class:"fas fa-link"},null,-1),Uo={key:1},qo=$(" |");Oo.render=function(e,t,s,a,o,l){const i=p("quest-img"),n=p("user-link"),d=p("modes-icons"),r=p("beatmap-info"),c=p("modal-dialog");return b(),k(c,{id:"editBeatmap",loaded:Boolean(e.selectedBeatmap),"header-class":e.selectedBeatmap?"bg-"+e.selectedBeatmap.status.toLowerCase():""},{header:f((()=>[C(i,{beatmap:e.selectedBeatmap},null,8,["beatmap"]),e.selectedBeatmap.url?(b(),B("a",{key:0,href:e.selectedBeatmap.url,target:"_blank"},[Ao,$(" "+x(e.selectedBeatmap.song.artist)+" - "+x(e.selectedBeatmap.song.title),1)],8,Po)):(b(),B("span",Uo,x(e.selectedBeatmap.song.artist)+" - "+x(e.selectedBeatmap.song.title),1)),qo,C(n,{class:"mx-1",user:e.selectedBeatmap.host},null,8,["user"]),C(d,{modes:[e.selectedBeatmap.mode]},null,8,["modes"])])),default:f((()=>[C(r,{beatmap:e.selectedBeatmap},null,8,["beatmap"])])),_:1},8,["loaded","header-class"])};var Eo={namespaced:!0,state:{allBeatmaps:[],userBeatmaps:[],filterValue:"",filterMode:W.any,filterStatus:"any",filterQuest:"any",selectedBeatmap:null,selectedBeatmapId:null,fetchLimit:30,isLoadingOtherBeatmaps:!0},mutations:{setAllBeatmaps(e,t){e.allBeatmaps=t},setUserBeatmaps(e,t){e.userBeatmaps=t},setFilterValue(e,t){e.filterValue=t},setFilterMode(e,t){e.filterMode=t},setFilterStatus(e,t){e.filterStatus=t},setFilterQuest(e,t){e.filterQuest=t},setIsLoadingOtherBeatmaps(e,t){e.isLoadingOtherBeatmaps=t},increaseFetchLimit(e){e.fetchLimit+=50},setSelectedBeatmap(e,t){const s=Object.values(Y);t.tasks.sort((function(e,t){return s.indexOf(e.name)-s.indexOf(t.name)})),t.tasksLocked.sort((function(e,t){return s.indexOf(e)-s.indexOf(t)})),e.selectedBeatmap=t},addBeatmap(e,t){e.userBeatmaps.unshift(t)},updateBeatmap(e,t){let s=e.allBeatmaps.findIndex((e=>e.id===t.id));-1!==s&&(e.allBeatmaps[s]=t),s=e.userBeatmaps.findIndex((e=>e.id===t.id)),-1!==s&&(e.userBeatmaps[s]=t)},deleteBeatmap(e,t){let s=e.allBeatmaps.findIndex((e=>e.id===t.id));-1!==s&&e.allBeatmaps.splice(s,1),s=e.userBeatmaps.findIndex((e=>e.id===t.id)),-1!==s&&e.userBeatmaps.splice(s,1)}},getters:{filteredUserBeatmaps:e=>{let t=e.userBeatmaps;if(e.filterMode!==W.any){const s=e.filterMode;t=t.filter((e=>e.mode===s||e.mode===H.Hybrid))}if("any"!==e.filterStatus&&(t=t.filter((t=>t.status===e.filterStatus))),"any"!==e.filterQuest&&(t=t.filter((e=>!e.quest))),e.filterValue){const s=e.filterValue.toLowerCase().trim().split(" ").filter((e=>e.length));t=t.filter((e=>{let t=e.song.artist+" "+e.song.title+" "+e.host.username;return e.tasks.forEach((e=>{e.mappers.forEach((e=>{t+=" "+e.username}))})),t=t.toLowerCase(),s.some((e=>t.includes(e)))}))}return t},guestDifficultyBeatmaps:(e,t,s)=>t.filteredUserBeatmaps.filter((e=>{var t;return e.host.id!==(null==(t=s.loggedInUser)?void 0:t.id)})),hostedBeatmaps:(e,t,s)=>t.filteredUserBeatmaps.filter((e=>{var t;return e.host.id===(null==(t=s.loggedInUser)?void 0:t.id)}))},actions:{updateBeatmap({commit:e,state:t},s){var a;e("updateBeatmap",s),(null==(a=t.selectedBeatmap)?void 0:a.id)===s.id&&e("setSelectedBeatmap",s)},async updateFilterMode({commit:e,dispatch:t},s){e("setFilterMode",s),await t("loadOtherBeatmaps")},async updateFilterStatus({commit:e,dispatch:t},s){e("setFilterStatus",s),await t("loadOtherBeatmaps")},async updateFilterQuest({commit:e,dispatch:t},s){e("setFilterQuest",s),await t("loadOtherBeatmaps")},async updateFilterValue({commit:e,dispatch:t},s){e("setFilterValue",s),await t("loadOtherBeatmaps")},async loadOtherBeatmaps({commit:e,state:t}){var s;e("setIsLoadingOtherBeatmaps",!0);const a="any"!==t.filterStatus?`&status=${t.filterStatus}`:"",o="any"!==t.filterQuest?`&quest=${t.filterQuest}`:"",l=t.filterValue?`&search=${t.filterValue}`:"",i=await D.get(`/api/beatmaps/search?mode=${t.filterMode}&limit=${t.fetchLimit+a+o+l}`);(null==(s=i.data)?void 0:s.allBeatmaps)&&e("setAllBeatmaps",i.data.allBeatmaps),e("setIsLoadingOtherBeatmaps",!1)}}},Qo=r({name:"BeatmapPage",components:{BeatmapPageFilters:Ye,HostedBeatmaps:kt,GuestDifficulties:xt,OtherBeatmaps:wo,EditBeatmapModal:Oo,CreateBeatmapModal:z},data:()=>({isLoadingGuestBeatmaps:!0}),computed:c("beatmaps",["selectedBeatmap"]),beforeCreate(){this.$store.hasModule("beatmaps")||this.$store.registerModule("beatmaps",Eo)},async created(){const e=this.$route.query.id;let t,s;e?([t,s]=await Promise.all([this.$http.initialRequest("/beatmaps/relevantInfo"),this.$http.executeGet("/beatmaps/searchOnLoad/"+e)]),this.$http.isError(s)||(this.$store.commit("beatmaps/setSelectedBeatmap",s),this.$bs.showModal("editBeatmap"))):t=await this.$http.initialRequest("/beatmaps/relevantInfo"),this.$http.isError(t)||(this.$store.commit("beatmaps/setUserBeatmaps",t.beatmaps),this.$store.commit("beatmaps/setFilterMode",t.mainMode)),await Promise.all([this.loadGuestBeatmaps(),this.$store.dispatch("beatmaps/loadOtherBeatmaps")]),this.isLoadingGuestBeatmaps=!1},methods:{async loadGuestBeatmaps(){const e=await this.$http.executeGet("/beatmaps/guestBeatmaps");e&&this.$store.commit("beatmaps/setUserBeatmaps",e.userBeatmaps)}}});const jo=g("div",{class:"radial-divisor"},null,-1),Do=g("div",{class:"radial-divisor"},null,-1);Qo.render=function(e,t,s,a,o,l){const i=p("beatmap-page-filters"),n=p("hosted-beatmaps"),d=p("guest-difficulties"),r=p("other-beatmaps"),c=p("edit-beatmap-modal"),m=p("create-beatmap-modal");return b(),B("div",null,[C(i),C(n),jo,C(d,{"is-loading-guest-beatmaps":e.isLoadingGuestBeatmaps},null,8,["is-loading-guest-beatmaps"]),Do,C(r),C(c,{"selected-beatmap":e.selectedBeatmap},null,8,["selected-beatmap"]),C(m)])};export{Qo as default};
