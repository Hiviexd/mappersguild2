import{d as q,M as f,m as Q,_ as b,o as r,e as h,a as u,j as a,w as M,c as I,l as _,r as n,t as o}from"./index-8e3bc4da.js";import{S as $}from"./SubmitQuestModal-b97b8e59.js";import{Q as P}from"./QuestInfo-72d7c505.js";import{D as x}from"./DataTable-3e54ec74.js";import"./ModalDialog-026843c4.js";import"./FormTextarea-6290b7a8.js";import"./AssociatedBeatmaps-e85cc27e.js";const g={state:{quests:[],exampleQuest:null},mutations:{setQuests(e,t){e.quests=t},setExampleQuest(e,t){e.exampleQuest=t},updateQuest(e,t){const s=e.quests.findIndex(i=>i.id===t.id);s!==-1&&(e.quests[s]=t)},addQuest(e,t){e.quests.push(t)},deleteQuest(e,t){const s=e.quests.findIndex(i=>i.id===t.id);e.quests.splice(s,1)},renameQuest(e,t){const s=e.quests.find(i=>i.id==t.questId);s&&(s.name=t.name)},updatePrice(e,t){const s=e.quests.find(i=>i.id==t.questId);s&&(s.price=t.price)},updateRequiredMapsets(e,t){const s=e.quests.find(i=>i.id==t.questId);s&&(s.requiredMapsets=t.requiredMapsets)},updateDescription(e,t){const s=e.quests.find(i=>i.id==t.questId);s&&(s.descriptionMain=t.description)},resetQuestDeadline(e,t){const s=e.quests.find(i=>i.id==t.questId);s&&(s.deadline=t.deadline)},updateExpiration(e,t){const s=e.quests.find(i=>i.id==t.questId);s&&(s.expiration=t.expiration)},updateMinParty(e,t){const s=e.quests.find(i=>i.id==t.questId);s&&(s.minParty=t.minParty)},updateMaxParty(e,t){const s=e.quests.find(i=>i.id==t.questId);s&&(s.maxParty=t.maxParty)}}},v=g,y=q({components:{DataTable:x,SubmitQuestModal:$,QuestInfo:P,ModesIcons:f},data(){return{selectedQuestId:""}},computed:{...Q({quests:e=>e.questsAdmin.quests}),selectedQuest(){return this.quests.find(e=>e.id===this.selectedQuestId)}},beforeCreate(){this.$store.hasModule("questsAdmin")||this.$store.registerModule("questsAdmin",v)},unmounted(){this.$store.hasModule("questsAdmin")&&this.$store.unregisterModule("questsAdmin")},async created(){const e=await this.$http.initialRequest("/admin/quests/load");this.$http.isError(e)||this.$store.commit("setQuests",e)},methods:{deleteQuest(e){const t=this.quests.findIndex(s=>s.id==e.id);this.quests.splice(t,1)},updateQuest(e){const t=this.quests.findIndex(s=>s.id==e.id);t!==-1&&(this.quests[t]=e)},async removeDuplicatePartyMembers(e){await this.$http.executePost("/admin/quests/removeDuplicatePartyMembers",{},e)&&this.$store.dispatch("updateToastMessages",{message:"removed duplicate party members",type:"success"})}}}),D={class:"container card card-body py-1"},w={class:"row"},A={class:"col"},C=u("button",{class:"btn btn-sm btn-info w-100 mb-1","data-bs-toggle":"modal","data-bs-target":"#submitQuest"}," Add quest ",-1);function k(e,t,s,i,B,E){const m=n("modes-icons"),c=n("data-table"),l=n("submit-quest-modal"),p=n("quest-info");return r(),h("div",null,[u("div",D,[u("div",w,[u("div",A,[C,u("button",{class:"btn btn-sm btn-info w-100 mb-1",onClick:t[0]||(t[0]=d=>e.removeDuplicatePartyMembers(d))}," Remove duplicate party members "),a(c,{data:e.quests,headers:["name","creator","modes","status","mapsets"],"custom-data-target":"#editQuest","onUpdate:selectedId":t[1]||(t[1]=d=>e.selectedQuestId=d)},{default:M(({obj:d})=>[u("td",null,o(d.name),1),u("td",null,o(d.creator.username),1),u("td",null,[a(m,{modes:d.modes},null,8,["modes"])]),u("td",null,o(d.status),1),u("td",null,o(d.requiredMapsets),1)]),_:1},8,["data"])])])]),a(l,{"is-admin":!0}),e.selectedQuest?(r(),I(p,{key:0,quest:e.selectedQuest,onUpdateQuest:t[2]||(t[2]=d=>e.updateQuest(d)),onDeleteQuest:t[3]||(t[3]=d=>e.deleteQuest(d))},null,8,["quest"])):_("",!0)])}const z=b(y,[["render",k]]);export{z as default};
