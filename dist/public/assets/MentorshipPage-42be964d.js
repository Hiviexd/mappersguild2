import{d as w,m as M,A as P,_ as k,o as i,e as l,a as s,F as I,r as b,i as c,y as m,b as f,f as $,g as E,p as C,v as A,t as h,j as _,k as g,n as U,q as N,s as T,u as V}from"./index-8be549c0.js";import{m as D,A as L}from"./AddRestrictedUser-0f28fe3f.js";const R=w({name:"Administrators",components:{},data(){return{userInput:null,confirmDelete:null}},computed:{...M(["loggedInUser"]),...P("mentorship",["allAdmins"])},beforeCreate(){this.$store.hasModule("mentorship")||this.$store.registerModule("mentorship",D)},methods:{async toggleIsMentorshipAdmin(e,t){const o=await this.$http.executePost("/mentorship/toggleIsMentorshipAdmin",{userInput:this.userInput,userId:t},e);if(!this.$http.isError(o))if(this.$store.dispatch("updateToastMessages",{message:`${o.isMentorshipAdmin?"Added":"Removed"}`,type:"info"}),o.isMentorshipAdmin){const a=[...this.allAdmins];a.push(o),this.$store.commit("mentorship/setAdmins",a)}else this.$store.commit("mentorship/removeAdmin",t)}}}),K={class:"container card card-body py-3"},B=s("h5",null,"Mentorship Administrators",-1),F=s("div",{class:"text-secondary"}," Users with access to mentorship tools: ",-1),G=["onClick"],j=["onClick"],q={class:"input-group w-25"},z={class:"input-group-append"},H=s("i",{class:"fas fa-plus fa-xs"},null,-1),J=[H];function O(e,t,o,a,p,y){const r=C("user-link");return i(),l("div",null,[s("div",K,[B,F,s("ul",null,[(i(!0),l(I,null,b(e.allAdmins,n=>(i(),l("li",{key:n.id},[c(r,{user:n},null,8,["user"]),e.confirmDelete!=n.id?(i(),l("a",{key:0,href:"#",class:"text-danger",onClick:m(d=>e.confirmDelete=n.id,["prevent"])}," delete ",8,G)):(i(),l("a",{key:1,class:"text-danger",href:"#",onClick:m(d=>e.toggleIsMentorshipAdmin(d,n.id),["prevent"])}," confirm ",8,j))]))),128))]),s("div",q,[f(s("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>e.userInput=n),class:"form-control form-control-sm",autocomplete:"off",placeholder:"new admin username/osuId...",onKeyup:t[1]||(t[1]=E(n=>e.toggleIsMentorshipAdmin(n,null),["enter"]))},null,544),[[$,e.userInput,void 0,{number:!0}]]),s("div",z,[s("button",{class:"btn btn-primary",href:"#",onClick:t[2]||(t[2]=m(n=>e.toggleIsMentorshipAdmin(n,null),["prevent"]))},J)])])])])}const Q=k(R,[["render",O]]),W=w({name:"Cycles",data(){return{cycleNumberInput:null,cycleNameInput:null,cycleUrlInput:null,cycleStartInput:null,cycleEndInput:null,duplicateCycleId:""}},computed:{...M(["loggedInUser"]),...P("mentorship",["allCycles"])},beforeCreate(){this.$store.hasModule("mentorship")||this.$store.registerModule("mentorship",D)},methods:{async addCycle(e){if(confirm("Are you sure? Details cannot be changed after adding.")){const o=await this.$http.executePost("/mentorship/addCycle",{number:this.cycleNumberInput,name:this.cycleNameInput,url:this.cycleUrlInput,startDate:this.cycleStartInput,endDate:this.cycleEndInput,duplicateCycleId:this.duplicateCycleId},e);if(!this.$http.isError(o)){this.$store.dispatch("updateToastMessages",{message:`Added "${o.number} - ${o.name}"`,type:"info"});const a=[...this.allCycles];a.unshift(o),this.$store.commit("mentorship/setCycles",a)}}}}}),X={class:"container card card-body py-3 mb-2"},Y=s("h5",null,"New cycle",-1),Z=s("div",{class:"text-secondary"}," Add a new cycle based on input below. ",-1),x=s("div",{class:"text-secondary"}," To copy relationships from an existing cycle, select the cycle in the dropdown. ",-1),ee={class:"row"},te={class:"col-sm-6 mb-2"},se=s("option",{value:"",selected:"",disabled:""}," Select a cycle to duplicate ",-1),oe=["value"],ne={class:"input-group mt-2"},re={class:"input-group-append"},ie=s("i",{class:"fas fa-plus fa-xs"},null,-1),le=[ie];function ae(e,t,o,a,p,y){return i(),l("div",null,[s("div",X,[Y,Z,x,s("div",ee,[s("div",te,[f(s("select",{"onUpdate:modelValue":t[0]||(t[0]=r=>e.duplicateCycleId=r),class:"form-select form-select d-inline"},[se,(i(!0),l(I,null,b(e.allCycles,r=>(i(),l("option",{key:r.id,value:r.id},h(r.number)+" - "+h(r.name),9,oe))),128))],512),[[A,e.duplicateCycleId]])])]),s("div",ne,[f(s("input",{"onUpdate:modelValue":t[1]||(t[1]=r=>e.cycleNumberInput=r),class:"form-control form-control-sm",autocomplete:"off",type:"number",placeholder:"new cycle number..."},null,512),[[$,e.cycleNumberInput,void 0,{number:!0}]]),f(s("input",{"onUpdate:modelValue":t[2]||(t[2]=r=>e.cycleNameInput=r),class:"form-control form-control-sm",autocomplete:"off",placeholder:"new cycle name..."},null,512),[[$,e.cycleNameInput,void 0,{number:!0}]]),f(s("input",{"onUpdate:modelValue":t[3]||(t[3]=r=>e.cycleUrlInput=r),class:"form-control form-control-sm",autocomplete:"off",placeholder:"cycle details link..."},null,512),[[$,e.cycleUrlInput,void 0,{number:!0}]]),f(s("input",{"onUpdate:modelValue":t[4]||(t[4]=r=>e.cycleStartInput=r),class:"form-control form-control-sm",type:"date"},null,512),[[$,e.cycleStartInput]]),f(s("input",{"onUpdate:modelValue":t[5]||(t[5]=r=>e.cycleEndInput=r),class:"form-control form-control-sm",type:"date"},null,512),[[$,e.cycleEndInput]]),s("div",re,[s("button",{class:"btn btn-primary",href:"#",onClick:t[6]||(t[6]=m(r=>e.addCycle(r),["prevent"]))},le)])])])])}const de=k(W,[["render",ae]]),ce=w({name:"ParticipantList",props:{mode:{type:String,default:""}},data(){return{mentorInput:null,menteeInput:null,editingMentorId:"",confirmDeleteMentor:"",confirmDeleteMentee:"",phaseEdit:!1}},computed:{...M(["loggedInUser"]),...M("mentorship",["showPhases"]),...P("mentorship",["selectedCycle"]),modeMentors(){return this.selectedCycle.participants.filter(t=>{for(const o of t.mentorships)if(o.mode==this.mode&&o.group=="mentor"&&o.cycle.toString()==this.selectedCycle.id)return!0}).sort((t,o)=>t.username.toLowerCase()>o.username.toLowerCase()?1:o.username.toLowerCase()>t.username.toLowerCase()?-1:0)},modeMentees(){return this.selectedCycle.participants.filter(t=>{for(const o of t.mentorships)if(o.mode==this.mode&&o.group=="mentee"&&o.cycle.toString()==this.selectedCycle.id)return!0}).sort((t,o)=>t.username.toLowerCase()>o.username.toLowerCase()?1:o.username.toLowerCase()>t.username.toLowerCase()?-1:0)},title(){return this.mode=="modding"||this.mode=="graduation"||this.mode=="storyboard"?this.mode:this.mode=="osu"?"osu!":"osu!"+this.mode}},beforeCreate(){this.$store.hasModule("mentorship")||this.$store.registerModule("mentorship",D)},methods:{findMentees(e){return this.modeMentees.filter(o=>{for(const a of o.mentorships)if(a.group=="mentee"&&a.mentor.toString()==e&&a.cycle.toString()==this.selectedCycle.id)return!0})},isPhaseParticipant(e,t,o){const a=e.mentorships.find(p=>p.cycle.toString()==this.selectedCycle.id&&p.mode==this.mode&&(p.mentor?p.mentor.toString()==o:o==e.id));return!!(a&&a.phases.includes(t))},involvedInAllPhases(e){return e.mentorships.find(o=>o.cycle.toString()==this.selectedCycle.id&&o.mode==this.mode).phases.length==3},async addMentor(e){const t=await this.$http.executePost("/mentorship/addMentor",{cycleId:this.selectedCycle.id,userInput:this.mentorInput,mode:this.mode},e);this.$http.isError(t)||(this.$store.dispatch("updateToastMessages",{message:`Added "${this.mentorInput}"`,type:"info"}),this.$store.commit("mentorship/updateCycle",t),this.mentorInput=null)},async addMentee(e,t){const o=await this.$http.executePost("/mentorship/addMentee",{cycleId:this.selectedCycle.id,userInput:this.menteeInput,mode:this.mode,mentorId:t},e);this.$http.isError(o)||(this.$store.dispatch("updateToastMessages",{message:`Added "${this.menteeInput}"`,type:"info"}),this.$store.commit("mentorship/updateCycle",o),this.menteeInput=null,this.editingMentorId="")},async removeParticipant(e,t){const o=await this.$http.executePost("/mentorship/removeParticipant",{cycleId:this.selectedCycle.id,userId:t,mode:this.mode},e);this.$http.isError(o)||(this.$store.dispatch("updateToastMessages",{message:"Removed user",type:"info"}),this.$store.commit("mentorship/updateCycle",o),this.confirmDeleteMentee="",this.confirmDeleteMentor="")},async togglePhase(e,t,o){this.phaseEdit=!0;const a=await this.$http.executePost("/mentorship/togglePhase",{cycleId:this.selectedCycle.id,userId:e.id,mode:this.mode,phaseNum:t,mentorId:o});this.$http.isError(a)||(this.$store.dispatch("updateToastMessages",{message:`Toggled phase ${t} for ${e.username}`,type:"info"}),this.$store.commit("mentorship/updateCycle",a)),this.phaseEdit=!1}}});const S=e=>(T("data-v-3d41bd04"),e=e(),V(),e),ue={class:"col-sm-3"},pe={key:0,class:"text-secondary"},me=["onClick"],he=S(()=>s("i",{class:"fas fa-plus"},null,-1)),ye=[he],fe={key:1},$e=["onClick"],ge=S(()=>s("i",{class:"fas fa-minus"},null,-1)),ve=[ge],Ce=["onClick"],_e={key:2,class:"small"},Ie=["onClick"],be={key:0,class:"text-secondary"},Me=["onClick"],we=S(()=>s("i",{class:"fas fa-minus"},null,-1)),ke=[we],De=["onClick"],Ue={key:3,class:"small"},Pe=["onClick"],Se={key:3,class:"input-group"},Ee=["onKeyup"],Ae={class:"input-group-append"},Ne=["onClick"],Te=S(()=>s("i",{class:"fas fa-plus fa-xs"},null,-1)),Ve=[Te],Le={class:"input-group mb-3"},Re={class:"input-group-append"},Ke=S(()=>s("i",{class:"fas fa-plus fa-xs"},null,-1)),Be=[Ke];function Fe(e,t,o,a,p,y){const r=C("user-link"),n=N("bs-tooltip");return i(),l("div",ue,[s("h5",null,h(e.title),1),s("ol",null,[(i(!0),l(I,null,b(e.modeMentors,d=>(i(),l("li",{key:d.id+e.mode},[c(r,{user:d},null,8,["user"]),e.involvedInAllPhases(d)?g("",!0):f((i(),l("span",pe,[_("*")])),[[n,"skips phases"]]),s("a",{href:"#",class:"text-success ms-1 small",onClick:m(u=>e.editingMentorId=d.id,["prevent"])},ye,8,me),e.findMentees(d.id).length?g("",!0):(i(),l("span",fe,[e.confirmDeleteMentor!=d.id?(i(),l("a",{key:0,href:"#",class:"text-danger ms-1 small",onClick:m(u=>e.confirmDeleteMentor=d.id,["prevent"])},ve,8,$e)):(i(),l("a",{key:1,class:"text-danger",href:"#",onClick:m(u=>e.removeParticipant(u,d.id),["prevent"])}," confirm ",8,Ce))])),e.showPhases?(i(),l("span",_e,[(i(),l(I,null,b(3,u=>s("a",{key:u,href:"#",class:U(e.phaseEdit?"fake-button-disable":""),onClick:m(v=>e.togglePhase(d,u,null),["prevent"])},[s("span",{class:U([e.isPhaseParticipant(d,u,d.id)?"":"text-danger","ms-1"])},"P"+h(u),3)],10,Ie)),64))])):g("",!0),s("ul",null,[(i(!0),l(I,null,b(e.findMentees(d.id),u=>(i(),l("li",{key:u.id+e.mode,class:"small"},[c(r,{user:u},null,8,["user"]),e.involvedInAllPhases(u)?g("",!0):f((i(),l("span",be,[_("*")])),[[n,"skips phases"]]),e.confirmDeleteMentee!=u.id?(i(),l("a",{key:1,href:"#",class:"text-danger ms-1 small",onClick:m(v=>e.confirmDeleteMentee=u.id,["prevent"])},ke,8,Me)):(i(),l("a",{key:2,class:"text-danger",href:"#",onClick:m(v=>e.removeParticipant(v,u.id),["prevent"])}," confirm ",8,De)),e.showPhases?(i(),l("span",Ue,[(i(),l(I,null,b(3,v=>s("a",{key:v,href:"#",class:U(e.phaseEdit?"fake-button-disable":""),onClick:m(ts=>e.togglePhase(u,v,d.id),["prevent"])},[s("span",{class:U([e.isPhaseParticipant(u,v,d.id)?"":"text-danger","ms-1"])},"P"+h(v),3)],10,Pe)),64))])):g("",!0)]))),128))]),e.editingMentorId==d.id?(i(),l("div",Se,[f(s("input",{"onUpdate:modelValue":t[0]||(t[0]=u=>e.menteeInput=u),class:"form-control form-control-sm ms-2",autocomplete:"off",placeholder:"new mentee username/osuId...",onKeyup:E(u=>e.addMentee(u,d.id),["enter"])},null,40,Ee),[[$,e.menteeInput]]),s("div",Ae,[s("button",{class:"btn btn-primary",href:"#",onClick:m(u=>e.addMentee(u,d.id),["prevent"])},Ve,8,Ne)])])):g("",!0)]))),128))]),s("div",Le,[f(s("input",{"onUpdate:modelValue":t[1]||(t[1]=d=>e.mentorInput=d),class:"form-control form-control-sm",autocomplete:"off",placeholder:"new mentor username/osuId...",onKeyup:t[2]||(t[2]=E(d=>e.addMentor(d),["enter"]))},null,544),[[$,e.mentorInput]]),s("div",Re,[s("button",{class:"btn btn-primary",href:"#",onClick:t[3]||(t[3]=m(d=>e.addMentor(d),["prevent"]))},Be)])])])}const Ge=k(ce,[["render",Fe],["__scopeId","data-v-3d41bd04"]]),je=w({name:"Participants",components:{ParticipantList:Ge},data(){return{cycleId:"",showCycleInputs:!1,cycleNameInput:null,cycleNumberInput:null,cycleUrlInput:null,cycleStartDateInput:new Date,cycleEndDateInput:new Date}},computed:{...M(["loggedInUser"]),...M("mentorship",["showPhases"]),...P("mentorship",["allCycles","selectedCycle"])},watch:{cycleId(){this.$store.commit("mentorship/setSelectedCycleId",this.cycleId),this.cycleNameInput=this.selectedCycle.name,this.cycleNumberInput=this.selectedCycle.number,this.cycleUrlInput=this.selectedCycle.url,this.cycleStartDateInput=new Date(this.selectedCycle.startDate),this.cycleEndDateInput=new Date(this.selectedCycle.endDate)}},beforeCreate(){this.$store.hasModule("mentorship")||this.$store.registerModule("mentorship",D)},methods:{toggleShowPhases(){this.$store.commit("mentorship/toggleShowPhases")},async updateCycleName(e){const t=await this.$http.executePost("/mentorship/updateCycleName",{cycleId:this.selectedCycle.id,name:this.cycleNameInput},e);this.$http.isError(t)||(this.$store.dispatch("updateToastMessages",{message:"Updated cycle name",type:"info"}),this.$store.commit("mentorship/updateCycle",t))},async updateCycleNumber(e){const t=await this.$http.executePost("/mentorship/updateCycleNumber",{cycleId:this.selectedCycle.id,number:this.cycleNumberInput},e);this.$http.isError(t)||(this.$store.dispatch("updateToastMessages",{message:"Updated cycle number",type:"info"}),this.$store.commit("mentorship/updateCycle",t))},async updateCycleUrl(e){const t=await this.$http.executePost("/mentorship/updateCycleUrl",{cycleId:this.selectedCycle.id,url:this.cycleUrlInput},e);this.$http.isError(t)||(this.$store.dispatch("updateToastMessages",{message:"Updated cycle url",type:"info"}),this.$store.commit("mentorship/updateCycle",t))},async updateCycleStartDate(e){const t=await this.$http.executePost("/mentorship/updateCycleStartDate",{cycleId:this.selectedCycle.id,startDate:this.cycleStartDateInput},e);this.$http.isError(t)||(this.$store.dispatch("updateToastMessages",{message:"Updated cycle start date",type:"info"}),this.$store.commit("mentorship/updateCycle",t))},async updateCycleEndDate(e){const t=await this.$http.executePost("/mentorship/updateCycleEndDate",{cycleId:this.selectedCycle.id,endDate:this.cycleEndDateInput},e);this.$http.isError(t)||(this.$store.dispatch("updateToastMessages",{message:"Updated cycle end date",type:"info"}),this.$store.commit("mentorship/updateCycle",t))}}}),qe={class:"container card card-body py-3 mb-2"},ze={class:"row"},He={class:"col-sm-6 mb-2"},Je=s("option",{value:"",selected:"",disabled:""}," Select a cycle ",-1),Oe=["value"],Qe={key:0},We=s("hr",null,null,-1),Xe={key:0,class:"mb-4"},Ye={class:"row"},Ze=s("div",{class:"col-sm-2"}," Cycle name: ",-1),xe={class:"col-sm-4 mb-2"},et={class:"input-group"},tt={class:"input-group-append"},st={class:"row"},ot=s("div",{class:"col-sm-2"}," Cycle number: ",-1),nt={class:"col-sm-4 mb-2"},rt={class:"input-group"},it={class:"input-group-append"},lt={class:"row"},at=s("div",{class:"col-sm-2"}," Cycle url: ",-1),dt={class:"col-sm-4 mb-2"},ct={class:"input-group"},ut={class:"input-group-append"},pt={class:"row"},mt=s("div",{class:"col-sm-2"}," Cycle start date: ",-1),ht={class:"col-sm-4 mb-2"},yt={class:"input-group"},ft={class:"input-group-append"},$t={class:"row"},gt=s("div",{class:"col-sm-2"}," Cycle end date: ",-1),vt={class:"col-sm-4 mb-2"},Ct={class:"input-group"},_t={class:"input-group-append"},It={key:1},bt={key:0,class:"fas fa-edit"},Mt={class:"text-secondary small"},wt={class:"row"};function kt(e,t,o,a,p,y){const r=C("participant-list");return i(),l("div",null,[s("div",qe,[s("div",ze,[s("div",He,[f(s("select",{"onUpdate:modelValue":t[0]||(t[0]=n=>e.cycleId=n),class:"form-select form-select d-inline"},[Je,(i(!0),l(I,null,b(e.allCycles,n=>(i(),l("option",{key:n.id,value:n.id},h(n.number)+" - "+h(n.name),9,Oe))),128))],512),[[A,e.cycleId]])])]),e.selectedCycle?(i(),l("div",Qe,[We,e.showCycleInputs?(i(),l("div",Xe,[s("div",Ye,[Ze,s("div",xe,[s("div",et,[f(s("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>e.cycleNameInput=n),class:"form-control form-control-sm",autocomplete:"off",placeholder:"cycle name..."},null,512),[[$,e.cycleNameInput]]),s("div",tt,[s("button",{class:"btn btn-primary",href:"#",onClick:t[2]||(t[2]=m(n=>e.updateCycleName(n),["prevent"]))}," save ")])])])]),s("div",st,[ot,s("div",nt,[s("div",rt,[f(s("input",{"onUpdate:modelValue":t[3]||(t[3]=n=>e.cycleNumberInput=n),class:"form-control form-control-sm",autocomplete:"off",type:"number",placeholder:"cycle number..."},null,512),[[$,e.cycleNumberInput,void 0,{number:!0}]]),s("div",it,[s("button",{class:"btn btn-primary",href:"#",onClick:t[4]||(t[4]=m(n=>e.updateCycleNumber(n),["prevent"]))}," save ")])])])]),s("div",lt,[at,s("div",dt,[s("div",ct,[f(s("input",{"onUpdate:modelValue":t[5]||(t[5]=n=>e.cycleUrlInput=n),class:"form-control form-control-sm",autocomplete:"off",placeholder:"cycle url..."},null,512),[[$,e.cycleUrlInput]]),s("div",ut,[s("button",{class:"btn btn-primary",href:"#",onClick:t[6]||(t[6]=m(n=>e.updateCycleUrl(n),["prevent"]))}," save ")])])])]),s("div",pt,[mt,s("div",ht,[s("div",yt,[f(s("input",{"onUpdate:modelValue":t[7]||(t[7]=n=>e.cycleStartDateInput=n),class:"form-control form-control-sm",type:"date",placeholder:"cycle start date..."},null,512),[[$,e.cycleStartDateInput]]),s("div",ft,[s("button",{class:"btn btn-primary",href:"#",onClick:t[8]||(t[8]=m(n=>e.updateCycleStartDate(n),["prevent"]))}," save ")])])])]),s("div",$t,[gt,s("div",vt,[s("div",Ct,[f(s("input",{"onUpdate:modelValue":t[9]||(t[9]=n=>e.cycleEndDateInput=n),class:"form-control form-control-sm",type:"date",placeholder:"cycle end date..."},null,512),[[$,e.cycleEndDateInput]]),s("div",_t,[s("button",{class:"btn btn-primary",href:"#",onClick:t[10]||(t[10]=m(n=>e.updateCycleEndDate(n),["prevent"]))}," save ")])])])]),s("a",{href:"#",onClick:t[11]||(t[11]=m(n=>e.showCycleInputs=!e.showCycleInputs,["prevent"]))}," stop editing (close without saving) ")])):(i(),l("h4",It,[_(h(e.selectedCycle.name)+" ",1),s("a",{href:"#",onClick:t[12]||(t[12]=m(n=>e.showCycleInputs=!e.showCycleInputs,["prevent"]))},[_(h(e.showCycleInputs?"close":"")+" ",1),e.showCycleInputs?g("",!0):(i(),l("i",bt))])])),s("h5",Mt,h(e.selectedCycle.startDate.slice(0,10))+" - "+h(e.selectedCycle.endDate.slice(0,10)),1),s("button",{class:"btn btn-sm btn-outline-info mb-2",onClick:t[13]||(t[13]=n=>e.toggleShowPhases())},h(e.showPhases?"Hide":"Show")+" phases ",1),s("div",null,[s("div",wt,[c(r,{mode:"osu"}),c(r,{mode:"taiko"}),c(r,{mode:"catch"}),c(r,{mode:"mania"}),c(r,{mode:"modding"}),c(r,{mode:"graduation"}),c(r,{mode:"storyboard"})])])])):g("",!0)])])}const Dt=k(je,[["render",kt]]),Ut=w({name:"CycleList",props:{mode:{type:String,default:""},group:{type:String,default:""}},computed:{...M("mentorship",["selectedUser"]),modeMentorships(){return this.selectedUser.mentorships?this.selectedUser.mentorships.filter(e=>{if(e.group==this.group&&e.mode==this.mode)return!0}):[]},mentorshipsToPhases(){if(this.modeMentorships.length){let e=0;for(const t of this.modeMentorships)t.phases.length&&(e+=t.phases.length/3);return Math.round(e*100)/100}return 0},modeDuration(){return this.calculateDuration(this.modeMentorships)},title(){return this.mode=="modding"||this.mode=="graduation"||this.mode=="storyboard"?this.mode:this.mode=="osu"?"osu!":"osu!"+this.mode}},methods:{calculateDuration(e){let t=0;for(const o of e)if(new Date>new Date(o.cycle.endDate)){const a=new Date(o.cycle.endDate).getTime()-new Date(o.cycle.startDate).getTime(),p=Math.round(a*(o.phases.length/3)/(1e3*60*60*24));t+=p}return t},findRelevantMentees(e){return this.selectedUser.mentees.filter(t=>{for(const o of t.mentorships)if(o.cycle.toString()==e&&o.group=="mentee"&&o.mode==this.mode&&o.mentor.toString()==this.selectedUser.id)return!0})}}}),Pt={class:"col-sm-3"},St={class:"text-center"},Et=["href"],At={class:"small text-secondary"},Nt={key:0},Tt={class:"small text-secondary"},Vt={key:1};function Lt(e,t,o,a,p,y){const r=C("user-link");return i(),l("div",Pt,[s("div",St,[s("b",{class:U(e.modeMentorships.length>=4&&e.group=="mentee"?"text-danger":"")},h(e.title)+" "+h(e.group)+" cycles ("+h(e.mentorshipsToPhases)+")",3)]),s("ul",null,[(i(!0),l(I,null,b(e.modeMentorships,n=>(i(),l("li",{key:n.id+e.mode},[s("a",{href:n.cycle.url,target:"_blank"},h(n.cycle.number)+": "+h(n.cycle.name),9,Et),s("span",At," ("+h(e.calculateDuration([n]))+" days) ",1),n.mentor?(i(),l("ul",Nt,[s("li",Tt,[_(" mentored by "),c(r,{user:n.mentor},null,8,["user"])])])):g("",!0),e.group=="mentor"&&e.findRelevantMentees(n.cycle.id).length?(i(),l("ul",Vt,[(i(!0),l(I,null,b(e.findRelevantMentees(n.cycle.id),d=>(i(),l("li",{key:d.id+e.mode+n.cycle.id,class:"small text-secondary"},[_(" mentor of "),c(r,{user:d},null,8,["user"])]))),128))])):g("",!0)]))),128))])])}const Rt=k(Ut,[["render",Lt]]),Kt=w({name:"UserDetails",components:{CycleList:Rt},data(){return{userInput:""}},computed:{...M("mentorship",["selectedUser"]),totalMentorDuration(){const t=this.selectedUser.mentorships.filter(y=>{if(y.group=="mentor")return!0}).reduce((y,r)=>(y.some(n=>n.cycle.id===r.cycle.id)||y.push(r),y),[]),o=this.calculateDuration(t);let a=Math.floor(o/365),p=Math.round(o%365);return a>0?`${a} ${a==1?"year":"years"} and ${p} days`:`${p} days`},totalMenteeDuration(){const t=this.selectedUser.mentorships.filter(y=>{if(y.group=="mentee")return!0}).reduce((y,r)=>(y.some(n=>n.cycle.id===r.cycle.id)||y.push(r),y),[]),o=this.calculateDuration(t);let a=Math.floor(o/365),p=Math.round(o%365);return a>0?`${a} ${a==1?"year":"years"}, ${p} days`:`${p} days`}},beforeCreate(){this.$store.hasModule("mentorship")||this.$store.registerModule("mentorship",D)},methods:{async searchUser(e){const t=await this.$http.executeGet("/mentorship/searchUser/"+this.userInput,e);this.$http.isError(t)||this.$store.commit("mentorship/setSelectedUser",t)},calculateDuration(e){let t=0;for(const o of e)if(new Date>new Date(o.cycle.endDate)){const a=new Date(o.cycle.endDate).getTime()-new Date(o.cycle.startDate).getTime(),p=Math.round(a*(o.phases.length/3)/(1e3*60*60*24));t+=p}return t}}}),Bt={class:"container card card-body py-3"},Ft=s("h5",null,"User Details",-1),Gt=s("div",{class:"text-secondary mb-2"}," View a user's mentorship history ",-1),jt={class:"input-group w-25"},qt={class:"input-group-append"},zt=s("i",{class:"fas fa-search fa-xs"},null,-1),Ht=[zt],Jt={key:0},Ot={class:"mt-2"},Qt={class:"row mt-2"},Wt={class:"row mt-2"};function Xt(e,t,o,a,p,y){const r=C("cycle-list");return i(),l("div",null,[s("div",Bt,[Ft,Gt,s("div",jt,[f(s("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>e.userInput=n),class:"form-control form-control-sm",autocomplete:"off",placeholder:"username/osuId...",onKeyup:t[1]||(t[1]=E(n=>e.searchUser(n),["enter"]))},null,544),[[$,e.userInput]]),s("div",qt,[s("button",{class:"btn btn-primary",href:"#",onClick:t[2]||(t[2]=m(n=>e.searchUser(n),["prevent"]))},Ht)])]),e.selectedUser?(i(),l("div",Jt,[s("div",Ot,[_(" Mentor for "),s("b",null,h(e.totalMentorDuration),1),_(" across all cycles and game modes ")]),s("div",Qt,[c(r,{mode:"osu",group:"mentor"}),c(r,{mode:"taiko",group:"mentor"}),c(r,{mode:"catch",group:"mentor"}),c(r,{mode:"mania",group:"mentor"}),c(r,{mode:"modding",group:"mentor"}),c(r,{mode:"graduation",group:"mentor"}),c(r,{mode:"storyboard",group:"mentor"})]),s("div",null,[_(" Mentee for "),s("b",null,h(e.totalMenteeDuration),1),_(" across all cycles and game modes ")]),s("div",Wt,[c(r,{mode:"osu",group:"mentee"}),c(r,{mode:"taiko",group:"mentee"}),c(r,{mode:"catch",group:"mentee"}),c(r,{mode:"mania",group:"mentee"}),c(r,{mode:"modding",group:"mentee"}),c(r,{mode:"graduation",group:"mentee"}),c(r,{mode:"storyboard",group:"mentee"})])])):g("",!0)])])}const Yt=k(Kt,[["render",Xt]]),Zt=w({name:"MentorshipPage",components:{Administrators:Q,Cycles:de,Participants:Dt,UserDetails:Yt,AddRestrictedUser:L},data(){return{userInput:null,confirmDelete:null}},computed:{...M(["loggedInUser"]),...P("mentorship",["allCycles"])},beforeCreate(){this.$store.hasModule("mentorship")||this.$store.registerModule("mentorship",D)},async created(){const e=await this.$http.initialRequest("/mentorship/query");this.$http.isError(e)||(this.$store.commit("mentorship/setAdmins",e.admins),this.$store.commit("mentorship/setCycles",e.cycles))},methods:{}}),xt=s("hr",null,null,-1);function es(e,t,o,a,p,y){const r=C("participants"),n=C("user-details"),d=C("cycles"),u=C("administrators"),v=C("add-restricted-user");return i(),l("div",null,[c(r),c(n),xt,c(d),c(u),c(v)])}const ns=k(Zt,[["render",es]]);export{ns as default};
