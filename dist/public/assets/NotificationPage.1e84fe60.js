var t=Object.defineProperty,e=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,n=(e,i,a)=>i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[i]=a;import{d as s,i as o,o as l,b as d,f as c,j as r,l as p,t as m,s as u,e as f,u as v,w as h,g as y,n as b,F as k,x as g}from"./vendor.df51a6ea.js";import{_ as w}from"./ModalDialog.472e77e7.js";import{_ as x}from"./UserLinkList.e91517e6.js";import{a as P}from"./task.5925ddbb.js";import{_ as I}from"./index.ec1ad404.js";var M=s({name:"NotificationCard",props:{notification:{type:Object,required:!0}},emits:["update:selectedMap","update:selectedParty","hideNotification"],methods:{hideNotification(t){this.$emit("hideNotification",{id:this.notification.id,e:t})},selectBeatmap(){this.$emit("update:selectedMap",this.notification.map)},selectParty(){this.$emit("update:selectedParty",this.notification.party)}}});const j={class:"col-md-12 my-1"},$={class:"card card-body card-level-2 p-2"},C={class:"card-text small"},L={key:0},N={key:0},O=["href"],A={key:1},_=[c("i",{class:"far fa-window-maximize"},null,-1)],q={key:1},B=[c("i",{class:"far fa-window-maximize"},null,-1)],E=c("hr",null,null,-1),U={class:"d-flex justify-content-between align-items-center"},D={class:"card-text small"};M.render=function(t,e,i,a,n,s){const v=o("user-link");return l(),d("div",j,[c("div",$,[c("div",C,[r(v,{user:t.notification.sender},null,8,["user"]),p(" "+m(t.notification.info)+" ",1),t.notification.map?(l(),d("span",L,[t.notification.map.url?(l(),d("span",N,[c("a",{href:t.notification.map.url,target:"_blank"},'"'+m(t.notification.map.song.artist)+" - "+m(t.notification.map.song.title)+'"',9,O)])):(l(),d("span",A,'"'+m(t.notification.map.song.artist)+" - "+m(t.notification.map.song.title)+'"',1)),c("a",{href:"#",class:"text-done ms-1","data-bs-toggle":"modal","data-bs-target":"#limitedEditBeatmap",onClick:e[0]||(e[0]=u((e=>t.selectBeatmap()),["prevent"]))},_)])):f("",!0),t.notification.party?(l(),d("span",q,[p(' for quest "'+m(t.notification.quest.name)+'" ',1),c("a",{href:"#",class:"text-done","data-bs-toggle":"modal","data-bs-target":"#limitedEditParty",onClick:e[1]||(e[1]=u((e=>t.selectParty()),["prevent"]))},B)])):f("",!0)]),E,c("div",U,[c("span",D,m(t.notification.createdAt.slice(0,10)),1),c("button",{class:"btn btn-outline-info btn-sm",onClick:e[2]||(e[2]=u((e=>t.hideNotification(e)),["prevent"]))}," Mark as read ")])])])};var z=s({name:"InviteCard",props:{invite:{type:Object,required:!0}},emits:["update:selectedMap","update:selectedParty","hideInvite","acceptInvite"],data:()=>({info:""}),methods:{selectBeatmap(){this.$emit("update:selectedMap",this.invite.map)},selectParty(){this.$emit("update:selectedParty",this.invite.party)},hideInvite(t){this.$emit("hideInvite",{id:this.invite.id,e:t})},acceptInvite(t){this.$emit("acceptInvite",{id:this.invite.id,e:t})}}});const R={class:"col-md-12 my-1"},S={class:"card card-body card-level-2 p-2"},H={class:"card-text small"},F={key:0},T={key:0},G=["href"],J={key:1},K=[c("i",{class:"far fa-window-maximize"},null,-1)],Q={key:1},V=[c("i",{class:"far fa-window-maximize"},null,-1)],W=c("hr",null,null,-1),X={class:"d-flex justify-content-between align-items-center"},Y={class:"card-text small"},Z=p(),tt={class:"text-danger small"};z.render=function(t,e,i,a,n,s){const v=o("user-link");return l(),d("div",R,[c("div",S,[c("div",H,[r(v,{user:t.invite.sender},null,8,["user"]),p(" "+m(t.invite.info)+" ",1),t.invite.map?(l(),d("span",F,[t.invite.map.url?(l(),d("span",T,[c("a",{href:t.invite.map.url,target:"_blank"},m(t.invite.map.song.artist)+" - "+m(t.invite.map.song.title),9,G)])):(l(),d("span",J,m(t.invite.map.song.artist)+" - "+m(t.invite.map.song.title),1)),c("a",{href:"#",class:"text-done ms-1","data-bs-toggle":"modal","data-bs-target":"#limitedEditBeatmap",onClick:e[0]||(e[0]=u((e=>t.selectBeatmap()),["prevent"]))},K)])):f("",!0),t.invite.party?(l(),d("span",Q,[p('for quest "'+m(t.invite.quest.name)+'" ',1),c("a",{href:"#",class:"text-done","data-bs-toggle":"modal","data-bs-target":"#limitedEditParty",onClick:e[1]||(e[1]=u((e=>t.selectParty()),["prevent"]))},V)])):f("",!0)]),W,c("div",X,[c("span",Y,m(t.invite.createdAt.toString().slice(0,10)),1),Z,c("span",tt,m(t.info),1),c("div",null,[c("button",{class:"btn btn-outline-danger btn-sm mx-1",onClick:e[2]||(e[2]=u((e=>t.hideInvite(e)),["prevent"]))}," Decline "),c("button",{class:"btn btn-outline-info btn-sm",onClick:e[3]||(e[3]=u((e=>t.acceptInvite(e)),["prevent"]))}," Accept ")])])])])};var et=s({name:"LimitedMapInfo",components:{ModalDialog:w,UserLinkList:x,ModesIcons:I},props:{beatmap:{type:Object,required:!0}},computed:{sortTasks(){const t=Object.values(P);return((t,s)=>{for(var o in s||(s={}))i.call(s,o)&&n(t,o,s[o]);if(e)for(var o of e(s))a.call(s,o)&&n(t,o,s[o]);return t})({},this.beatmap).tasks.sort((function(e,i){return t.indexOf(e.name)-t.indexOf(i.name)}))}}});const it={class:"container"},at={class:"row"},nt={class:"col-sm-12"},st={class:"table table-sm"},ot=c("th",{scope:"col"}," Difficulty ",-1),lt=c("th",{scope:"col"}," Mapper(s) ",-1),dt={key:0,scope:"col"},ct=["id"],rt={scope:"row"},pt={scope:"row"};et.render=function(t,e,i,a,n,s){const u=o("modes-icons"),w=o("user-link-list"),x=o("modal-dialog");return l(),v(x,{id:"limitedEditBeatmap","modal-size":"md","header-class":t.beatmap?"bg-"+t.beatmap.status.toLowerCase():"",loaded:Boolean(t.beatmap)},{header:h((()=>[p(m(t.beatmap.song.artist)+" - "+m(t.beatmap.song.title)+" ("+m(t.beatmap.host.username)+") ",1),"osu"!==t.beatmap.mode?(l(),v(u,{key:0,modes:[t.beatmap.mode]},null,8,["modes"])):f("",!0)])),default:h((()=>[c("div",it,[c("div",at,[c("div",nt,[c("table",st,[c("thead",null,[c("tr",null,[ot,lt,"Ranked"!=t.beatmap.status?(l(),d("th",dt," Status ")):f("",!0)])]),r(g,{id:"difficulties",tag:"tbody",name:"list"},{default:h((()=>[(l(!0),d(k,null,y(t.beatmap.tasks,(e=>(l(),d("tr",{id:e.id+"Row",key:e.id},[c("td",rt,m(e.name),1),c("td",pt,[r(w,{users:e.mappers},null,8,["users"])]),"Ranked"!=t.beatmap.status?(l(),d("td",{key:0,scope:"row",class:b(e.status.toLowerCase())},m(e.status),3)):f("",!0)],8,ct)))),128))])),_:1})])])])])])),_:1},8,["header-class","loaded"])};var mt=s({name:"LimitedPartyInfo",components:{ModalDialog:w,UserLinkList:x},props:{party:{type:Object,required:!0}}});const ut=p(" Members: ("),ft=p(") "),vt=p(" Leader: ");mt.render=function(t,e,i,a,n,s){const d=o("user-link-list"),u=o("user-link"),f=o("modal-dialog");return l(),v(f,{id:"limitedEditParty","header-class":t.party?"bg-rank-"+t.party.rank:"",loaded:Boolean(t.party)},{header:h((()=>[p(m(t.party.leader.username)+"'s party ",1)])),default:h((()=>[c("p",null,[ut,c("span",{class:b(t.party.id+"-member-count")},m(t.party.members.length),3),ft]),c("p",null,[r(d,{users:t.party.members},null,8,["users"])]),c("p",null,[vt,r(u,{user:t.party.leader},null,8,["user"])]),c("p",null," Rank: "+m(t.party.rank),1)])),_:1},8,["header-class","loaded"])};var ht=s({name:"NotificationPage",components:{NotificationCard:M,InviteCard:z,LimitedMapInfo:et,LimitedPartyInfo:mt},data:()=>({notifications:[],invites:[],info:"",selectedMap:null,selectedParty:null}),async created(){const t=await this.$http.initialRequest("/notifications/relevantInfo");t&&(this.notifications=t.notifications,this.invites=t.invites)},methods:{async hideNotification(t){const e=t.id,i=t.e,a=this.notifications.findIndex((t=>t.id===e));this.notifications.splice(a,1),await this.$http.executePost(`/notifications/${e}/hide`,{},i)},async hideAll(t){this.notifications=[],await this.$http.executePost("/notifications/hideAll/",{},t)},async hideInvite(t){const e=t.id,i=t.e,a=this.invites.findIndex((t=>t.id===e));this.invites.splice(a,1),await this.$http.executePost(`/invites/${e}/hide`,{},i)},async declineAll(t){this.invites=[],await this.$http.executePost("/invites/declineAll/",{},t)},async acceptInvite(t){const e=t.id,i=t.e,a=await this.$http.executePost(`/invites/${e}/accept`,{},i);if(!this.$http.isError(a)){const t=this.invites.findIndex((t=>t.id===e));this.invites.splice(t,1)}}}});const yt={class:"container card card-body py-3 mb-2"},bt={class:"row"},kt={class:"col-md-6"},gt=p(" Notifications "),wt={key:0,class:"ms-4"},xt={class:"col-md-6"},Pt=p(" Invites "),It={key:0,class:"ms-4"};ht.render=function(t,e,i,a,n,s){const p=o("notification-card"),m=o("invite-card"),b=o("limited-map-info"),w=o("limited-party-info");return l(),d("div",null,[c("div",yt,[c("div",bt,[c("div",kt,[c("h2",null,[gt,c("button",{class:"btn btn-outline-info btn-sm ms-1",onClick:e[0]||(e[0]=u((e=>t.hideAll(e)),["prevent"]))}," Mark all as read ")]),r(g,{name:"list",tag:"div",class:"row"},{default:h((()=>[(l(!0),d(k,null,y(t.notifications,(i=>(l(),v(p,{key:i.id,notification:i,"onUpdate:selectedMap":e[1]||(e[1]=e=>t.selectedMap=e),"onUpdate:selectedParty":e[2]||(e[2]=e=>t.selectedParty=e),onHideNotification:e[3]||(e[3]=e=>t.hideNotification(e))},null,8,["notification"])))),128))])),_:1}),t.notifications.length?f("",!0):(l(),d("p",wt," No notifications... "))]),c("div",xt,[c("h2",null,[Pt,c("button",{class:"btn btn-outline-danger btn-sm ms-1",onClick:e[4]||(e[4]=u((e=>t.declineAll(e)),["prevent"]))}," Decline all ")]),r(g,{name:"list",tag:"div",class:"row"},{default:h((()=>[(l(!0),d(k,null,y(t.invites,(i=>(l(),v(m,{key:i.id,invite:i,"onUpdate:info":e[5]||(e[5]=e=>t.info=e),"onUpdate:selectedMap":e[6]||(e[6]=e=>t.selectedMap=e),"onUpdate:selectedParty":e[7]||(e[7]=e=>t.selectedParty=e),onHideInvite:e[8]||(e[8]=e=>t.hideInvite(e)),onAcceptInvite:e[9]||(e[9]=e=>t.acceptInvite(e))},null,8,["invite"])))),128))])),_:1}),t.invites.length?f("",!0):(l(),d("p",It," No invites... "))])])]),t.selectedMap?(l(),v(b,{key:0,beatmap:t.selectedMap},null,8,["beatmap"])):f("",!0),t.selectedParty?(l(),v(w,{key:1,party:t.selectedParty},null,8,["party"])):f("",!0)])};export{ht as default};
