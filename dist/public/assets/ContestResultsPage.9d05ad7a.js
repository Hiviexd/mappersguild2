var s=Object.defineProperty,e=Object.defineProperties,t=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,r=(e,t,n)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,l=(s,e)=>{for(var t in e||(e={}))o.call(e,t)&&r(s,t,e[t]);if(n)for(var t of n(e))i.call(e,t)&&r(s,t,e[t]);return s},a=(s,n)=>e(s,t(n));import{d as c,m as u,h as d,i as m,o as h,b as g,f as b,k as p,t as f,j as v,q as y,e as k,F as S,g as j,l as C,n as w,P as x,s as R}from"./vendor.b9ef672a.js";var $={state:{contest:null,submissions:[],submission:null},mutations:{setContest(s,e){s.contest=e},setSubmissions(s,e){s.submissions=e},setSubmission(s,e){s.submission=e}}},O=c({name:"SubmissionResult",computed:a(l({},u({submission:s=>s.contestResults.submission,loggedInUser:s=>s.loggedInUser})),{voteCount(){let s=0;return this.submission.screenings.forEach((e=>{isNaN(e.vote)||(s+=e.vote)})),s},emptyScreeningCount(){return this.submission.contest.screeners.length-this.submission.screenings.length},randomizedJudging(){let s=[...this.submission.judgings];return s=s.sort((()=>Math.random()-.5)),s},randomizedScreening(){let s=[...this.submission.screenings];return s=s.sort((()=>Math.random()-.5)),s}}),methods:{findTotalJudgingPoints(s){let e=0;return s.forEach((s=>{e+=s.score})),e},findTotalCriteriaPoints(s){let e=0;return s.forEach((s=>{e+=s.criteria.maxScore})),e},findJudgeComment(s){let e="";return s.forEach((s=>{"comments"==s.criteria.name&&(e=s.comment)})),e},filteredAndSortedJudgingScores(s){s=s.filter((s=>"comments"!=s.criteria.name));const e=["musical representation","creativity","limitation","gameplay"];return[...s].sort((function(s,t){return e.indexOf(s.criteria.name)-e.indexOf(t.criteria.name)}))}}});const P={key:0,class:"container p-3"},J=["href"],T=b("i",{class:"fa fa-arrow-left"},null,-1),U=p(" Submission by "),z={key:0},E={key:1,class:"mt-2"},q=["href"],A=b("hr",null,null,-1),M={class:"mx-2"},N=b("h5",null," Screening results ",-1),I={key:0},D=b("p",{class:"ms-3"}," Comments are usually each screener's initial thoughts. They're not intended to be constructive feedback and many screeners use comments as notes for determining their top 5. ",-1),_={class:"ms-3"},F={key:0,class:"fas fa-check text-done"},G={class:"ms-4 mb-2 small text-secondary",style:{"word-break":"break-word"}},L={class:"ms-3"},Y=b("div",{class:"ms-4 mb-2 small text-secondary",style:{"word-break":"break-word"}}," [no comment] ",-1),B={key:1,class:"ms-3"},H=b("hr",null,null,-1),K={class:"mx-2"},Q=b("h5",null," Judging results ",-1),V={key:0},W={class:"ms-3"},X={class:"row ms-3"},Z={class:"col-sm-5"},ss={class:"table table-sm table-responsive-sm"},es=b("thead",null,[b("tr",null,[b("th",{class:"text-start"}," Category "),b("th",{class:"text-start"}," Score ")])],-1),ts={class:"text-start text-capitalize"},ns={class:"text-start"},os=b("td",{class:"text-start"}," TOTAL ",-1),is={class:"text-start"},rs={class:"col-sm-7 small"},ls=p(" Comment: "),as={class:"text-secondary",style:{"white-space":"pre-line"}},cs={key:1,class:"ms-3"};O.render=function(s,e,t,n,o,i){const r=d("user-link"),l=m("bs-tooltip");return h(),g("div",null,[s.submission?(h(),g("div",P,[b("div",null,[b("h3",null,[b("a",{href:"/contests/results?contest="+s.submission.contest.id},[T,p(" "+f(s.submission.contest.name),1)],8,J)]),b("h4",null,[U,v(r,{user:s.submission.creator},null,8,["user"])]),b("h5",null,' Anonymized as "'+f(s.submission.name)+'" ',1),s.loggedInUser&&s.loggedInUser.id==s.submission.creator.id?(h(),g("div",z,[b("a",{href:"#",onClick:e[0]||(e[0]=y((e=>s.$store.commit("setSubmission",null)),["prevent"]))}," Your other contest submissions ")])):k("",!0),s.submission.contest.download?(h(),g("div",E,[b("div",null,[b("a",{href:s.submission.contest.download,target:"_blank"}," Download all submissions ",8,q)])])):k("",!0)]),A,b("div",M,[N,s.submission.screenings&&s.submission.screenings.length?(h(),g("div",I,[D,(h(!0),g(S,null,j(s.randomizedScreening,((s,e)=>(h(),g("div",{key:s.id},[b("div",null,[b("div",_,[p(" User "+f(e+1)+" ",1),s.vote?C((h(),g("i",F,null,512)),[[l,"user placed in top 5"]]):k("",!0)]),b("div",G,f(s.comment?s.comment:"[no comment]"),1)])])))),128)),(h(!0),g(S,null,j(s.emptyScreeningCount,(e=>(h(),g("div",{key:e},[b("div",null,[b("div",L," User "+f(s.submission.screenings.length+e),1),Y])])))),128))])):(h(),g("div",B," This contest skipped screening. "))]),H,b("div",K,[Q,s.submission.judgings&&s.submission.judgings.length?(h(),g("div",V,[(h(!0),g(S,null,j(s.randomizedJudging,((e,t)=>(h(),g("div",{key:e.id},[b("div",null,[b("p",W," User "+f(t+1),1),b("div",X,[b("div",Z,[b("table",ss,[es,b("tbody",null,[(h(!0),g(S,null,j(s.filteredAndSortedJudgingScores(e.judgingScores),(s=>(h(),g("tr",{key:s.id},[b("td",ts,f(s.criteria.name),1),b("td",ns,f(s.score)+"/"+f(s.criteria.maxScore),1)])))),128)),b("tr",null,[os,b("td",is,f(s.findTotalJudgingPoints(e.judgingScores))+"/"+f(s.findTotalCriteriaPoints(e.judgingScores)),1)])])])]),b("div",rs,[ls,b("span",as,f(s.findJudgeComment(e.judgingScores)),1)])])])])))),128))])):(h(),g("div",cs," This entry did not receive enough screening votes to reach the judging stage. :( "))])])):k("",!0)])};var us=c({name:"ContestResults",computed:a(l({},u({contest:s=>s.contestResults.contest})),{maxScore(){let s=0;for(const e of this.contest.criterias)s+=e.maxScore;return s*this.contest.judges.length},sortedSubmissions(){return[...this.contest.submissions].sort(((s,e)=>{const t=this.judgeScore(s.judgings);return this.judgeScore(e.judgings)-t}))}}),methods:{voteCount(s,e){let t=0;for(const n of s)n.vote&&!isNaN(n.vote)&&(e?t+=n.vote:t++);return t},judgeScore(s){let e=0;for(const t of s)for(const s of t.judgingScores)e+=s.score;return 0==e?"N/A":e}}});const ds={key:0,class:"container p-3"},ms=["href"],hs={key:1},gs=["href"],bs={class:"table table-sm"},ps={scope:"col"},fs=[p(" Submission ")],vs=b("th",{scope:"col"}," Creator ",-1),ys={scope:"col"},ks={scope:"col"},Ss={scope:"row"},js=["href"],Cs=b("i",{class:"fa fa-arrow-right"},null,-1),ws={scope:"row"},xs={key:0},Rs=[b("i",{class:"fas fa-check text-done me-1"},null,-1)],$s={key:0},Os={key:1};us.render=function(s,e,t,n,o,i){const r=d("user-link"),l=m("bs-tooltip");return h(),g("div",null,[s.contest?(h(),g("div",ds,[b("h4",null,[s.contest.url||s.contest.resultsUrl?(h(),g("a",{key:0,href:s.contest.resultsUrl?s.contest.resultsUrl:s.contest.url,target:"_blank"},f(s.contest.name)+" results ",9,ms)):(h(),g("span",hs,f(s.contest.name)+" results",1))]),b("div",null,[b("a",{href:s.contest.download,target:"_blank"}," Download all submissions ",8,gs)]),b("table",bs,[b("thead",null,[b("tr",null,[C(b("th",ps,fs,512),[[l,"anonymized name seen by screeners/judges"]]),vs,C(b("th",ys,[p(" Screener votes ("+f(5*s.contest.screeners.length)+") ",1)],512),[[l,"screeners sort entries in their ordered top 5. #1 adds 5 points, #2 adds 4 points, etc."]]),C(b("th",ks,[p(" Judge scores ("+f(s.maxScore)+") ",1)],512),[[l,"see results news/forum post for cases where standardized scores affect outcome"]])])]),b("tbody",null,[(h(!0),g(S,null,j(s.sortedSubmissions,(e=>(h(),g("tr",{key:e.id+"screen"},[b("td",Ss,[b("a",{href:"/contests/results?submission="+e.id},[p(f(e.name)+" ",1),Cs],8,js)]),b("td",ws,[v(r,{user:e.creator},null,8,["user"])]),s.contest.judgingThreshold?(h(),g("td",xs,[(h(!0),g(S,null,j(s.voteCount(e.screenings),(s=>(h(),g("span",{key:s},Rs)))),128)),s.voteCount(e.screenings,!0)>0?(h(),g("span",$s," ("+f(s.voteCount(e.screenings,!0))+") ",1)):k("",!0)])):(h(),g("td",Os," N/A ")),b("td",null,[b("span",{class:w(s.judgeScore(e.judgings)>0?"text-done":"")},f(s.judgeScore(e.judgings)),3)])])))),128))])])])):k("",!0)])};var Ps=c({name:"ContestResultsPage",components:{SubmissionResult:O,ContestResults:us},computed:l({},u({contest:s=>s.contestResults.contest,submissions:s=>s.contestResults.submissions,submission:s=>s.contestResults.submission})),beforeCreate(){this.$store.hasModule("contestResults")||this.$store.registerModule("contestResults",$)},unmounted(){this.$store.hasModule("contestResults")&&this.$store.unregisterModule("contestResults")},async created(){const s=this.$route.query.contest,e=this.$route.query.submission;let t,n,o;s?(t=await this.$http.initialRequest("/contests/results/searchContest/"+s),this.$http.isError(t)||this.setContest(t)):e?([o,n]=await Promise.all([this.$http.initialRequest("/contests/results/searchSubmission/"+e),this.$http.executeGet("/contests/results/participated")]),!o||this.$http.isError(o)?this.$router.replace("/contests/results"):this.setSubmission(o)):n=await this.$http.initialRequest("/contests/results/participated"),this.$http.isError(n)||this.setSubmissions(n)},methods:l({},x(["setContest","setSubmissions","setSubmission"]))});const Js={class:"container card card-body"},Ts={key:2,class:"row"},Us=["onClick"],zs={class:"card card-hover card-level-2 card-body"},Es={key:3,class:"text-center"};Ps.render=function(s,e,t,n,o,i){const r=d("contest-results"),l=d("submission-result");return h(),g("div",Js,[s.contest?(h(),R(r,{key:0})):s.submission?(h(),R(l,{key:1})):s.submissions.length?(h(),g("div",Ts,[(h(!0),g(S,null,j(s.submissions,(t=>(h(),g("div",{key:t.id,class:"col-sm-4 my-2",onClick:e=>s.setSubmission(t)},[b("div",zs,[b("p",null,f(t.contest.name),1),b("a",{href:"#",class:"text-secondary small text-end",onClick:e[0]||(e[0]=y((()=>{}),["prevent"]))}," details ")])],8,Us)))),128))])):(h(),g("div",Es," Contests you participated in will show up here! "))])};export{Ps as default};
