import{d as v,_ as y,o as d,e as l,a as n,b as M,f as O,i as r,w as f,F as _,r as k,j as B,t as i,k as $,p as h,g as N,y as g,n as b,M as D,m as E,c as A}from"./index-e95a7b5e.js";import{C}from"./CopyPaste-ec337f0a.js";import{B as G}from"./BeatmapInfoAdmin-a56b6917.js";import{D as T}from"./DataTable-45d8c70c.js";import"./ModalDialog-7c8864ce.js";import"./task-21eeb954.js";import"./TasksChoice-d3ae7a98.js";const P=v({name:"ContributorStats",components:{CopyPaste:C},data(){return{date:"2022-07-24",externalBeatmaps:[],users:[]}},methods:{async loadNewsInfo(t){const e=await this.$http.executeGet("/admin/beatmaps/loadNewsInfo/"+this.date,t);e&&(this.users=e.users)},separateCommas(t,e){return t<e-1?", ":""}}}),V={class:"container card card-body py-2 mt-2"},R=n("h5",null,"Mappers' Guild contributor stats",-1),Y={class:"form-inline"},K={class:"form-group"},W={key:0},j=n("p",null," Users with ranked maps/tasks: ",-1),H=n("div",null," | User | Modes | Ranked beatmaps | Ranked difficulties | ",-1),z=n("div",null," | :-- | :-- | :-- | :-- | ",-1);function Q(t,e,a,o,p,I){const u=h("copy-paste");return d(),l("div",V,[R,n("div",Y,[n("div",K,[n("button",{class:"btn btn-sm btn-info",onClick:e[0]||(e[0]=s=>t.loadNewsInfo(s))}," Generate Mappers' Guild contributors stats "),M(n("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>t.date=s),class:"form-control form-control-sm d-inline mx-2 w-25",type:"text",autocomplete:"off",placeholder:"YYYY-MM-DD"},null,512),[[O,t.date]])])]),t.users&&t.users.length?(d(),l("div",W,[j,r(u,{distinct:"users"},{default:f(()=>[H,z,(d(!0),l(_,null,k(t.users,s=>(d(),l("div",{key:s.id},[B(" | "+i(s.flag)+" ["+i(s.username)+"]("+i("https://osu.ppy.sh/users/"+s.osuId)+") | ",1),(d(!0),l(_,null,k(s.modes,(c,w)=>(d(),l("span",{key:c},i(c=="osu"?"osu!":c=="sb"?"Storyboarder":c=="hs"?"Hitsounder":"osu!"+c)+i(t.separateCommas(w,s.modes.length)),1))),128)),B(" | "+i(s.hostCount)+" | "+i(s.taskCount)+" | ",1)]))),128))]),_:1})])):$("",!0)])}const q=y(P,[["render",Q]]),J=v({name:"OsuApiBeatmapSearch",components:{CopyPaste:C},data(){return{osuId:null,output:null}},methods:{async searchBeatmap(t){const e=await this.$http.executePost("/admin/beatmaps/searchBeatmap",{osuId:this.osuId},t);e&&!e.error&&(this.output=e)}}}),X={class:"container card card-body py-1"},Z=n("h5",{class:"mt-2"}," Search beatmap in osu! API ",-1),x={key:0};function tt(t,e,a,o,p,I){const u=h("copy-paste");return d(),l("div",X,[Z,M(n("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>t.osuId=s),class:"form-control form-control-sm mb-2",type:"text",maxlength:"18",autocomplete:"off",placeholder:"search by osuID...",onKeyup:e[1]||(e[1]=N(s=>t.searchBeatmap(s),["enter"]))},null,544),[[O,t.osuId]]),n("button",{class:"btn btn-sm w-100 btn-info mb-2",onClick:e[2]||(e[2]=s=>t.searchBeatmap(s))}," Load beatmap "),t.output?(d(),l("div",x,[r(u,null,{default:f(()=>[n("pre",null,i(t.output),1)]),_:1})])):$("",!0)])}const et=y(J,[["render",tt]]),st=v({name:"BundledBeatmapsList",components:{CopyPaste:C},data(){return{bundledBeatmaps:[]}},computed:{osuBeatmaps(){return this.bundledBeatmaps.filter(t=>t.mode=="osu")},taikoBeatmaps(){return this.bundledBeatmaps.filter(t=>t.mode=="taiko")},catchBeatmaps(){return this.bundledBeatmaps.filter(t=>t.mode=="catch")},maniaBeatmaps(){return this.bundledBeatmaps.filter(t=>t.mode=="mania")},osuFinalBeatmaps(){return this.bundledBeatmaps.filter(t=>t.mode=="osu"&&t.isBundled)},taikoFinalBeatmaps(){return this.bundledBeatmaps.filter(t=>t.mode=="taiko"&&t.isBundled)},catchFinalBeatmaps(){return this.bundledBeatmaps.filter(t=>t.mode=="catch"&&t.isBundled)},maniaFinalBeatmaps(){return this.bundledBeatmaps.filter(t=>t.mode=="mania"&&t.isBundled)}},methods:{async findBundledBeatmaps(t){const e=await this.$http.executeGet("/admin/beatmaps/findBundledBeatmaps",t);e&&!e.error&&(this.bundledBeatmaps=e)},async toggleIsBundled(t,e){const a=await this.$http.executePost("/admin/beatmaps/"+t+"/toggleIsBundled",{isBundled:e});if(!this.$http.isError(a)){const o=[...this.bundledBeatmaps],p=o.findIndex(I=>I.id==t);o[p]=a,this.bundledBeatmaps=o}},findOsuId(t){const e=t.indexOf("beatmapsets/")+12,a=t.indexOf("#");let o="";return a!==-1?o=t.slice(e,a):o=t.slice(e),parseInt(o,10)}}}),nt={class:"container card card-body py-2 mt-2"},at=n("h5",null,"Bundled beatmap list generator",-1),ot={key:0,class:"row mt-3 small"},it={class:"col-sm-6"},dt=["onClick"],lt=["href"],rt={class:"col-sm-6"},ut=["onClick"],ct=["href"],mt={class:"col-sm-6"},pt=["onClick"],ft=["href"],ht={class:"col-sm-6"},Bt=["onClick"],_t=["href"],kt=n("p",null,"final lists",-1),gt={class:"row"},bt={class:"col-sm-3"},It=["href"],$t=["onClick"],vt={class:"col-sm-3"},yt=["href"],Ct=["onClick"],wt={class:"col-sm-3"},Mt=["href"],Ot=["onClick"],At={class:"col-sm-3"},Lt=["href"],St=["onClick"];function Ft(t,e,a,o,p,I){const u=h("copy-paste");return d(),l("div",nt,[at,n("button",{class:"btn btn-sm w-100 btn-info",onClick:e[0]||(e[0]=s=>t.findBundledBeatmaps(s))}," Load beatmaps with ENHI+ spreads "),t.bundledBeatmaps.length?(d(),l("div",ot,[n("div",it,[B(" osu ("+i(t.osuBeatmaps.length)+") ",1),r(u,{distinct:"osu"},{default:f(()=>[(d(!0),l(_,null,k(t.osuBeatmaps,s=>(d(),l("div",{key:s.id},[n("a",{href:"#",class:"me-1",onClick:g(c=>t.toggleIsBundled(s.id,s.isBundled),["stop","prevent"])},[n("i",{class:b(["fas",s.isBundled?"text-done fa-check":"text-danger fa-times"])},null,2)],8,dt),n("a",{href:s.url,target:"_blank"},i(s.song.artist+" - "+s.song.title)+" ("+i(t.findOsuId(s.url))+")",9,lt)]))),128))]),_:1})]),n("div",rt,[B(" taiko ("+i(t.taikoBeatmaps.length)+") ",1),r(u,{distinct:"taiko"},{default:f(()=>[(d(!0),l(_,null,k(t.taikoBeatmaps,s=>(d(),l("div",{key:s.id},[n("a",{href:"#",class:"me-1",onClick:g(c=>t.toggleIsBundled(s.id,s.isBundled),["stop","prevent"])},[n("i",{class:b(["fas",s.isBundled?"text-done fa-check":"text-danger fa-times"])},null,2)],8,ut),n("a",{href:s.url,target:"_blank"},i(s.song.artist+" - "+s.song.title)+" ("+i(t.findOsuId(s.url))+")",9,ct)]))),128))]),_:1})]),n("div",mt,[B(" catch ("+i(t.catchBeatmaps.length)+") ",1),r(u,{distinct:"catch"},{default:f(()=>[(d(!0),l(_,null,k(t.catchBeatmaps,s=>(d(),l("div",{key:s.id},[n("a",{href:"#",class:"me-1",onClick:g(c=>t.toggleIsBundled(s.id,s.isBundled),["stop","prevent"])},[n("i",{class:b(["fas",s.isBundled?"text-done fa-check":"text-danger fa-times"])},null,2)],8,pt),n("a",{href:s.url,target:"_blank"},i(s.song.artist+" - "+s.song.title)+" ("+i(t.findOsuId(s.url))+")",9,ft)]))),128))]),_:1})]),n("div",ht,[B(" mania ("+i(t.maniaBeatmaps.length)+") ",1),r(u,{distinct:"mania"},{default:f(()=>[(d(!0),l(_,null,k(t.maniaBeatmaps,s=>(d(),l("div",{key:s.id},[n("a",{href:"#",class:"me-1",onClick:g(c=>t.toggleIsBundled(s.id,s.isBundled),["stop","prevent"])},[n("i",{class:b(["fas",s.isBundled?"text-done fa-check":"text-danger fa-times"])},null,2)],8,Bt),n("a",{href:s.url,target:"_blank"},i(s.song.artist+" - "+s.song.title)+" ("+i(t.findOsuId(s.url))+")",9,_t)]))),128))]),_:1})]),kt,n("div",gt,[n("div",bt,[B(" osu ("+i(t.osuFinalBeatmaps.length)+") ",1),r(u,{distinct:"osufinal"},{default:f(()=>[(d(!0),l(_,null,k(t.osuFinalBeatmaps,s=>(d(),l("div",{key:s.id},[n("a",{href:s.url,target:"_blank",class:"me-1"},i(t.findOsuId(s.url)),9,It),n("a",{href:"#",onClick:g(c=>t.toggleIsBundled(s.id,s.isBundled),["stop","prevent"])},[n("i",{class:b(["fas",s.isBundled?"text-done fa-check":"text-danger fa-times"])},null,2)],8,$t)]))),128))]),_:1})]),n("div",vt,[B(" taiko ("+i(t.taikoFinalBeatmaps.length)+") ",1),r(u,{distinct:"taiko"},{default:f(()=>[(d(!0),l(_,null,k(t.taikoFinalBeatmaps,s=>(d(),l("div",{key:s.id},[n("a",{href:s.url,target:"_blank",class:"me-1"},i(t.findOsuId(s.url)),9,yt),n("a",{href:"#",onClick:g(c=>t.toggleIsBundled(s.id,s.isBundled),["stop","prevent"])},[n("i",{class:b(["fas",s.isBundled?"text-done fa-check":"text-danger fa-times"])},null,2)],8,Ct)]))),128))]),_:1})]),n("div",wt,[B(" catch ("+i(t.catchFinalBeatmaps.length)+") ",1),r(u,{distinct:"catch"},{default:f(()=>[(d(!0),l(_,null,k(t.catchFinalBeatmaps,s=>(d(),l("div",{key:s.id},[n("a",{href:s.url,target:"_blank",class:"me-1"},i(t.findOsuId(s.url)),9,Mt),n("a",{href:"#",onClick:g(c=>t.toggleIsBundled(s.id,s.isBundled),["stop","prevent"])},[n("i",{class:b(["fas",s.isBundled?"text-done fa-check":"text-danger fa-times"])},null,2)],8,Ot)]))),128))]),_:1})]),n("div",At,[B(" mania ("+i(t.maniaFinalBeatmaps.length)+") ",1),r(u,{distinct:"mania"},{default:f(()=>[(d(!0),l(_,null,k(t.maniaFinalBeatmaps,s=>(d(),l("div",{key:s.id},[n("a",{href:s.url,target:"_blank",class:"me-1"},i(t.findOsuId(s.url)),9,Lt),n("a",{href:"#",onClick:g(c=>t.toggleIsBundled(s.id,s.isBundled),["stop","prevent"])},[n("i",{class:b(["fas",s.isBundled?"text-done fa-check":"text-danger fa-times"])},null,2)],8,St)]))),128))]),_:1})])])])):$("",!0)])}const Ut=y(st,[["render",Ft]]),Nt=v({name:"BeatmapIdListGenerator",components:{CopyPaste:C},data(){return{inputUrls:"",output:""}},methods:{findOsuId(t){const e=t.indexOf("beatmapsets/")+12,a=t.indexOf("#");let o="";return a!==-1?o=t.slice(e,a):o=t.slice(e),parseInt(o,10)},generateBeatmapCommaIdList(){let t="";const e=this.inputUrls.split(`
`);for(const a of e){const o=this.findOsuId(a);isNaN(o)?t+=`FAILED (${a})`:t+=o,t+=","}this.output=t.substring(0,t.length-1)},generateBeatmapNewLineIdList(){let t="";const e=this.inputUrls.split(`
`);for(const a of e){const o=this.findOsuId(a);isNaN(o)?t+=`FAILED (${a})`:t+=o,t+=`
`}this.output=t.substring(0,t.length-1)}}}),Dt={class:"container card card-body py-2 mt-2"},Et=n("h5",null,"Beatmap pack ID list generator",-1),Gt={class:"form-inline"},Tt={class:"form-group"},Pt={key:0};function Vt(t,e,a,o,p,I){const u=h("copy-paste");return d(),l("div",Dt,[Et,M(n("textarea",{"onUpdate:modelValue":e[0]||(e[0]=s=>t.inputUrls=s),class:"form-control form-control-sm mx-2 mb-2 w-100",type:"text",autocomplete:"off",placeholder:"map URLs separated by newlines..."},null,512),[[O,t.inputUrls]]),n("div",Gt,[n("div",Tt,[n("button",{class:"btn btn-sm btn-info me-2",onClick:e[1]||(e[1]=s=>t.generateBeatmapCommaIdList())}," Generate (comma separated) "),n("button",{class:"btn btn-sm btn-info",onClick:e[2]||(e[2]=s=>t.generateBeatmapNewLineIdList())}," Generate (newlines) ")])]),t.output.length?(d(),l("div",Pt,[r(u,null,{default:f(()=>[B(i(t.output),1)]),_:1})])):$("",!0)])}const Rt=y(Nt,[["render",Vt]]),Yt={state:{beatmaps:[]},mutations:{setBeatmaps(t,e){t.beatmaps=e},updateBeatmap(t,e){const a=t.beatmaps.findIndex(o=>o.id===e.id);a!==-1&&(t.beatmaps[a]=e),console.log(e)},updateBeatmapStatus(t,e){const a=t.beatmaps.find(o=>o.id==e.beatmapId);a&&(a.status=e.status)},deleteTask(t,e){const a=t.beatmaps.find(o=>o.id==e.beatmapId);if(a){const o=a.tasks.findIndex(p=>p.id==e.taskId);o!==-1&&a.tasks.splice(o,1)}},deleteModder(t,e){const a=t.beatmaps.find(o=>o.id==e.beatmapId);if(a){const o=a.modders.findIndex(p=>p.id==e.modderId);o!==-1&&a.modders.splice(o,1)}},updateUrl(t,e){const a=t.beatmaps.find(o=>o.id==e.beatmapId);a&&(a.url=e.url)},updateStoryboardQuality(t,e){const a=t.beatmaps.find(o=>o.id==e.beatmapId);if(a){const o=a.tasks.findIndex(p=>p.id==e.taskId);o!==-1&&(a.tasks[o]=e.task)}},updatePackId(t,e){const a=t.beatmaps.find(o=>o.id==e.beatmapId);a&&(a.packId=e.packId)},updateIsShowcase(t,e){const a=t.beatmaps.find(o=>o.id==e.beatmapId);a&&(a.isShowcase=e.isShowcase)},updateIsWorldCup(t,e){const a=t.beatmaps.find(o=>o.id==e.beatmapId);a&&(a.isWorldCup=e.isWorldCup)}}},Kt=Yt,Wt=v({components:{ContributorStats:q,DataTable:T,BeatmapInfoAdmin:G,OsuApiBeatmapSearch:et,BundledBeatmapsList:Ut,BeatmapIdListGenerator:Rt,ModesIcons:D},data(){return{selectedBeatmapId:""}},computed:{...E({beatmaps:t=>t.beatmapsAdmin.beatmaps}),selectedBeatmap(){return this.beatmaps.find(t=>t.id===this.selectedBeatmapId)}},beforeCreate(){this.$store.hasModule("beatmapsAdmin")||this.$store.registerModule("beatmapsAdmin",Kt)},unmounted(){this.$store.hasModule("beatmapsAdmin")&&this.$store.unregisterModule("beatmapsAdmin")},methods:{async loadBeatmaps(t){const e=await this.$http.executeGet("/admin/beatmaps/load",t);this.$http.isError(e)||this.$store.commit("setBeatmaps",e)},updateBeatmap(t){const e=this.beatmaps.findIndex(a=>a.id==t.id);e!==-1&&(this.beatmaps[e]=t)},formatMetadata(t){if(!t)return"";let e=t.artist+" - ";return t.title.length>40?e+=t.title.slice(0,40)+"...":e+=t.title,e}}}),jt={class:"container card card-body py-2"},Ht=n("h5",null,"Beatmaps list",-1),zt={class:"text-truncate"},Qt=["href"],qt={key:1,class:"ms-1"};function Jt(t,e,a,o,p,I){const u=h("modes-icons"),s=h("user-link"),c=h("data-table"),w=h("beatmap-info-admin"),L=h("osu-api-beatmap-search"),S=h("contributor-stats"),F=h("bundled-beatmaps-list"),U=h("beatmap-id-list-generator");return d(),l("div",null,[n("div",jt,[Ht,n("button",{class:"btn btn-sm btn-info w-100",onClick:e[0]||(e[0]=m=>t.loadBeatmaps(m))}," Load all beatmaps "),r(c,{data:t.beatmaps,headers:["METADATA","PACK ID","CREATOR","STATUS"],"custom-data-target":"#editBeatmap","onUpdate:selectedId":e[1]||(e[1]=m=>t.selectedBeatmapId=m)},{default:f(({obj:m})=>[n("td",zt,[r(u,{modes:[m.mode]},null,8,["modes"]),m.url?(d(),l("a",{key:0,href:m.url,class:"ms-1"},i(t.formatMetadata(m.song)),9,Qt)):(d(),l("span",qt,i(t.formatMetadata(m.song)),1))]),n("td",null,i(m.packId),1),n("td",null,[m.host?(d(),A(s,{key:0,user:m.host},null,8,["user"])):$("",!0)]),n("td",null,i(m.status),1)]),_:1},8,["data"])]),t.selectedBeatmap?(d(),A(w,{key:0,beatmap:t.selectedBeatmap,onUpdateBeatmap:e[2]||(e[2]=m=>t.updateBeatmap(m))},null,8,["beatmap"])):$("",!0),r(L,{class:"mt-2"}),r(S),r(F),r(U)])}const ae=y(Wt,[["render",Jt]]);export{ae as default};
