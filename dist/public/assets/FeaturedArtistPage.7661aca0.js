var t=Object.defineProperty,e=Object.defineProperties,s=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,o=(e,s,r)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[s]=r;import{d,i as n,o as l,u,w as f,b as c,t as p,l as m,f as h,q as g,O as A,P as b,G as U,j as y,e as $,g as w,F as I,m as S}from"./vendor.df51a6ea.js";import{_ as v}from"./ModalDialog.472e77e7.js";import{_ as x}from"./UserLinkList.e91517e6.js";import{C as T}from"./CopyPaste.90b16e87.js";import{_ as O}from"./DataTable.88222fe0.js";var k=d({name:"FeaturedArtistInfo",components:{ModalDialog:v,UserLinkList:x},props:{featuredArtist:{type:Object,default:null}},data:()=>({osuId:0,name:"",status:"",referenceUrl:"",oszTemplatesUrl:"",offeredUsers:"",selectedSong:null,artist:"",title:""}),computed:{alphabeticalSongs(){return[...this.featuredArtist.songs].sort(((t,e)=>t.title.toLowerCase()>e.title.toLowerCase()?1:e.title.toLowerCase()>t.title.toLowerCase()?-1:0))}},watch:{featuredArtist(){this.osuId=this.featuredArtist.osuId,this.name=this.featuredArtist.label,this.status=this.featuredArtist.status,this.referenceUrl=this.featuredArtist.referenceUrl,this.oszTemplatesUrl=this.featuredArtist.oszTemplatesUrl,this.offeredUsers=this.generateUserListText(this.featuredArtist.offeredUsers),this.title=""},selectedSong(){this.selectedSong&&(this.artist=this.selectedSong.artist,this.title=this.selectedSong.title)}},methods:{generateUserListText(t){if(t&&t.length){return t.map((t=>t.username)).join(", ")}return""},async updateOsuId(t){const e=await this.$http.executePost(`/admin/featuredArtists/${this.featuredArtist.id}/updateOsuId`,{osuId:this.osuId},t);this.$http.isError(e)||(this.$store.dispatch("updateToastMessages",{message:"updated osu id",type:"info"}),this.$store.commit("updateOsuId",{featuredArtistId:this.featuredArtist.id,osuId:e})),await this.$http.executePost("/artists/toggleIsUpToDate/"+this.featuredArtist.id,{value:!0})},async updateName(t){const e=await this.$http.executePost(`/admin/featuredArtists/${this.featuredArtist.id}/updateName`,{name:this.name},t);this.$http.isError(e)||(this.$store.dispatch("updateToastMessages",{message:"updated name",type:"info"}),this.$store.commit("updateName",{featuredArtistId:this.featuredArtist.id,name:e}))},async updateStatus(t){const e=await this.$http.executePost(`/admin/featuredArtists/${this.featuredArtist.id}/updateStatus`,{status:this.status},t);this.$http.isError(e)||(this.$store.dispatch("updateToastMessages",{message:"updated status",type:"info"}),this.$store.commit("updateStatus",{featuredArtistId:this.featuredArtist.id,status:e}))},async updateReferenceUrl(t){const e=await this.$http.executePost(`/admin/featuredArtists/${this.featuredArtist.id}/updateReferenceUrl`,{referenceUrl:this.referenceUrl},t);this.$http.isError(e)||(this.$store.dispatch("updateToastMessages",{message:"updated reference URL",type:"info"}),this.$store.commit("updateReferenceUrl",{featuredArtistId:this.featuredArtist.id,referenceUrl:e}))},async updateOszTemplatesUrl(t){const e=await this.$http.executePost(`/admin/featuredArtists/${this.featuredArtist.id}/updateOszTemplatesUrl`,{oszTemplatesUrl:this.oszTemplatesUrl},t);this.$http.isError(e)||(this.$store.dispatch("updateToastMessages",{message:"updated osz templates URL",type:"info"}),this.$store.commit("updateOszTemplatesUrl",{featuredArtistId:this.featuredArtist.id,oszTemplatesUrl:e}))},async updateOfferedUsers(t){const e=await this.$http.executePost(`/admin/featuredArtists/${this.featuredArtist.id}/updateOfferedUsers`,{offeredUsers:this.offeredUsers},t);this.$http.isError(e)||(this.$store.dispatch("updateToastMessages",{message:"updated offered users",type:"info"}),this.$store.commit("updateOfferedUsers",{featuredArtistId:this.featuredArtist.id,offeredUsers:e}))},async addSong(t){const e=await this.$http.executePost(`/admin/featuredArtists/${this.featuredArtist.id}/songs/create`,{artist:this.artist,title:this.title},t);this.$http.isError(e)||(this.$store.dispatch("updateToastMessages",{message:"added song",type:"info"}),this.$store.commit("addSong",{featuredArtistId:this.featuredArtist.id,song:e}))},async editSong(t){if(!this.selectedSong)return void this.$store.dispatch("updateToastMessages",{message:"Select a song"});const e=await this.$http.executePost(`/admin/featuredArtists/${this.featuredArtist.id}/songs/${this.selectedSong.id}/update`,{artist:this.artist,title:this.title},t);this.$http.isError(e)||(this.$store.dispatch("updateToastMessages",{message:"updated song",type:"info"}),this.$store.commit("updateSong",{featuredArtistId:this.featuredArtist.id,song:e}))},async deleteSong(t){if(!this.selectedSong)return void this.$store.dispatch("updateToastMessages",{message:"Select a song"});const e=await this.$http.executePost(`/admin/featuredArtists/${this.featuredArtist.id}/songs/${this.selectedSong.id}/delete`,{},t);this.$http.isError(e)||(this.$store.dispatch("updateToastMessages",{message:"deleted song",type:"info"}),this.$store.commit("deleteSong",{featuredArtistId:this.featuredArtist.id,songId:this.selectedSong.id}))}}});const L=["href"],M={key:1},P={class:"container"},z=h("h5",null,"General",-1),C={class:"row mb-2 mx-1"},R={class:"row mb-2 mx-1"},j={class:"row mb-2 mx-1"},E=[h("option",{value:"public"}," Public ",-1),h("option",{value:"private"}," Private ",-1),h("option",{value:"showcase"}," Showcase ",-1)],F=h("hr",null,null,-1),V=h("h5",null,"Showcase info",-1),D={class:"row mb-2 mx-1"},_={class:"row mb-2 mx-1"},N={class:"row mb-2 mx-1"},K={key:0,class:"small mx-4"},G=m(" offered: "),q={key:1,class:"small mx-4"},B=m(" showcase mappers: "),H=h("hr",null,null,-1),J=h("h5",null,"Songs",-1),Q={class:"row mb-2 mx-2 w-50"},W=["value"],X={class:"row mb-2 mx-2"},Y={class:"row mb-2 mx-2"},Z={class:"mx-1"};k.render=function(t,e,s,r,a,i){const o=n("user-link-list"),d=n("modal-dialog");return l(),u(d,{id:"edit",loaded:Boolean(t.featuredArtist)},{header:f((()=>[t.featuredArtist.osuId?(l(),c("a",{key:0,href:"https://osu.ppy.sh/beatmaps/artists/"+t.featuredArtist.osuId,target:"_blank"},p(t.featuredArtist.label),9,L)):(l(),c("span",M,p(t.featuredArtist.label),1)),m(" ("+p(t.featuredArtist.songs.length)+") ",1)])),default:f((()=>[h("div",P,[z,h("div",C,[g(h("input",{"onUpdate:modelValue":e[0]||(e[0]=e=>t.osuId=e),class:"form-control form-control-sm mx-2 w-50",type:"text",autocomplete:"off",placeholder:"osu id...",onKeyup:e[1]||(e[1]=b((e=>t.updateOsuId(e)),["enter"]))},null,544),[[A,t.osuId]]),h("button",{class:"btn btn-sm btn-outline-info w-25",onClick:e[2]||(e[2]=e=>t.updateOsuId(e))}," Save osu! ID ")]),h("div",R,[g(h("input",{"onUpdate:modelValue":e[3]||(e[3]=e=>t.name=e),class:"form-control form-control-sm mx-2 w-50",type:"text",autocomplete:"off",placeholder:"artist name...",onKeyup:e[4]||(e[4]=b((e=>t.updateName(e)),["enter"]))},null,544),[[A,t.name]]),h("button",{class:"btn btn-sm btn-outline-info w-25",onClick:e[5]||(e[5]=e=>t.updateName(e))}," Save name ")]),h("div",j,[g(h("select",{"onUpdate:modelValue":e[6]||(e[6]=e=>t.status=e),class:"form-select form-select-sm w-50 mx-2"},E,512),[[U,t.status]]),h("button",{class:"btn btn-sm btn-outline-info w-25",onClick:e[7]||(e[7]=e=>t.updateStatus(e))}," Save status ")]),F,V,h("div",D,[g(h("input",{"onUpdate:modelValue":e[8]||(e[8]=e=>t.referenceUrl=e),class:"form-control form-control-sm mx-2 w-50",type:"text",autocomplete:"off",placeholder:"artist reference url...",onKeyup:e[9]||(e[9]=b((e=>t.updateReferenceUrl(e)),["enter"]))},null,544),[[A,t.referenceUrl]]),h("button",{class:"btn btn-sm btn-outline-info w-25",onClick:e[10]||(e[10]=e=>t.updateReferenceUrl(e))}," Save reference URL ")]),h("div",_,[g(h("input",{"onUpdate:modelValue":e[11]||(e[11]=e=>t.oszTemplatesUrl=e),class:"form-control form-control-sm mx-2 w-50",type:"text",autocomplete:"off",placeholder:"osz templates url...",onKeyup:e[12]||(e[12]=b((e=>t.updateOszTemplatesUrl(e)),["enter"]))},null,544),[[A,t.oszTemplatesUrl]]),h("button",{class:"btn btn-sm btn-outline-info w-25",onClick:e[13]||(e[13]=e=>t.updateOszTemplatesUrl(e))}," Save .osz templates URL ")]),h("div",N,[g(h("input",{"onUpdate:modelValue":e[14]||(e[14]=e=>t.offeredUsers=e),class:"form-control form-control-sm mx-2 w-50",type:"text",autocomplete:"off",placeholder:"offered user usernames...",onKeyup:e[15]||(e[15]=b((e=>t.updateOfferedUsers(e)),["enter"]))},null,544),[[A,t.offeredUsers]]),h("button",{class:"btn btn-sm btn-outline-info w-25",onClick:e[16]||(e[16]=e=>t.updateOfferedUsers(e))}," Save offered users ")]),t.featuredArtist.offeredUsers&&t.featuredArtist.offeredUsers.length?(l(),c("div",K,[G,y(o,{users:t.featuredArtist.offeredUsers},null,8,["users"])])):$("",!0),t.featuredArtist.showcaseMappers&&t.featuredArtist.showcaseMappers.length?(l(),c("div",q,[B,y(o,{users:t.featuredArtist.showcaseMappers},null,8,["users"])])):$("",!0),H,J,h("div",Q,[g(h("select",{id:"editSongSelection","onUpdate:modelValue":e[17]||(e[17]=e=>t.selectedSong=e),class:"form-select form-select-sm"},[(l(!0),c(I,null,w(t.alphabeticalSongs,(t=>(l(),c("option",{key:t.id,value:t},p(t.title)+" --- ("+p(t.artist)+") ",9,W)))),128))],512),[[U,t.selectedSong]])]),h("div",X,[g(h("input",{"onUpdate:modelValue":e[18]||(e[18]=e=>t.artist=e),class:"form-control form-control-sm w-75",type:"text",autocomplete:"off",placeholder:"artist..."},null,512),[[A,t.artist]])]),h("div",Y,[g(h("input",{"onUpdate:modelValue":e[19]||(e[19]=e=>t.title=e),class:"form-control form-control-sm w-75",type:"text",autocomplete:"off",placeholder:"title..."},null,512),[[A,t.title]])]),h("div",Z,[h("button",{class:"btn btn-sm btn-outline-info mx-1",onClick:e[20]||(e[20]=e=>t.addSong(e))}," Add song "),h("button",{class:"btn btn-sm btn-outline-info mx-1",onClick:e[21]||(e[21]=e=>t.editSong(e))}," Edit song "),h("button",{class:"btn btn-sm btn-outline-danger mx-1",onClick:e[22]||(e[22]=e=>t.deleteSong(e))}," Delete song ")])])])),_:1},8,["loaded"])};var tt=d({name:"ShowcaseUserList",components:{CopyPaste:T},data:()=>({songs:[]}),methods:{async findRecentlyLicensedSongs(t){const e=await this.$http.executeGet("/admin/featuredArtists/findRecentlyLicensedSongs",t);e&&!e.error&&(this.songs=e.songs)}}});const et={class:"container card card-body py-1 my-2"},st={key:0};tt.render=function(t,e,s,r,a,i){const o=n("copy-paste");return l(),c("div",et,[h("button",{class:"btn btn-sm w-50 btn-outline-info mb-3",onClick:e[0]||(e[0]=e=>t.findRecentlyLicensedSongs(e))}," Load recently licensed songs "),t.songs.length?(l(),c("div",st,[y(o,{distinct:"songs"},{default:f((()=>[(l(!0),c(I,null,w(t.songs,((t,e)=>(l(),c("div",{key:e},p(t.artist)+" - "+p(t.title),1)))),128))])),_:1})])):$("",!0)])};var rt,at,it={state:{featuredArtists:[]},mutations:{setFeaturedArtists(t,e){t.featuredArtists=e},updateOsuId(t,e){const s=t.featuredArtists.find((t=>t.id==e.featuredArtistId));s&&(s.osuId=e.osuId)},updateName(t,e){const s=t.featuredArtists.find((t=>t.id==e.featuredArtistId));s&&(s.label=e.name)},updateReferenceUrl(t,e){const s=t.featuredArtists.find((t=>t.id==e.featuredArtistId));s&&(s.referenceUrl=e.referenceUrl)},updateOszTemplatesUrl(t,e){const s=t.featuredArtists.find((t=>t.id==e.featuredArtistId));s&&(s.oszTemplatesUrl=e.oszTemplatesUrl)},updateOfferedUsers(t,e){const s=t.featuredArtists.find((t=>t.id==e.featuredArtistId));s&&(s.offeredUsers=e.offeredUsers)},addSong(t,e){const s=t.featuredArtists.find((t=>t.id==e.featuredArtistId));s&&s.songs.push(e.song)},updateSong(t,e){const s=t.featuredArtists.find((t=>t.id==e.featuredArtistId));if(s){const t=s.songs.findIndex((t=>t.id==e.song.id));-1!==t&&(s.songs[t]=e.song)}},deleteSong(t,e){const s=t.featuredArtists.find((t=>t.id==e.featuredArtistId));if(s){const t=s.songs.findIndex((t=>t.id==e.songId));-1!==t&&s.songs.splice(t,1)}}}},ot=d({components:{DataTable:O,FeaturedArtistInfo:k,RecentLicensedSongs:tt},data:()=>({selectedFeaturedArtistId:""}),computed:(rt=((t,e)=>{for(var s in e||(e={}))a.call(e,s)&&o(t,s,e[s]);if(r)for(var s of r(e))i.call(e,s)&&o(t,s,e[s]);return t})({},S({featuredArtists:t=>t.artistsAdmin.featuredArtists})),at={selectedFeaturedArtist(){return this.featuredArtists.find((t=>t.id===this.selectedFeaturedArtistId))}},e(rt,s(at))),beforeCreate(){this.$store.hasModule("artistsAdmin")||this.$store.registerModule("artistsAdmin",it)},unmounted(){this.$store.hasModule("artistsAdmin")&&this.$store.unregisterModule("artistsAdmin")},async created(){const t=await this.$http.initialRequest("/admin/featuredArtists/load");this.$http.isError(t)||this.$store.commit("setFeaturedArtists",t)}});const dt={class:"container card card-body py-1"},nt={class:"row"},lt={class:"col-sm"},ut=["href"],ft={key:1};ot.render=function(t,e,s,r,a,i){const o=n("data-table"),d=n("recent-licensed-songs"),u=n("featured-artist-info");return l(),c("div",null,[h("div",dt,[h("div",nt,[h("div",lt,[y(o,{data:t.featuredArtists,headers:["ARTIST"],"onUpdate:selectedId":e[0]||(e[0]=e=>t.selectedFeaturedArtistId=e)},{default:f((({obj:t})=>[h("td",null,[t.osuId?(l(),c("a",{key:0,href:"https://osu.ppy.sh/beatmaps/artists/"+t.osuId,target:"_blank"},p(t.label),9,ut)):(l(),c("span",ft,p(t.label),1))])])),_:1},8,["data"])])])]),y(d),y(u,{"featured-artist":t.selectedFeaturedArtist},null,8,["featured-artist"])])};export{ot as default};
