var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,r=(t,s,n)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n,a=(e,t)=>{for(var s in t||(t={}))o.call(t,s)&&r(e,s,t[s]);if(n)for(var s of n(t))l.call(t,s)&&r(e,s,t[s]);return e},c=(e,n)=>t(e,s(n));import{d as i,m as d,O as u,h as p,o as m,b as h,f as y,F as f,g,j as I,q as v,l as C,H as b,I as w,v as $,t as M,p as k,a as D,i as U,e as P,n as x,k as S}from"./vendor.b9ef672a.js";var E={namespaced:!0,state:{admins:[],cycles:[],selectedCycleId:null,selectedUser:null,showPhases:!1},mutations:{setAdmins(e,t){e.admins=t},setCycles(e,t){e.cycles=t},removeAdmin(e,t){const s=e.admins.findIndex((e=>e.id==t));-1!==s&&e.admins.splice(s,1)},setSelectedCycleId(e,t){e.selectedCycleId=t},updateCycle(e,t){const s=e.cycles.findIndex((e=>e.id===t.id));-1!==s&&(e.cycles[s]=t)},setSelectedUser(e,t){e.selectedUser=t},toggleShowPhases(e){e.showPhases=!e.showPhases}},getters:{allAdmins:e=>e.admins,allCycles:e=>e.cycles,selectedCycle:e=>e.cycles.find((t=>t.id===e.selectedCycleId))}},A=i({name:"Administrators",components:{},data:()=>({userInput:null,confirmDelete:null}),computed:a(a({},d(["loggedInUser"])),u("mentorship",["allAdmins"])),beforeCreate(){this.$store.hasModule("mentorship")||this.$store.registerModule("mentorship",E)},methods:{async toggleIsMentorshipAdmin(e,t){const s=await this.$http.executePost("/mentorship/toggleIsMentorshipAdmin",{userInput:this.userInput,userId:t},e);if(!this.$http.isError(s))if(this.$store.dispatch("updateToastMessages",{message:""+(s.isMentorshipAdmin?"Added":"Removed"),type:"info"}),s.isMentorshipAdmin){const e=[...this.allAdmins];e.push(s),this.$store.commit("mentorship/setAdmins",e)}else this.$store.commit("mentorship/removeAdmin",t)}}});const N={class:"container card card-body py-3"},T=y("h5",null,"Mentorship Administrators",-1),V=y("div",{class:"text-secondary"}," Users with access to mentorship tools: ",-1),L=["onClick"],R=["onClick"],O={class:"input-group w-25"},j={class:"input-group-append"},K=[y("i",{class:"fas fa-plus fa-xs"},null,-1)];A.render=function(e,t,s,n,o,l){const r=p("user-link");return m(),h("div",null,[y("div",N,[T,V,y("ul",null,[(m(!0),h(f,null,g(e.allAdmins,(t=>(m(),h("li",{key:t.id},[I(r,{user:t},null,8,["user"]),e.confirmDelete!=t.id?(m(),h("a",{key:0,href:"#",class:"text-danger",onClick:v((s=>e.confirmDelete=t.id),["prevent"])}," delete ",8,L)):(m(),h("a",{key:1,class:"text-danger",href:"#",onClick:v((s=>e.toggleIsMentorshipAdmin(s,t.id)),["prevent"])}," confirm ",8,R))])))),128))]),y("div",O,[C(y("input",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.userInput=t),class:"form-control form-control-sm",autocomplete:"off",placeholder:"new admin username/osuId...",onKeyup:t[1]||(t[1]=w((t=>e.toggleIsMentorshipAdmin(t,null)),["enter"]))},null,544),[[b,e.userInput,void 0,{number:!0}]]),y("div",j,[y("button",{class:"btn btn-primary",href:"#",onClick:t[2]||(t[2]=v((t=>e.toggleIsMentorshipAdmin(t,null)),["prevent"]))},K)])])])])};var q=i({name:"Cycles",data:()=>({cycleNumberInput:null,cycleNameInput:null,cycleUrlInput:null,cycleStartInput:null,cycleEndInput:null,duplicateCycleId:""}),computed:a(a({},d(["loggedInUser"])),u("mentorship",["allCycles"])),beforeCreate(){this.$store.hasModule("mentorship")||this.$store.registerModule("mentorship",E)},methods:{async addCycle(e){if(confirm("Are you sure? Details cannot be changed after adding.")){const t=await this.$http.executePost("/mentorship/addCycle",{number:this.cycleNumberInput,name:this.cycleNameInput,url:this.cycleUrlInput,startDate:this.cycleStartInput,endDate:this.cycleEndInput,duplicateCycleId:this.duplicateCycleId},e);if(!this.$http.isError(t)){this.$store.dispatch("updateToastMessages",{message:`Added "${t.number} - ${t.name}"`,type:"info"});const e=[...this.allCycles];e.unshift(t),this.$store.commit("mentorship/setCycles",e)}}}}});const _={class:"container card card-body py-3 mb-2"},G=y("h5",null,"New cycle",-1),H=y("div",{class:"text-secondary"}," Add a new cycle based on input below. ",-1),F=y("div",{class:"text-secondary"}," To copy relationships from an existing cycle, select the cycle in the dropdown. ",-1),z={class:"row"},B={class:"col-sm-6 mb-2"},J=y("option",{value:"",selected:"",disabled:""}," Select a cycle to duplicate ",-1),Q=["value"],W={class:"input-group mt-2"},X={class:"input-group-append"},Y=[y("i",{class:"fas fa-plus fa-xs"},null,-1)];q.render=function(e,t,s,n,o,l){return m(),h("div",null,[y("div",_,[G,H,F,y("div",z,[y("div",B,[C(y("select",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.duplicateCycleId=t),class:"form-select form-select d-inline"},[J,(m(!0),h(f,null,g(e.allCycles,(e=>(m(),h("option",{key:e.id,value:e.id},M(e.number)+" - "+M(e.name),9,Q)))),128))],512),[[$,e.duplicateCycleId]])])]),y("div",W,[C(y("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.cycleNumberInput=t),class:"form-control form-control-sm",autocomplete:"off",type:"number",placeholder:"new cycle number..."},null,512),[[b,e.cycleNumberInput,void 0,{number:!0}]]),C(y("input",{"onUpdate:modelValue":t[2]||(t[2]=t=>e.cycleNameInput=t),class:"form-control form-control-sm",autocomplete:"off",placeholder:"new cycle name..."},null,512),[[b,e.cycleNameInput,void 0,{number:!0}]]),C(y("input",{"onUpdate:modelValue":t[3]||(t[3]=t=>e.cycleUrlInput=t),class:"form-control form-control-sm",autocomplete:"off",placeholder:"cycle details link..."},null,512),[[b,e.cycleUrlInput,void 0,{number:!0}]]),C(y("input",{"onUpdate:modelValue":t[4]||(t[4]=t=>e.cycleStartInput=t),class:"form-control form-control-sm",type:"date"},null,512),[[b,e.cycleStartInput]]),C(y("input",{"onUpdate:modelValue":t[5]||(t[5]=t=>e.cycleEndInput=t),class:"form-control form-control-sm",type:"date"},null,512),[[b,e.cycleEndInput]]),y("div",X,[y("button",{class:"btn btn-primary",href:"#",onClick:t[6]||(t[6]=v((t=>e.addCycle(t)),["prevent"]))},Y)])])])])};var Z=i({name:"ParticipantList",props:{mode:{type:String,default:""}},data:()=>({mentorInput:null,menteeInput:null,editingMentorId:"",confirmDeleteMentor:"",confirmDeleteMentee:"",phaseEdit:!1}),computed:c(a(a(a({},d(["loggedInUser"])),d("mentorship",["showPhases"])),u("mentorship",["selectedCycle"])),{modeMentors(){return this.selectedCycle.participants.filter((e=>{for(const t of e.mentorships)if(t.mode==this.mode&&"mentor"==t.group&&t.cycle.toString()==this.selectedCycle.id)return!0})).sort(((e,t)=>e.username.toLowerCase()>t.username.toLowerCase()?1:t.username.toLowerCase()>e.username.toLowerCase()?-1:0))},modeMentees(){return this.selectedCycle.participants.filter((e=>{for(const t of e.mentorships)if(t.mode==this.mode&&"mentee"==t.group&&t.cycle.toString()==this.selectedCycle.id)return!0})).sort(((e,t)=>e.username.toLowerCase()>t.username.toLowerCase()?1:t.username.toLowerCase()>e.username.toLowerCase()?-1:0))},title(){return"modding"==this.mode||"graduation"==this.mode||"storyboard"==this.mode?this.mode:"osu"==this.mode?"osu!":"osu!"+this.mode}}),beforeCreate(){this.$store.hasModule("mentorship")||this.$store.registerModule("mentorship",E)},methods:{findMentees(e){return this.modeMentees.filter((t=>{for(const s of t.mentorships)if("mentee"==s.group&&s.mentor.toString()==e&&s.cycle.toString()==this.selectedCycle.id)return!0}))},isPhaseParticipant(e,t,s){return!!e.mentorships.find((t=>t.cycle.toString()==this.selectedCycle.id&&t.mode==this.mode&&(t.mentor?t.mentor.toString()==s:s==e.id))).phases.includes(t)},involvedInAllPhases(e){return 3==e.mentorships.find((e=>e.cycle.toString()==this.selectedCycle.id&&e.mode==this.mode)).phases.length},async addMentor(e){const t=await this.$http.executePost("/mentorship/addMentor",{cycleId:this.selectedCycle.id,userInput:this.mentorInput,mode:this.mode},e);this.$http.isError(t)||(this.$store.dispatch("updateToastMessages",{message:`Added "${this.mentorInput}"`,type:"info"}),this.$store.commit("mentorship/updateCycle",t),this.mentorInput=null)},async addMentee(e,t){const s=await this.$http.executePost("/mentorship/addMentee",{cycleId:this.selectedCycle.id,userInput:this.menteeInput,mode:this.mode,mentorId:t},e);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:`Added "${this.menteeInput}"`,type:"info"}),this.$store.commit("mentorship/updateCycle",s),this.menteeInput=null,this.editingMentorId="")},async removeParticipant(e,t){const s=await this.$http.executePost("/mentorship/removeParticipant",{cycleId:this.selectedCycle.id,userId:t,mode:this.mode},e);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"Removed user",type:"info"}),this.$store.commit("mentorship/updateCycle",s),this.confirmDeleteMentee="",this.confirmDeleteMentor="")},async togglePhase(e,t,s){this.phaseEdit=!0;const n=await this.$http.executePost("/mentorship/togglePhase",{cycleId:this.selectedCycle.id,userId:e.id,mode:this.mode,phaseNum:t,mentorId:s});this.$http.isError(n)||(this.$store.dispatch("updateToastMessages",{message:`Toggled phase ${t} for ${e.username}`,type:"info"}),this.$store.commit("mentorship/updateCycle",n)),this.phaseEdit=!1}}});k("data-v-55c8b3ee");const ee={class:"col-sm-3"},te={key:0,class:"text-secondary"},se=[S("*")],ne=["onClick"],oe=[y("i",{class:"fas fa-plus"},null,-1)],le={key:1},re=["onClick"],ae=[y("i",{class:"fas fa-minus"},null,-1)],ce=["onClick"],ie={key:2,class:"small"},de=["onClick"],ue={key:0,class:"text-secondary"},pe=[S("*")],me=["onClick"],he=[y("i",{class:"fas fa-minus"},null,-1)],ye=["onClick"],fe={key:3,class:"small"},ge=["onClick"],Ie={key:3,class:"input-group"},ve=["onKeyup"],Ce={class:"input-group-append"},be=["onClick"],we=[y("i",{class:"fas fa-plus fa-xs"},null,-1)],$e={class:"input-group mb-3"},Me={class:"input-group-append"},ke=[y("i",{class:"fas fa-plus fa-xs"},null,-1)];D(),Z.render=function(e,t,s,n,o,l){const r=p("user-link"),a=U("bs-tooltip");return m(),h("div",ee,[y("h5",null,M(e.title),1),y("ol",null,[(m(!0),h(f,null,g(e.modeMentors,(s=>(m(),h("li",{key:s.id+e.mode},[I(r,{user:s},null,8,["user"]),e.involvedInAllPhases(s)?P("",!0):C((m(),h("span",te,se,512)),[[a,"skips phases"]]),y("a",{href:"#",class:"text-success ms-1 small",onClick:v((t=>e.editingMentorId=s.id),["prevent"])},oe,8,ne),e.findMentees(s.id).length?P("",!0):(m(),h("span",le,[e.confirmDeleteMentor!=s.id?(m(),h("a",{key:0,href:"#",class:"text-danger ms-1 small",onClick:v((t=>e.confirmDeleteMentor=s.id),["prevent"])},ae,8,re)):(m(),h("a",{key:1,class:"text-danger",href:"#",onClick:v((t=>e.removeParticipant(t,s.id)),["prevent"])}," confirm ",8,ce))])),e.showPhases?(m(),h("span",ie,[(m(),h(f,null,g(3,(t=>y("a",{key:t,href:"#",class:x(e.phaseEdit?"fake-button-disable":""),onClick:v((n=>e.togglePhase(s,t,null)),["prevent"])},[y("span",{class:x([e.isPhaseParticipant(s,t,s.id)?"":"text-danger","ms-1"])},"P"+M(t),3)],10,de))),64))])):P("",!0),y("ul",null,[(m(!0),h(f,null,g(e.findMentees(s.id),(t=>(m(),h("li",{key:t.id+e.mode,class:"small"},[I(r,{user:t},null,8,["user"]),e.involvedInAllPhases(t)?P("",!0):C((m(),h("span",ue,pe,512)),[[a,"skips phases"]]),e.confirmDeleteMentee!=t.id?(m(),h("a",{key:1,href:"#",class:"text-danger ms-1 small",onClick:v((s=>e.confirmDeleteMentee=t.id),["prevent"])},he,8,me)):(m(),h("a",{key:2,class:"text-danger",href:"#",onClick:v((s=>e.removeParticipant(s,t.id)),["prevent"])}," confirm ",8,ye)),e.showPhases?(m(),h("span",fe,[(m(),h(f,null,g(3,(n=>y("a",{key:n,href:"#",class:x(e.phaseEdit?"fake-button-disable":""),onClick:v((o=>e.togglePhase(t,n,s.id)),["prevent"])},[y("span",{class:x([e.isPhaseParticipant(t,n,s.id)?"":"text-danger","ms-1"])},"P"+M(n),3)],10,ge))),64))])):P("",!0)])))),128))]),e.editingMentorId==s.id?(m(),h("div",Ie,[C(y("input",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.menteeInput=t),class:"form-control form-control-sm ms-2",autocomplete:"off",placeholder:"new mentee username/osuId...",onKeyup:w((t=>e.addMentee(t,s.id)),["enter"])},null,40,ve),[[b,e.menteeInput]]),y("div",Ce,[y("button",{class:"btn btn-primary",href:"#",onClick:v((t=>e.addMentee(t,s.id)),["prevent"])},we,8,be)])])):P("",!0)])))),128))]),y("div",$e,[C(y("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.mentorInput=t),class:"form-control form-control-sm",autocomplete:"off",placeholder:"new mentor username/osuId...",onKeyup:t[2]||(t[2]=w((t=>e.addMentor(t)),["enter"]))},null,544),[[b,e.mentorInput]]),y("div",Me,[y("button",{class:"btn btn-primary",href:"#",onClick:t[3]||(t[3]=v((t=>e.addMentor(t)),["prevent"]))},ke)])])])},Z.__scopeId="data-v-55c8b3ee";var De=i({name:"Participants",components:{ParticipantList:Z},data:()=>({cycleId:"",showCycleInputs:!1,cycleNameInput:null,cycleNumberInput:null,cycleUrlInput:null,cycleStartDateInput:new Date,cycleEndDateInput:new Date}),computed:a(a(a({},d(["loggedInUser"])),d("mentorship",["showPhases"])),u("mentorship",["allCycles","selectedCycle"])),watch:{cycleId(){this.$store.commit("mentorship/setSelectedCycleId",this.cycleId),this.cycleNameInput=this.selectedCycle.name,this.cycleNumberInput=this.selectedCycle.number,this.cycleUrlInput=this.selectedCycle.url,this.cycleStartDateInput=new Date(this.selectedCycle.startDate),this.cycleEndDateInput=new Date(this.selectedCycle.endDate)}},beforeCreate(){this.$store.hasModule("mentorship")||this.$store.registerModule("mentorship",E)},methods:{toggleShowPhases(){this.$store.commit("mentorship/toggleShowPhases")},async updateCycleName(e){const t=await this.$http.executePost("/mentorship/updateCycleName",{cycleId:this.selectedCycle.id,name:this.cycleNameInput},e);this.$http.isError(t)||(this.$store.dispatch("updateToastMessages",{message:"Updated cycle name",type:"info"}),this.$store.commit("mentorship/updateCycle",t))},async updateCycleNumber(e){const t=await this.$http.executePost("/mentorship/updateCycleNumber",{cycleId:this.selectedCycle.id,number:this.cycleNumberInput},e);this.$http.isError(t)||(this.$store.dispatch("updateToastMessages",{message:"Updated cycle number",type:"info"}),this.$store.commit("mentorship/updateCycle",t))},async updateCycleUrl(e){const t=await this.$http.executePost("/mentorship/updateCycleUrl",{cycleId:this.selectedCycle.id,url:this.cycleUrlInput},e);this.$http.isError(t)||(this.$store.dispatch("updateToastMessages",{message:"Updated cycle url",type:"info"}),this.$store.commit("mentorship/updateCycle",t))},async updateCycleStartDate(e){const t=await this.$http.executePost("/mentorship/updateCycleStartDate",{cycleId:this.selectedCycle.id,startDate:this.cycleStartDateInput},e);this.$http.isError(t)||(this.$store.dispatch("updateToastMessages",{message:"Updated cycle start date",type:"info"}),this.$store.commit("mentorship/updateCycle",t))},async updateCycleEndDate(e){const t=await this.$http.executePost("/mentorship/updateCycleEndDate",{cycleId:this.selectedCycle.id,endDate:this.cycleEndDateInput},e);this.$http.isError(t)||(this.$store.dispatch("updateToastMessages",{message:"Updated cycle end date",type:"info"}),this.$store.commit("mentorship/updateCycle",t))}}});const Ue={class:"container card card-body py-3 mb-2"},Pe={class:"row"},xe={class:"col-sm-6 mb-2"},Se=y("option",{value:"",selected:"",disabled:""}," Select a cycle ",-1),Ee=["value"],Ae={key:0},Ne=y("hr",null,null,-1),Te={key:0,class:"mb-4"},Ve={class:"row"},Le=y("div",{class:"col-sm-2"}," Cycle name: ",-1),Re={class:"col-sm-4 mb-2"},Oe={class:"input-group"},je={class:"input-group-append"},Ke={class:"row"},qe=y("div",{class:"col-sm-2"}," Cycle number: ",-1),_e={class:"col-sm-4 mb-2"},Ge={class:"input-group"},He={class:"input-group-append"},Fe={class:"row"},ze=y("div",{class:"col-sm-2"}," Cycle url: ",-1),Be={class:"col-sm-4 mb-2"},Je={class:"input-group"},Qe={class:"input-group-append"},We={class:"row"},Xe=y("div",{class:"col-sm-2"}," Cycle start date: ",-1),Ye={class:"col-sm-4 mb-2"},Ze={class:"input-group"},et={class:"input-group-append"},tt={class:"row"},st=y("div",{class:"col-sm-2"}," Cycle end date: ",-1),nt={class:"col-sm-4 mb-2"},ot={class:"input-group"},lt={class:"input-group-append"},rt={key:1},at={key:0,class:"fas fa-edit"},ct={class:"text-secondary small"},it={class:"row"};De.render=function(e,t,s,n,o,l){const r=p("participant-list");return m(),h("div",null,[y("div",Ue,[y("div",Pe,[y("div",xe,[C(y("select",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.cycleId=t),class:"form-select form-select d-inline"},[Se,(m(!0),h(f,null,g(e.allCycles,(e=>(m(),h("option",{key:e.id,value:e.id},M(e.number)+" - "+M(e.name),9,Ee)))),128))],512),[[$,e.cycleId]])])]),e.selectedCycle?(m(),h("div",Ae,[Ne,e.showCycleInputs?(m(),h("div",Te,[y("div",Ve,[Le,y("div",Re,[y("div",Oe,[C(y("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.cycleNameInput=t),class:"form-control form-control-sm",autocomplete:"off",placeholder:"cycle name..."},null,512),[[b,e.cycleNameInput]]),y("div",je,[y("button",{class:"btn btn-primary",href:"#",onClick:t[2]||(t[2]=v((t=>e.updateCycleName(t)),["prevent"]))}," save ")])])])]),y("div",Ke,[qe,y("div",_e,[y("div",Ge,[C(y("input",{"onUpdate:modelValue":t[3]||(t[3]=t=>e.cycleNumberInput=t),class:"form-control form-control-sm",autocomplete:"off",type:"number",placeholder:"cycle number..."},null,512),[[b,e.cycleNumberInput,void 0,{number:!0}]]),y("div",He,[y("button",{class:"btn btn-primary",href:"#",onClick:t[4]||(t[4]=v((t=>e.updateCycleNumber(t)),["prevent"]))}," save ")])])])]),y("div",Fe,[ze,y("div",Be,[y("div",Je,[C(y("input",{"onUpdate:modelValue":t[5]||(t[5]=t=>e.cycleUrlInput=t),class:"form-control form-control-sm",autocomplete:"off",placeholder:"cycle url..."},null,512),[[b,e.cycleUrlInput]]),y("div",Qe,[y("button",{class:"btn btn-primary",href:"#",onClick:t[6]||(t[6]=v((t=>e.updateCycleUrl(t)),["prevent"]))}," save ")])])])]),y("div",We,[Xe,y("div",Ye,[y("div",Ze,[C(y("input",{"onUpdate:modelValue":t[7]||(t[7]=t=>e.cycleStartDateInput=t),class:"form-control form-control-sm",type:"date",placeholder:"cycle start date..."},null,512),[[b,e.cycleStartDateInput]]),y("div",et,[y("button",{class:"btn btn-primary",href:"#",onClick:t[8]||(t[8]=v((t=>e.updateCycleStartDate(t)),["prevent"]))}," save ")])])])]),y("div",tt,[st,y("div",nt,[y("div",ot,[C(y("input",{"onUpdate:modelValue":t[9]||(t[9]=t=>e.cycleEndDateInput=t),class:"form-control form-control-sm",type:"date",placeholder:"cycle end date..."},null,512),[[b,e.cycleEndDateInput]]),y("div",lt,[y("button",{class:"btn btn-primary",href:"#",onClick:t[10]||(t[10]=v((t=>e.updateCycleEndDate(t)),["prevent"]))}," save ")])])])]),y("a",{href:"#",onClick:t[11]||(t[11]=v((t=>e.showCycleInputs=!e.showCycleInputs),["prevent"]))}," stop editing (close without saving) ")])):(m(),h("h4",rt,[S(M(e.selectedCycle.name)+" ",1),y("a",{href:"#",onClick:t[12]||(t[12]=v((t=>e.showCycleInputs=!e.showCycleInputs),["prevent"]))},[S(M(e.showCycleInputs?"close":"")+" ",1),e.showCycleInputs?P("",!0):(m(),h("i",at))])])),y("h5",ct,M(e.selectedCycle.startDate.slice(0,10))+" - "+M(e.selectedCycle.endDate.slice(0,10)),1),y("button",{class:"btn btn-sm btn-outline-info mb-2",onClick:t[13]||(t[13]=t=>e.toggleShowPhases())},M(e.showPhases?"Hide":"Show")+" phases ",1),y("div",null,[y("div",it,[I(r,{mode:"osu"}),I(r,{mode:"taiko"}),I(r,{mode:"catch"}),I(r,{mode:"mania"}),I(r,{mode:"modding"}),I(r,{mode:"graduation"}),I(r,{mode:"storyboard"})])])])):P("",!0)])])};var dt=i({name:"CycleList",props:{mode:{type:String,default:""},group:{type:String,default:""}},computed:c(a({},d("mentorship",["selectedUser"])),{modeMentorships(){return this.selectedUser.mentorships?this.selectedUser.mentorships.filter((e=>{if(e.group==this.group&&e.mode==this.mode)return!0})):[]},mentorshipsToPhases(){if(this.modeMentorships.length){let e=0;for(const t of this.modeMentorships)t.phases.length&&(e+=t.phases.length/3);return Math.round(100*e)/100}return 0},modeDuration(){return this.calculateDuration(this.modeMentorships)},title(){return"modding"==this.mode||"graduation"==this.mode||"storyboard"==this.mode?this.mode:"osu"==this.mode?"osu!":"osu!"+this.mode}}),methods:{calculateDuration(e){let t=0;for(const s of e)if(new Date>new Date(s.cycle.endDate)){const e=new Date(s.cycle.endDate).getTime()-new Date(s.cycle.startDate).getTime();t+=Math.round(e*(s.phases.length/3)/864e5)}return t},findRelevantMentees(e){return this.selectedUser.mentees.filter((t=>{for(const s of t.mentorships)if(s.cycle.toString()==e&&"mentee"==s.group&&s.mode==this.mode&&s.mentor.toString()==this.selectedUser.id)return!0}))}}});const ut={class:"col-sm-3"},pt={class:"text-center"},mt=["href"],ht={class:"small text-secondary"},yt={key:0},ft={class:"small text-secondary"},gt=S(" mentored by "),It={key:1},vt=S(" mentor of ");dt.render=function(e,t,s,n,o,l){const r=p("user-link");return m(),h("div",ut,[y("div",pt,[y("b",{class:x(e.modeMentorships.length>=4&&"mentee"==e.group?"text-danger":"")},M(e.title)+" "+M(e.group)+" cycles ("+M(e.mentorshipsToPhases)+")",3)]),y("ul",null,[(m(!0),h(f,null,g(e.modeMentorships,(t=>(m(),h("li",{key:t.id+e.mode},[y("a",{href:t.cycle.url,target:"_blank"},M(t.cycle.number)+": "+M(t.cycle.name),9,mt),y("span",ht," ("+M(e.calculateDuration([t]))+" days) ",1),t.mentor?(m(),h("ul",yt,[y("li",ft,[gt,I(r,{user:t.mentor},null,8,["user"])])])):P("",!0),"mentor"==e.group&&e.findRelevantMentees(t.cycle.id).length?(m(),h("ul",It,[(m(!0),h(f,null,g(e.findRelevantMentees(t.cycle.id),(s=>(m(),h("li",{key:s.id+e.mode+t.cycle.id,class:"small text-secondary"},[vt,I(r,{user:s},null,8,["user"])])))),128))])):P("",!0)])))),128))])])};var Ct=i({name:"UserDetails",components:{CycleList:dt},data:()=>({userInput:""}),computed:c(a({},d("mentorship",["selectedUser"])),{totalMentorDuration(){const e=this.selectedUser.mentorships.filter((e=>{if("mentor"==e.group)return!0})).reduce(((e,t)=>(e.some((e=>e.cycle.id===t.cycle.id))||e.push(t),e)),[]),t=this.calculateDuration(e);let s=Math.floor(t/365),n=Math.round(t%365);return s>0?`${s} ${1==s?"year":"years"} and ${n} days`:`${n} days`},totalMenteeDuration(){const e=this.selectedUser.mentorships.filter((e=>{if("mentee"==e.group)return!0})).reduce(((e,t)=>(e.some((e=>e.cycle.id===t.cycle.id))||e.push(t),e)),[]),t=this.calculateDuration(e);let s=Math.floor(t/365),n=Math.round(t%365);return s>0?`${s} ${1==s?"year":"years"}, ${n} days`:`${n} days`}}),beforeCreate(){this.$store.hasModule("mentorship")||this.$store.registerModule("mentorship",E)},methods:{async searchUser(e){const t=await this.$http.executeGet("/mentorship/searchUser/"+this.userInput,e);this.$http.isError(t)||this.$store.commit("mentorship/setSelectedUser",t)},calculateDuration(e){let t=0;for(const s of e)if(new Date>new Date(s.cycle.endDate)){const e=new Date(s.cycle.endDate).getTime()-new Date(s.cycle.startDate).getTime();t+=Math.round(e*(s.phases.length/3)/864e5)}return t}}});const bt={class:"container card card-body py-3"},wt=y("h5",null,"User Details",-1),$t=y("div",{class:"text-secondary mb-2"}," View a user's mentorship history ",-1),Mt={class:"input-group w-25"},kt={class:"input-group-append"},Dt=[y("i",{class:"fas fa-search fa-xs"},null,-1)],Ut={key:0},Pt={class:"mt-2"},xt=S(" Mentor for "),St=S(" across all cycles and game modes "),Et={class:"row mt-2"},At=S(" Mentee for "),Nt=S(" across all cycles and game modes "),Tt={class:"row mt-2"};Ct.render=function(e,t,s,n,o,l){const r=p("cycle-list");return m(),h("div",null,[y("div",bt,[wt,$t,y("div",Mt,[C(y("input",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.userInput=t),class:"form-control form-control-sm",autocomplete:"off",placeholder:"username/osuId...",onKeyup:t[1]||(t[1]=w((t=>e.searchUser(t)),["enter"]))},null,544),[[b,e.userInput]]),y("div",kt,[y("button",{class:"btn btn-primary",href:"#",onClick:t[2]||(t[2]=v((t=>e.searchUser(t)),["prevent"]))},Dt)])]),e.selectedUser?(m(),h("div",Ut,[y("div",Pt,[xt,y("b",null,M(e.totalMentorDuration),1),St]),y("div",Et,[I(r,{mode:"osu",group:"mentor"}),I(r,{mode:"taiko",group:"mentor"}),I(r,{mode:"catch",group:"mentor"}),I(r,{mode:"mania",group:"mentor"}),I(r,{mode:"modding",group:"mentor"}),I(r,{mode:"graduation",group:"mentor"}),I(r,{mode:"storyboard",group:"mentor"})]),y("div",null,[At,y("b",null,M(e.totalMenteeDuration),1),Nt]),y("div",Tt,[I(r,{mode:"osu",group:"mentee"}),I(r,{mode:"taiko",group:"mentee"}),I(r,{mode:"catch",group:"mentee"}),I(r,{mode:"mania",group:"mentee"}),I(r,{mode:"modding",group:"mentee"}),I(r,{mode:"graduation",group:"mentee"}),I(r,{mode:"storyboard",group:"mentee"})])])):P("",!0)])])};var Vt=i({name:"AddRestrictedUser",components:{},data:()=>({usernameInput:null,osuIdInput:null}),computed:a({},d(["loggedInUser"])),beforeCreate(){this.$store.hasModule("mentorship")||this.$store.registerModule("mentorship",E)},methods:{async addRestrictedUser(e){const t=await this.$http.executePost("/mentorship/addRestrictedUser",{usernameInput:this.usernameInput,osuIdInput:this.osuIdInput},e);this.$http.isError(t)||this.$store.dispatch("updateToastMessages",{message:`Added ${t.username}`,type:"info"})}}});const Lt={class:"container card card-body py-3"},Rt=y("h5",null,"Add restricted user",-1),Ot=y("div",{class:"text-secondary"}," This adds a user to the Mappers' Guild database manually. Ensure name and osu ID are correct. If they're not, there will be problems if the user is unrestricted. ",-1),jt={class:"input-group w-50"},Kt={class:"input-group-append"},qt=[y("i",{class:"fas fa-plus fa-xs"},null,-1)];Vt.render=function(e,t,s,n,o,l){return m(),h("div",null,[y("div",Lt,[Rt,Ot,y("div",jt,[C(y("input",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.usernameInput=t),class:"form-control form-control-sm",autocomplete:"off",placeholder:"username..."},null,512),[[b,e.usernameInput,void 0,{number:!0}]]),C(y("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.osuIdInput=t),class:"form-control form-control-sm",autocomplete:"off",placeholder:"osuId..."},null,512),[[b,e.osuIdInput,void 0,{number:!0}]]),y("div",Kt,[y("button",{class:"btn btn-primary",href:"#",onClick:t[2]||(t[2]=v((t=>e.addRestrictedUser(t)),["prevent"]))},qt)])])])])};var _t=i({name:"MentorshipPage",components:{Administrators:A,Cycles:q,Participants:De,UserDetails:Ct,AddRestrictedUser:Vt},data:()=>({userInput:null,confirmDelete:null}),computed:a(a({},d(["loggedInUser"])),u("mentorship",["allCycles"])),beforeCreate(){this.$store.hasModule("mentorship")||this.$store.registerModule("mentorship",E)},async created(){const e=await this.$http.initialRequest("/mentorship/query");this.$http.isError(e)||(this.$store.commit("mentorship/setAdmins",e.admins),this.$store.commit("mentorship/setCycles",e.cycles))},methods:{}});const Gt=y("hr",null,null,-1);_t.render=function(e,t,s,n,o,l){const r=p("participants"),a=p("user-details"),c=p("cycles"),i=p("administrators"),d=p("add-restricted-user");return m(),h("div",null,[I(r),I(a),Gt,I(c),I(i),I(d)])};export{_t as default};
