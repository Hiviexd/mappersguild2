import{d as A,U as V,m as D,_ as y,o as d,c as S,w as v,a as t,i as r,e as l,r as g,t as u,F as $,k as M,j as b,y as R,p as h,P as T,b as p,f as c,v as U,n as C,O as P,s as x,u as L}from"./index-913aa234.js";import{M as B}from"./ModalDialog-ec78811d.js";import{b as j,F as G,c as O}from"./FormTextarea-b14d0b50.js";import{D as z}from"./DataTable-3ab29064.js";const W=A({name:"SubmitMissionModal",components:{ModalDialog:B,FormInput:j,FormSelect:G,FormTextarea:O},props:{isAdmin:Boolean},data(){return{modes:V,featuredArtists:[],selectedArtists:[],selectedArtistId:"",selectedMode:"",selectedModes:[],tier:"",deadline:"",objective:"",name:"",winCondition:"",isShowcaseMission:0,userMaximumRankedBeatmapsCount:null,userMaximumGlobalRank:null,userMaximumPp:null,userMinimumRank:null,beatmapEarliestSubmissionDate:"2007-01-01",beatmapLatestSubmissionDate:"2100-01-01"}},computed:{...D(["loggedInUser"])},async created(){const i=await this.$http.executeGet("/featuredArtists");i&&(this.featuredArtists=i.sort((s,e)=>s.label.toLowerCase()>e.label.toLowerCase()?1:e.label.toLowerCase()>s.label.toLowerCase()?-1:0))},methods:{addArtist(){if(this.selectedArtistId.length){const i=this.featuredArtists.findIndex(a=>a.id==this.selectedArtistId),s=this.featuredArtists[i],e={id:s.id,_id:s._id,label:s.label,osuId:s.osuId};this.selectedArtists.push(e)}},addMode(){this.selectedMode.length&&this.selectedModes.push(this.selectedMode)},removeArtist(i){const s=this.selectedArtists.findIndex(e=>e.id==i);this.selectedArtists.splice(s,1)},removeMode(i){const s=this.selectedModes.findIndex(e=>e==i);this.selectedModes.splice(s,1)},async addMission(i){if(typeof this.name=="number"){this.$store.dispatch("updateToastMessages",{message:"Choose a name that doesn't start with a number",type:"danger"});return}const s=await this.$http.executePost("/admin/missions/create",{artists:this.selectedArtists,tier:this.tier,name:this.name,deadline:this.deadline,objective:this.objective,modes:this.selectedModes,winCondition:this.winCondition,isShowcaseMission:new Boolean(this.isShowcaseMission),userMaximumRankedBeatmapsCount:this.userMaximumRankedBeatmapsCount,userMaximumGlobalRank:this.userMaximumGlobalRank,userMaximumPp:this.userMaximumPp,userMinimumRank:this.userMinimumRank,beatmapEarliestSubmissionDate:this.beatmapEarliestSubmissionDate,beatmapLatestSubmissionDate:this.beatmapLatestSubmissionDate},i);this.$http.isError(s)||(this.$store.commit("addMission",s),this.$bs.hideModal("submitMission"))}}}),N={class:"container"},Q=t("h5",null,"General",-1),q={class:"row"},F=t("option",{value:"-",disabled:""}," --- ",-1),H=["value"],_={class:"col-sm-1"},J={class:"small text-secondary"},K={key:0},X=["onClick"],Y=t("i",{class:"fas fa-minus"},null,-1),Z=[Y],ss={class:"row"},is=t("option",{value:"-",disabled:""}," --- ",-1),ts=["value"],es={class:"col-sm-1"},os={class:"mt-2"},ns={class:"small text-secondary"},as={key:0},ms=["onClick"],ds=t("i",{class:"fas fa-minus"},null,-1),ls=[ds],us=t("hr",null,null,-1),rs=t("h5",null,"User requirements",-1);function ps(i,s,e,a,w,k){const f=h("form-select"),m=h("form-input"),o=h("form-textarea"),I=h("modal-dialog");return d(),S(I,{id:"submitMission",title:"Submit mission"},{default:v(()=>[t("div",N,[Q,t("div",q,[r(f,{modelValue:i.selectedArtistId,"onUpdate:modelValue":s[0]||(s[0]=n=>i.selectedArtistId=n),class:"col-sm-11",label:"Artist",placeholder:"Any artist (selected by default)"},{default:v(()=>[F,(d(!0),l($,null,g(i.featuredArtists,n=>(d(),l("option",{key:n.id,value:n.id},u(n.label),9,H))),128))]),_:1},8,["modelValue"]),t("div",_,[t("button",{id:"artistButton",class:"btn btn-sm btn-outline-info",onClick:s[1]||(s[1]=n=>i.addArtist())}," Add ")])]),t("div",null,[t("ul",J,[i.selectedArtists.length?M("",!0):(d(),l("li",K," Any artist (selected by default) ")),(d(!0),l($,null,g(i.selectedArtists,n=>(d(),l("li",{key:n.osuId},[b(u(n.label)+" ",1),t("a",{href:"#",class:"text-danger",onClick:R(E=>i.removeArtist(n.id),["prevent"])},Z,8,X)]))),128))])]),t("div",ss,[r(f,{modelValue:i.selectedMode,"onUpdate:modelValue":s[2]||(s[2]=n=>i.selectedMode=n),class:"col-sm-11",label:"Mode",placeholder:"Any mode (selected by default)"},{default:v(()=>[is,(d(!0),l($,null,g(i.modes,n=>(d(),l("option",{key:n,value:n},u(n),9,ts))),128))]),_:1},8,["modelValue"]),t("div",es,[t("button",{id:"artistButton",class:"btn btn-sm btn-outline-info",onClick:s[3]||(s[3]=n=>i.addMode())}," Add ")])]),t("div",os,[t("ul",ns,[i.selectedModes.length?M("",!0):(d(),l("li",as," Any mode (selected by default) ")),(d(!0),l($,null,g(i.selectedModes,n=>(d(),l("li",{key:n},[b(u(n)+" ",1),t("a",{href:"#",class:"text-danger",onClick:R(E=>i.removeMode(n),["prevent"])},ls,8,ms)]))),128))])]),r(m,{modelValue:i.tier,"onUpdate:modelValue":s[4]||(s[4]=n=>i.tier=n),modelModifiers:{number:!0},label:"Tier",type:"number"},null,8,["modelValue"]),r(m,{modelValue:i.name,"onUpdate:modelValue":s[5]||(s[5]=n=>i.name=n),modelModifiers:{number:!0},label:"Name",type:"text"},null,8,["modelValue"]),r(o,{modelValue:i.objective,"onUpdate:modelValue":s[6]||(s[6]=n=>i.objective=n),label:"Objective"},null,8,["modelValue"]),r(o,{modelValue:i.winCondition,"onUpdate:modelValue":s[7]||(s[7]=n=>i.winCondition=n),label:"Win condition"},null,8,["modelValue"]),r(m,{modelValue:i.isShowcaseMission,"onUpdate:modelValue":s[8]||(s[8]=n=>i.isShowcaseMission=n),modelModifiers:{number:!0},label:"isShowcaseMission",description:"0 = false, 1 = true",type:"number"},null,8,["modelValue"]),r(m,{modelValue:i.deadline,"onUpdate:modelValue":s[9]||(s[9]=n=>i.deadline=n),label:"Deadline",type:"date"},null,8,["modelValue"]),us,rs,r(m,{modelValue:i.userMaximumRankedBeatmapsCount,"onUpdate:modelValue":s[10]||(s[10]=n=>i.userMaximumRankedBeatmapsCount=n),modelModifiers:{number:!0},label:"Max ranked maps",type:"number"},null,8,["modelValue"]),r(m,{modelValue:i.userMaximumGlobalRank,"onUpdate:modelValue":s[11]||(s[11]=n=>i.userMaximumGlobalRank=n),modelModifiers:{number:!0},label:"Max global rank",type:"number"},null,8,["modelValue"]),r(m,{modelValue:i.userMaximumPp,"onUpdate:modelValue":s[12]||(s[12]=n=>i.userMaximumPp=n),modelModifiers:{number:!0},label:"Max pp",type:"number"},null,8,["modelValue"]),r(m,{modelValue:i.userMinimumRank,"onUpdate:modelValue":s[13]||(s[13]=n=>i.userMinimumRank=n),modelModifiers:{number:!0},label:"Minimum mg rank",type:"number"},null,8,["modelValue"]),r(m,{modelValue:i.beatmapEarliestSubmissionDate,"onUpdate:modelValue":s[14]||(s[14]=n=>i.beatmapEarliestSubmissionDate=n),modelModifiers:{number:!0},label:"Earliest submission date",type:"date"},null,8,["modelValue"]),r(m,{modelValue:i.beatmapLatestSubmissionDate,"onUpdate:modelValue":s[15]||(s[15]=n=>i.beatmapLatestSubmissionDate=n),modelModifiers:{number:!0},label:"Latest submission date",type:"date"},null,8,["modelValue"]),t("button",{class:"btn btn-outline-success w-100",onClick:s[16]||(s[16]=n=>i.addMission(n))}," Add mission ")])]),_:1})}const cs=y(W,[["render",ps]]),bs={state:{missions:[]},mutations:{setMissions(i,s){i.missions=s},updateMission(i,s){const e=i.missions.findIndex(a=>a.id===s.id);e!==-1&&(i.missions[e]=s)},addMission(i,s){i.missions.push(s)},updateName(i,s){const e=i.missions.find(a=>a.id==s.missionId);e&&(e.name=s.name)},updateTier(i,s){const e=i.missions.find(a=>a.id==s.missionId);e&&(e.tier=s.tier)},updateObjective(i,s){const e=i.missions.find(a=>a.id==s.missionId);e&&(e.objective=s.objective)},updateStatus(i,s){const e=i.missions.find(a=>a.id==s.missionId);e&&(e.status=s.status)},updateWinCondition(i,s){const e=i.missions.find(a=>a.id==s.missionId);e&&(e.winCondition=s.winCondition)},updateIsShowcaseMission(i,s){const e=i.missions.find(a=>a.id==s.missionId);e&&(e.isShowcaseMission=s.isShowcaseMission)},updateOpeningAnnounced(i,s){const e=i.missions.find(a=>a.id==s.missionId);e&&(e.openingAnnounced=s.openingAnnounced)},updateClosingAnnounced(i,s){const e=i.missions.find(a=>a.id==s.missionId);e&&(e.closingAnnounced=s.closingAnnounced)},updateWinningBeatmaps(i,s){const e=i.missions.find(a=>a.id==s.missionId);e&&(e.winningBeatmaps=s.winningBeatmaps)},updateInvalidBeatmaps(i,s){const e=i.missions.find(a=>a.id==s.missionId);e&&(e.invalidBeatmaps=s.invalidBeatmaps)},updateAssociatedMaps(i,s){const e=i.missions.find(a=>a.id==s.missionId);e&&(e.associatedMaps=s.associatedMaps)},updateModes(i,s){const e=i.missions.find(a=>a.id==s.missionId);e&&(e.modes=s.modes)},updateArtists(i,s){const e=i.missions.find(a=>a.id==s.missionId);e&&(e.artists=s.artists)},updateUserMaximumRankedBeatmapsCount(i,s){const e=i.missions.find(a=>a.id==s.missionId);e&&(e.userMaximumRankedBeatmapsCount=s.userMaximumRankedBeatmapsCount)},updateUserMaximumGlobalRank(i,s){const e=i.missions.find(a=>a.id==s.missionId);e&&(e.userMaximumGlobalRank=s.userMaximumGlobalRank)},updateUserMaximumPp(i,s){const e=i.missions.find(a=>a.id==s.missionId);e&&(e.userMaximumPp=s.userMaximumPp)},updateUserMinimumRank(i,s){const e=i.missions.find(a=>a.id==s.missionId);e&&(e.userMinimumRank=s.userMinimumRank)},updateBeatmapEarliestSubmissionDate(i,s){const e=i.missions.find(a=>a.id==s.missionId);e&&(e.beatmapEarliestSubmissionDate=s.beatmapEarliestSubmissionDate)},updateBeatmapLatestSubmissionDate(i,s){const e=i.missions.find(a=>a.id==s.missionId);e&&(e.beatmapLatestSubmissionDate=s.beatmapLatestSubmissionDate)},updateDeadline(i,s){const e=i.missions.find(a=>a.id==s.missionId);e&&(e.deadline=s.deadline)}}},hs=bs,fs=A({name:"MissionInfo",components:{AssociatedBeatmaps:T,ModalDialog:B},props:{mission:{type:Object,required:!0}},data(){return{availableArtists:[],availableModes:V,name:this.mission.name,tier:this.mission.tier,objective:this.mission.objective,winCondition:this.mission.winCondition,status:this.mission.status,mode:"",selectedArtist:{},artists:this.mission.artists,userMaximumRankedBeatmapsCount:this.mission.userMaximumRankedBeatmapsCount,userMaximumGlobalRank:this.mission.userMaximumGlobalRank,userMaximumPp:this.mission.userMaximumPp,userMinimumRank:this.mission.userMinimumRank,beatmapEarliestSubmissionDate:new Date(this.mission.beatmapEarliestSubmissionDate),beatmapLatestSubmissionDate:new Date(this.mission.beatmapLatestSubmissionDate),deadline:new Date(this.mission.deadline)}},watch:{mission(){this.name=this.mission.name,this.tier=this.mission.tier,this.artists=this.mission.artists,this.objective=this.mission.objective,this.winCondition=this.mission.winCondition,this.status=this.mission.status,this.mode="",this.userMaximumRankedBeatmapsCount=this.mission.userMaximumRankedBeatmapsCount,this.userMaximumGlobalRank=this.mission.userMaximumGlobalRank,this.userMaximumPp=this.mission.userMaximumPp,this.userMinimumRank=this.mission.userMinimumRank,this.beatmapEarliestSubmissionDate=new Date(this.mission.beatmapEarliestSubmissionDate),this.beatmapLatestSubmissionDate=new Date(this.mission.beatmapLatestSubmissionDate),this.deadline=new Date(this.mission.deadline)}},async created(){const i=await this.$http.executeGet("/featuredArtists");i&&(this.availableArtists=i.sort((s,e)=>s.label.toLowerCase()>e.label.toLowerCase()?1:e.label.toLowerCase()>s.label.toLowerCase()?-1:0))},methods:{async updateName(i){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/rename`,{name:this.name},i);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"renamed mission",type:"info"}),this.$store.commit("updateName",{missionId:this.mission.id,name:s}))},async updateTier(i){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/updateTier`,{tier:this.tier},i);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"updated tier",type:"info"}),this.$store.commit("updateTier",{missionId:this.mission.id,tier:s}))},async updateObjective(i){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/updateObjective/`,{objective:this.objective},i);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"updated objective",type:"info"}),this.$store.commit("updateObjective",{missionId:this.mission.id,objective:s}))},async updateStatus(i){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/updateStatus/`,{status:this.status},i);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"updated status",type:"info"}),this.$store.commit("updateStatus",{missionId:this.mission.id,status:s}))},async updateUserMaximumRankedBeatmapsCount(i){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/updateUserMaximumRankedBeatmapsCount/`,{userMaximumRankedBeatmapsCount:this.userMaximumRankedBeatmapsCount},i);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"updated user max ranked maps count for mission",type:"info"}),this.$store.commit("updateUserMaximumRankedBeatmapsCount",{missionId:this.mission.id,userMaximumRankedBeatmapsCount:s}))},async updateUserMaximumGlobalRank(i){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/updateUserMaximumGlobalRank/`,{userMaximumGlobalRank:this.userMaximumGlobalRank},i);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"updated user max global rank for mission",type:"info"}),this.$store.commit("updateUserMaximumGlobalRank",{missionId:this.mission.id,userMaximumGlobalRank:s}))},async updateUserMaximumPp(i){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/updateUserMaximumPp/`,{userMaximumPp:this.userMaximumPp},i);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"updated user max pp for mission",type:"info"}),this.$store.commit("updateUserMaximumPp",{missionId:this.mission.id,userMaximumPp:s}))},async updateUserMinimumRank(i){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/updateUserMinimumRank/`,{userMinimumRank:this.userMinimumRank},i);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"updated user min mg rank for mission",type:"info"}),this.$store.commit("updateUserMinimumRank",{missionId:this.mission.id,userMinimumRank:s}))},async updateBeatmapEarliestSubmissionDate(i){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/updateBeatmapEarliestSubmissionDate/`,{beatmapEarliestSubmissionDate:this.beatmapEarliestSubmissionDate},i);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"updated beatmap earliest submission date",type:"info"}),this.$store.commit("updateBeatmapEarliestSubmissionDate",{missionId:this.mission.id,beatmapEarliestSubmissionDate:s}))},async updateBeatmapLatestSubmissionDate(i){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/updateBeatmapLatestSubmissionDate/`,{beatmapLatestSubmissionDate:this.beatmapLatestSubmissionDate},i);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"updated beatmap latest submission date",type:"info"}),this.$store.commit("updateBeatmapLatestSubmissionDate",{missionId:this.mission.id,beatmapLatestSubmissionDate:s}))},async updateDeadline(i){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/updateDeadline/`,{deadline:this.deadline},i);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"updated deadline",type:"info"}),this.$store.commit("updateDeadline",{missionId:this.mission.id,deadline:s}))},async updateWinCondition(i){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/updateWinCondition/`,{winCondition:this.winCondition},i);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"updated win condition",type:"info"}),this.$store.commit("updateWinCondition",{missionId:this.mission.id,winCondition:s}))},async toggleIsShowcaseMission(i){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/toggleIsShowcaseMission/`,{isShowcaseMission:!this.mission.isShowcaseMission},i);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"toggled isShowcaseMission",type:"info"}),this.$store.commit("updateIsShowcaseMission",{missionId:this.mission.id,isShowcaseMission:s}))},async toggleOpeningAnnounced(i){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/toggleOpeningAnnounced/`,{openingAnnounced:!this.mission.openingAnnounced},i);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"toggled openingAnnounced",type:"info"}),this.$store.commit("updateOpeningAnnounced",{missionId:this.mission.id,openingAnnounced:s}))},async toggleClosingAnnounced(i){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/toggleClosingAnnounced/`,{closingAnnounced:!this.mission.closingAnnounced},i);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"toggled closingAnnounced",type:"info"}),this.$store.commit("updateClosingAnnounced",{missionId:this.mission.id,closingAnnounced:s}))},async toggleMode(i){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/toggleMode/`,{mode:this.mode},i);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"toggled mode",type:"info"}),this.$store.commit("updateModes",{missionId:this.mission.id,modes:s}))},async toggleArtist(i){const s=await this.$http.executePost(`/admin/missions/${this.mission.id}/toggleArtist/`,{artistLabel:this.selectedArtist},i);this.$http.isError(s)||(this.$store.dispatch("updateToastMessages",{message:"toggled artist",type:"info"}),this.$store.commit("updateArtists",{missionId:this.mission.id,artists:s}))}}}),Ms={class:"container"},gs={class:"row mt-2"},$s={class:"row mt-2"},ws={class:"row mt-2"},ks={class:"row mt-2"},vs={class:"row"},Cs=t("option",{value:"",disabled:""}," Select a status ",-1),Ss=t("option",{value:"hidden"}," Hidden ",-1),As=t("option",{value:"open"}," Open ",-1),ys=t("option",{value:"closed"}," Closed ",-1),Is=[Cs,Ss,As,ys],Us={class:"row"},Rs=t("option",{value:"",disabled:""}," Select a mode ",-1),Ds={class:"w-25 mt-2"},Vs={key:0,class:"row"},Bs=t("option",{value:{},disabled:""}," Select an artist ",-1),Es={key:0,class:"w-25 mt-2"},Ts={class:"row mt-2"},Ps={class:"small"},xs={class:"row"},Ls={class:"col-sm-6 mt-2"},js={class:"row"},Gs={class:"col-sm-6 mt-2"},Os={class:"row"},zs={class:"col-sm-6 mt-2"},Ws=t("hr",null,null,-1),Ns=t("h5",null,"User requirements",-1),Qs={class:"row"},qs={class:"row mt-2"},Fs={class:"row mt-2"},Hs={class:"row mt-2"},_s={class:"row mt-2"},Js={class:"small"},Ks={class:"row mt-2"},Xs={class:"small"};function Ys(i,s,e,a,w,k){const f=h("associated-beatmaps"),m=h("modal-dialog");return d(),S(m,{id:"editMission"},{header:v(()=>[b(u(i.mission.name),1)]),default:v(()=>[t("div",Ms,[t("div",gs,[p(t("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>i.name=o),class:"form-control form-control-sm mx-2 w-50",type:"text",autocomplete:"off",placeholder:"mission name..."},null,512),[[c,i.name]]),t("button",{class:"btn btn-sm btn-outline-info w-25",onClick:s[1]||(s[1]=o=>i.updateName(o))}," Rename mission ")]),t("div",$s,[p(t("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>i.tier=o),class:"form-control form-control-sm mx-2 w-50",type:"text",autocomplete:"off",placeholder:"tier..."},null,512),[[c,i.tier]]),t("button",{class:"btn btn-sm btn-outline-info w-25",onClick:s[3]||(s[3]=o=>i.updateTier(o))}," Update tier ")]),t("div",ws,[p(t("textarea",{"onUpdate:modelValue":s[4]||(s[4]=o=>i.objective=o),class:"form-control form-control-sm mx-2 mt-2 w-50",type:"text",autocomplete:"off",placeholder:"mission objective..."},null,512),[[c,i.objective]]),t("button",{class:"btn btn-sm btn-outline-info w-25 mt-2",onClick:s[5]||(s[5]=o=>i.updateObjective(o))}," Update objective ")]),t("div",ks,[p(t("textarea",{"onUpdate:modelValue":s[6]||(s[6]=o=>i.winCondition=o),class:"form-control form-control-sm mx-2 mt-2 w-50",type:"text",autocomplete:"off",placeholder:"mission win condition..."},null,512),[[c,i.winCondition]]),t("button",{class:"btn btn-sm btn-outline-info w-25 mt-2",onClick:s[7]||(s[7]=o=>i.updateWinCondition(o))}," Update win condition ")]),t("div",vs,[p(t("select",{"onUpdate:modelValue":s[8]||(s[8]=o=>i.status=o),class:"form-select form-select-sm mx-2 mt-2 w-50"},Is,512),[[U,i.status]]),t("button",{class:"btn btn-sm btn-outline-info mt-2 w-25",onClick:s[9]||(s[9]=o=>i.updateStatus(o))}," Update status ")]),t("div",Us,[p(t("select",{"onUpdate:modelValue":s[10]||(s[10]=o=>i.mode=o),class:"form-select form-select-sm mx-2 mt-2 w-25"},[Rs,(d(!0),l($,null,g(i.availableModes,o=>(d(),l("option",{key:o},u(o),1))),128))],512),[[U,i.mode]]),t("div",Ds,u(i.mission.modes),1),t("button",{class:"btn btn-sm btn-outline-info mt-2 w-25",onClick:s[11]||(s[11]=o=>i.toggleMode(o))}," Toggle mode ")]),i.availableArtists?(d(),l("div",Vs,[p(t("select",{"onUpdate:modelValue":s[12]||(s[12]=o=>i.selectedArtist=o),class:"form-select form-select-sm mx-2 mt-2 w-25"},[Bs,(d(!0),l($,null,g(i.availableArtists,o=>(d(),l("option",{key:o.id},u(o.label),1))),128))],512),[[U,i.selectedArtist]]),i.mission.artists&&i.mission.artists.length?(d(),l("div",Es,u(i.mission.artists.map(o=>o.label)),1)):M("",!0),t("button",{class:"btn btn-sm btn-outline-info mt-2 w-25",onClick:s[13]||(s[13]=o=>i.toggleArtist(o))}," Toggle artist ")])):M("",!0),t("div",Ts,[p(t("input",{"onUpdate:modelValue":s[14]||(s[14]=o=>i.deadline=o),class:"form-control form-control-sm mx-2 w-50",type:"date",autocomplete:"off",placeholder:"deadline..."},null,512),[[c,i.deadline]]),t("button",{class:"btn btn-sm btn-outline-info w-25",onClick:s[15]||(s[15]=o=>i.updateDeadline(o))}," Update deadline "),t("span",Ps,[b("current: "),t("b",null,u(i.mission.deadline),1)])]),t("div",xs,[t("div",Ls,[b(" isShowcaseMission: "),t("span",{class:C(i.mission.isShowcaseMission?"text-success":"text-danger")},u(i.mission.isShowcaseMission),3)]),t("button",{class:"btn btn-sm btn-outline-info mt-2 ms-3 w-25",onClick:s[16]||(s[16]=o=>i.toggleIsShowcaseMission(o))}," Toggle isShowcaseMission ")]),t("div",js,[t("div",Gs,[b(" Opening announced: "),t("span",{class:C(i.mission.openingAnnounced?"text-success":"text-danger")},u(i.mission.openingAnnounced),3)]),t("button",{class:"btn btn-sm btn-outline-info mt-2 ms-3 w-25",onClick:s[17]||(s[17]=o=>i.toggleOpeningAnnounced(o))}," Toggle openingAnnounced ")]),t("div",Os,[t("div",zs,[b(" Closing announced: "),t("span",{class:C(i.mission.closingAnnounced?"text-success":"text-danger")},u(i.mission.closingAnnounced),3)]),t("button",{class:"btn btn-sm btn-outline-info mt-2 ms-3 w-25",onClick:s[18]||(s[18]=o=>i.toggleClosingAnnounced(o))}," Toggle closingAnnounced ")]),Ws,Ns,t("div",Qs,[p(t("input",{"onUpdate:modelValue":s[19]||(s[19]=o=>i.userMaximumRankedBeatmapsCount=o),class:"form-control form-control-sm mx-2 w-50",type:"text",autocomplete:"off",placeholder:"maximum ranked maps allowed..."},null,512),[[c,i.userMaximumRankedBeatmapsCount]]),t("button",{class:"btn btn-sm btn-outline-info w-25",onClick:s[20]||(s[20]=o=>i.updateUserMaximumRankedBeatmapsCount(o))}," Update user max ranked maps count ")]),t("div",qs,[p(t("input",{"onUpdate:modelValue":s[21]||(s[21]=o=>i.userMaximumGlobalRank=o),class:"form-control form-control-sm mx-2 w-50",type:"number",autocomplete:"off",placeholder:"maximum global rank allowed..."},null,512),[[c,i.userMaximumGlobalRank]]),t("button",{class:"btn btn-sm btn-outline-info w-25",onClick:s[22]||(s[22]=o=>i.updateUserMaximumGlobalRank(o))}," Update user max global rank ")]),t("div",Fs,[p(t("input",{"onUpdate:modelValue":s[23]||(s[23]=o=>i.userMaximumPp=o),class:"form-control form-control-sm mx-2 w-50",type:"number",autocomplete:"off",placeholder:"maximum pp allowed..."},null,512),[[c,i.userMaximumPp]]),t("button",{class:"btn btn-sm btn-outline-info w-25",onClick:s[24]||(s[24]=o=>i.updateUserMaximumPp(o))}," Update user max pp ")]),t("div",Hs,[p(t("input",{"onUpdate:modelValue":s[25]||(s[25]=o=>i.userMinimumRank=o),class:"form-control form-control-sm mx-2 w-50",type:"number",autocomplete:"off",placeholder:"minimum mg rank allowed..."},null,512),[[c,i.userMinimumRank]]),t("button",{class:"btn btn-sm btn-outline-info w-25",onClick:s[26]||(s[26]=o=>i.updateUserMinimumRank(o))}," Update user min rank ")]),t("div",_s,[p(t("input",{"onUpdate:modelValue":s[27]||(s[27]=o=>i.beatmapEarliestSubmissionDate=o),class:"form-control form-control-sm mx-2 w-50",type:"date",autocomplete:"off",placeholder:"earliest submission date allowed..."},null,512),[[c,i.beatmapEarliestSubmissionDate]]),t("button",{class:"btn btn-sm btn-outline-info w-25",onClick:s[28]||(s[28]=o=>i.updateBeatmapEarliestSubmissionDate(o))}," Update beatmap earliest submission date "),t("span",Js,[b("current: "),t("b",null,u(i.mission.beatmapEarliestSubmissionDate),1)])]),t("div",Ks,[p(t("input",{"onUpdate:modelValue":s[29]||(s[29]=o=>i.beatmapLatestSubmissionDate=o),class:"form-control form-control-sm mx-2 w-50",type:"date",autocomplete:"off",placeholder:"latest submission date allowed..."},null,512),[[c,i.beatmapLatestSubmissionDate]]),t("button",{class:"btn btn-sm btn-outline-info w-25",onClick:s[30]||(s[30]=o=>i.updateBeatmapLatestSubmissionDate(o))}," Update beatmap latest submission date "),t("span",Xs,[b("current: "),t("b",null,u(i.mission.beatmapLatestSubmissionDate),1)])]),i.mission.associatedMaps&&i.mission.associatedMaps.length?(d(),S(f,{key:1,class:"my-4",mission:i.mission,"is-admin-page":!0},null,8,["mission"])):M("",!0)])]),_:1})}const Zs=y(fs,[["render",Ys]]),si=A({name:"MissionWinners",computed:{...D({missions:i=>i.missionsAdmin.missions}),closedMissions(){return this.missions.filter(i=>i.status==P.Closed)}},methods:{loadWinners(){let i=[];for(const m of this.closedMissions)i=i.concat(m.winningBeatmaps);const s=i.map(m=>m.host);let a=s.map(m=>m.username).reduce(function(m,o){return m[o]?++m[o]:m[o]=1,m},{});const w=[],k=[];for(const m of s)k.includes(m.osuId)||(k.push(m.osuId),w.push({username:m.username,osuId:m.osuId,total:a[m.username],isQuestTrailblazer:m.isQuestTrailblazer}));return w.sort((m,o)=>o.total-m.total)},async toggleIsQuestTrailblazer(i,s){const e=await this.$http.executePost("/admin/missions/toggleIsQuestTrailblazer/",{userOsuId:i},s);this.$http.isError(e)||this.$store.dispatch("updateToastMessages",{message:"toggled isQuestTrailblazer, refresh to see changes",type:"info"})}}}),ii={class:"container card card-body py-1 my-2"},ti={key:0},ei=["onClick"];function oi(i,s,e,a,w,k){const f=h("user-link");return d(),l("div",ii,[(d(!0),l($,null,g(i.loadWinners(),m=>(d(),l("div",{key:m.osuId},[r(f,{user:m},null,8,["user"]),b(" - "+u(m.total)+" ",1),m.total>=3&&!m.isQuestTrailblazer?(d(),l("code",ti,".add-badge "+u(m.osuId)+` questtrailblazer.png "Completed 3+ priority quests in the Mappers' Guild" https://osu.ppy.sh/wiki/en/Community/Mappers_Guild#additional-rewards`,1)):M("",!0),m.total>=3&&!m.isQuestTrailblazer?(d(),l("button",{key:1,class:"btn btn-outline-info btn-sm ms-2",href:"#",onClick:R(o=>i.toggleIsQuestTrailblazer(m.osuId,o),["prevent"])}," click this after giving user badge ",8,ei)):M("",!0)]))),128))])}const ni=y(si,[["render",oi]]),ai=A({components:{DataTable:z,SubmitMissionModal:cs,MissionInfo:Zs,MissionWinners:ni},data(){return{selectedMissionId:""}},computed:{...D({missions:i=>i.missionsAdmin.missions}),selectedMission(){return this.missions.find(i=>i.id===this.selectedMissionId)}},beforeCreate(){this.$store.hasModule("missionsAdmin")||this.$store.registerModule("missionsAdmin",hs)},unmounted(){this.$store.hasModule("missionsAdmin")&&this.$store.unregisterModule("missionsAdmin")},async created(){const i=await this.$http.initialRequest("/admin/missions/load");this.$http.isError(i)||this.$store.commit("setMissions",i)},methods:{updateMission(i){const s=this.missions.findIndex(e=>e.id==i.id);s!==-1&&(this.missions[s]=i)},findTierImage(i){switch(i){case 1:return"/images/bronze.png";case 2:return"/images/silver.png";case 3:return"/images/gold.png";case 4:return"/images/platinum.png";default:return"/images/bronze.png"}}}});const mi=i=>(x("data-v-e57f7ab8"),i=i(),L(),i),di={class:"container card card-body py-1"},li={class:"row"},ui={class:"col"},ri=mi(()=>t("button",{class:"btn btn-sm btn-info w-100 mb-1","data-bs-toggle":"modal","data-bs-target":"#submitMission"}," Add mission ",-1)),pi=["src"];function ci(i,s,e,a,w,k){const f=h("data-table"),m=h("mission-winners"),o=h("submit-mission-modal"),I=h("mission-info");return d(),l("div",null,[t("div",di,[t("div",li,[t("div",ui,[ri,r(f,{data:i.missions,headers:["name","tier","status","announce"],"custom-data-target":"#editMission","onUpdate:selectedId":s[0]||(s[0]=n=>i.selectedMissionId=n)},{default:v(({obj:n})=>[t("td",null,u(n.name),1),t("td",null,[t("img",{src:i.findTierImage(n.tier),class:"table-mission-tier"},null,8,pi)]),t("td",null,u(n.status),1),t("td",null,[t("span",{class:C(n.openingAnnounced?"text-success":"text-danger")},"open",2),b("/"),t("span",{class:C(n.closingAnnounced?"text-success":"text-danger")},"close",2)])]),_:1},8,["data"])])])]),r(m),r(o),i.selectedMission?(d(),S(I,{key:0,mission:i.selectedMission,onUpdateMission:s[1]||(s[1]=n=>i.updateMission(n))},null,8,["mission"])):M("",!0)])}const gi=y(ai,[["render",ci],["__scopeId","data-v-e57f7ab8"]]);export{gi as default};
