var t=Object.defineProperty,e=Object.defineProperties,s=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,l=(e,s,a)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[s]=a,n=(t,e)=>{for(var s in e||(e={}))o.call(e,s)&&l(t,s,e[s]);if(a)for(var s of a(e))i.call(e,s)&&l(t,s,e[s]);return t},d=(t,a)=>e(t,s(a));import{_ as r}from"./ModalDialog.0d82a3c5.js";import{d as c,i as u,o as m,q as p,w as b,f as h,G as k,H as f,b as v,g,t as y,F as w,I as B,J as I,k as L,K as C,p as x,a as $,L as T,e as S,j as P,n as M,N as A,O as q,l as O,m as U,u as Q,h as E}from"./vendor.cb33bf1d.js";import{B as j,a as H}from"./beatmap.b8797e7f.js";import{T as D,a as V}from"./task.5925ddbb.js";import{_ as F}from"./ModesIcons.529dd388.js";import{_ as N}from"./UserLinkList.aca6880a.js";import{F as _}from"./extras.b9e74742.js";var R=c({name:"CreateBeatmapModal",components:{ModalDialog:r},props:{isSecret:Boolean},data:()=>({featuredArtists:[],featuredSongs:[],selectedArtist:"",selectedSong:"",selectedMode:"osu",checkedTasks:[],checkedLocks:[],modes:[{value:"osu",name:"osu!"},{value:"taiko",name:"osu!taiko"},{value:"catch",name:"osu!catch"},{value:"mania",name:"osu!mania"}],tasks:["Easy","Normal","Hard","Insane","Expert"]}),async created(){const t=await this.$http.executeGet("/featuredArtists/"+(this.isSecret?"showcase":""));t&&(this.featuredArtists=t.sort(((t,e)=>t.label.toLowerCase()>e.label.toLowerCase()?1:e.label.toLowerCase()>t.label.toLowerCase()?-1:0)))},methods:{async setArtist(t){if(!this.selectedArtist)return void this.$store.dispatch("updateToastMessages",{message:"Select an artist!",type:"info"});t.target.disabled=!0;const e=await this.$http.executeGet(`/featuredArtists/${this.selectedArtist}/${this.isSecret?"showcaseSongs":"songs"}`);e&&(this.featuredSongs=e.sort(((t,e)=>t.title.toLowerCase()>e.title.toLowerCase()?1:e.title.toLowerCase()>t.title.toLowerCase()?-1:0))),t.target.disabled=!1},async saveNewMap(t){if(!this.selectedSong)return void this.$store.dispatch("updateToastMessages",{message:"Select a song!",type:"info"});const e=await this.$http.executePost("/beatmaps/create/",{song:this.selectedSong,tasks:this.checkedTasks,tasksLocked:this.checkedLocks,mode:this.selectedMode,status:this.isSecret?"Secret":"WIP"},t);this.$http.isError(e)||(this.$bs.hideModal("addBeatmap"),this.$store.commit("beatmaps/addBeatmap",e))}}});const W={class:"container"},G={class:"mb-3 row"},K=h("div",{class:"col-lg-1"},[h("p",{style:{"margin-top":"3px"}}," Artist: ")],-1),J={class:"col-lg-11"},X={id:"artistForm",class:"input-group input-group-sm mb-3"},z=h("option",{value:"",disabled:""}," Select an artist ",-1),Y=h("option",{value:"-",disabled:""}," --- ",-1),Z=["value"],tt=h("div",{class:"col-lg-1"},[h("p",{style:{"margin-top":"3px"}}," Song: ")],-1),et={class:"col-lg-11"},st=["disabled"],at=h("option",{value:"",disabled:""}," Select an artist to view songs ",-1),ot=h("option",{value:"-",disabled:""}," --- ",-1),it=["value"],lt=h("p",null," Game-mode: ",-1),nt={class:"mb-3 row"},dt={class:"col-sm-10"},rt=["id","value"],ct=["for"],ut=h("br",null,null,-1),mt=h("small",{class:"text-white-50"},"If you want a hybrid mapset, change this later.",-1),pt=h("p",null,[L(" Select one or more difficulties "),h("i",null,"you plan on mapping"),L(". These can be changed later: ")],-1),bt={class:"mb-3 row"},ht={class:"col-sm-10"},kt=["id","value"],ft=["for"],vt=h("p",null,[L(" Select one or more difficulties "),h("i",null,"you don't want anyone else to claim"),L(". These can be changed later: "),h("br"),h("small",{class:"text-white-50"},"For example, if you don't want any guest difficulties, you should mark everything.")],-1),gt={class:"mb-3 row"},yt={class:"col-sm-10"},wt=["id","value"],Bt=["for"],It=h("div",{class:"radial-divisor"},null,-1);function Lt(t,e,s){const a={class:["px-1","text-"+e.toLowerCase()]};return s&&(a["data-bs-toggle"]="tooltip",a["data-bs-placement"]="top",a.title=s),C("span",a,t)}R.render=function(t,e,s,a,o,i){const l=u("modal-dialog");return m(),p(l,{id:"addBeatmap",title:"Add beatmap"},{default:b((()=>[h("div",W,[h("div",G,[K,h("div",J,[h("div",X,[k(h("select",{"onUpdate:modelValue":e[0]||(e[0]=e=>t.selectedArtist=e),class:"form-select"},[z,Y,(m(!0),v(w,null,g(t.featuredArtists,(t=>(m(),v("option",{key:t.id,value:t.id},y(t.label),9,Z)))),128))],512),[[f,t.selectedArtist]]),h("button",{id:"artistButton",class:"btn btn-outline-info",onClick:e[1]||(e[1]=e=>t.setArtist(e))}," Load songs ")])]),tt,h("div",et,[k(h("select",{"onUpdate:modelValue":e[2]||(e[2]=e=>t.selectedSong=e),class:"form-select form-select-sm",disabled:!t.featuredSongs.length},[at,ot,(m(!0),v(w,null,g(t.featuredSongs,(t=>(m(),v("option",{key:t.id,value:t.id},y(t.title)+" --- ("+y(t.artist)+") ",9,it)))),128))],8,st),[[f,t.selectedSong]])])]),lt,h("div",nt,[h("div",dt,[(m(!0),v(w,null,g(t.modes,(s=>(m(),v("div",{key:s.value,class:"form-check form-check-inline"},[k(h("input",{id:s.value,"onUpdate:modelValue":e[3]||(e[3]=e=>t.selectedMode=e),class:"form-check-input",type:"radio",value:s.value},null,8,rt),[[B,t.selectedMode]]),h("label",{class:"form-check-label",for:s.value},y(s.name),9,ct)])))),128)),ut,mt])]),pt,h("div",bt,[h("div",ht,[(m(!0),v(w,null,g(t.tasks,(s=>(m(),v("div",{key:s,class:"form-check"},[k(h("input",{id:s,"onUpdate:modelValue":e[4]||(e[4]=e=>t.checkedTasks=e),class:"form-check-input",type:"checkbox",value:s},null,8,kt),[[I,t.checkedTasks]]),h("label",{class:"form-check-label",for:s},y(s),9,ft)])))),128))])]),vt,h("div",gt,[h("div",yt,[(m(!0),v(w,null,g(t.tasks,(s=>(m(),v("div",{key:s,class:"form-check"},[k(h("input",{id:`lock-${s}`,"onUpdate:modelValue":e[5]||(e[5]=e=>t.checkedLocks=e),class:"form-check-input",type:"checkbox",value:s},null,8,wt),[[I,t.checkedLocks]]),h("label",{class:"form-check-label",for:`lock-${s}`},y(s),9,Bt)])))),128))])])]),It,h("button",{type:"submit",class:"btn btn-outline-success w-100",onClick:e[6]||(e[6]=e=>t.saveNewMap(e))}," Save ")])),_:1})};var Ct=c({props:{tasks:{type:Array,required:!0},tasksLocked:{type:Array,required:!0},mode:{type:String,required:!0}},render(){const t=[{name:"Storyboard",short:"SB",locked:!1,status:[]},{name:"Easy",short:"E",locked:!1,status:[]},{name:"Normal",short:"N",locked:!1,status:[]},{name:"Hard",short:"H",locked:!1,status:[]},{name:"Insane",short:"I",locked:!1,status:[]},{name:"Expert",short:"X",locked:!1,status:[]}],e=[{name:"osu",short:"circle",count:0,status:D.Done},{name:"taiko",short:"drum",count:0,status:D.Done},{name:"catch",short:"apple-alt",count:0,status:D.Done},{name:"mania",short:"stream",count:0,status:D.Done}],s=[],a=this.tasks.length>=10,o=this.mode===j.Hybrid;for(const i of t){let t=!1;const l=this.tasksLocked.includes(i.name);for(const s of this.tasks)if(i.name===s.name){i.status.push(s.status),t=!0;const a=e.findIndex((t=>t.name===s.mode));-1!==a&&(e[a].count++,s.status===D.WIP&&(e[a].status=D.WIP))}if(!o){if(a&&i.status.length>1)s.push(Lt(i.short+"+","secondary",i.status.length.toString()));else for(const t of i.status)s.push(Lt(i.short,t));t||s.push(Lt(i.short,l?"blocked":"open"))}}if(o)for(const i of e)s.push(Lt([C("i",{class:["fas","fa-"+i.short]})],i.count?i.status:"blocked",i.count.toString()));return C("span",{class:"fw-bold"},s)}}),xt=c({props:{beatmap:{type:Object,required:!0}},computed:{url(){var t;return this.beatmap.isShowcase||!(null==(t=this.beatmap.quest)?void 0:t.art)?"/images/no-art-icon.png":this.beatmap.quest.isMbc?"/images/mbc-icon.png":`https://assets.ppy.sh/artists/${this.beatmap.quest.art}/cover.jpg`}}});x("data-v-2c03ee2b");const $t=["src"];$(),xt.render=function(t,e,s,a,o,i){const l=T("bs-tooltip");return t.beatmap.quest||t.beatmap.isShowcase?k((m(),v("img",{key:0,class:"rounded-circle me-1 quest-icon",src:t.url},null,8,$t)),[[l,t.beatmap.quest&&t.beatmap.quest.name||"FA showcase"]]):S("",!0)},xt.__scopeId="data-v-2c03ee2b";var Tt=c({name:"BeatmapCard",components:{ProcessTasks:Ct,QuestImg:xt,ModesIcons:F},props:{beatmap:{type:Object,required:!0}},emits:["update:selectedBeatmap"],data:()=>({defaultUrl:"https://osu.ppy.sh/images/layout/beatmaps/default-bg.png"}),computed:{statusBorder(){return this.beatmap.status?"card-status-"+this.beatmap.status.toLowerCase():""}},methods:{fallbackImage(t){t.target.src=this.defaultUrl},formatMetadata(t,e){const s=t+" - "+e;return s.length>34?s.slice(0,34)+"...":s},processUrl(t){if(t&&-1!==t.indexOf("osu.ppy.sh/beatmapsets/")){const e=t.indexOf("beatmapsets/")+"beatmapsets/".length,s=t.indexOf("#");let a;return a=-1!==s?t.slice(e,s):t.slice(e),`https://assets.ppy.sh/beatmaps/${a}/covers/card.jpg`}return this.defaultUrl}}});x("data-v-c492b510");const St=["src"],Pt={class:"card-img-overlay",style:{padding:"0.50rem 0.50rem 0 0.50rem"}},Mt={class:"card-title mb-1"},At={class:"card-text"},qt=L(" Hosted by ");$(),Tt.render=function(t,e,s,a,o,i){const l=u("quest-img"),n=u("user-link"),d=u("modes-icons"),r=u("process-tasks");return m(),v("div",{class:"my-2 col-sm-12 col-md-6 col-lg-4",onClick:e[1]||(e[1]=e=>t.$emit("update:selectedBeatmap",t.beatmap))},[h("div",{class:M(["card card-hover map-card bg-dark",t.statusBorder]),"data-bs-toggle":"modal","data-bs-target":"#editBeatmap"},[h("img",{class:"card-img",src:t.processUrl(t.beatmap.url),style:{opacity:"0.2"},onError:e[0]||(e[0]=e=>t.fallbackImage(e))},null,40,St),h("div",Pt,[h("p",Mt,y(t.formatMetadata(t.beatmap.song.artist,t.beatmap.song.title)),1),h("small",At,[P(l,{beatmap:t.beatmap},null,8,["beatmap"]),qt,P(n,{class:"me-1",user:t.beatmap.host},null,8,["user"]),"osu"!==t.beatmap.mode?(m(),p(d,{key:0,modes:[t.beatmap.mode]},null,8,["modes"])):S("",!0),P(r,{class:"float-end pt-1",tasks:t.beatmap.tasks,"tasks-locked":t.beatmap.tasksLocked,mode:t.beatmap.mode},null,8,["tasks","tasks-locked","mode"])])])],2)])},Tt.__scopeId="data-v-c492b510";var Ot=c({name:"ModeChoice",props:{beatmap:{type:Object,required:!0}},methods:{async setMode(t,e,s){const a=await this.$http.executePost(`/beatmaps/${t}/setMode`,{mode:e},s);this.$http.isError(a)||this.$store.dispatch("beatmaps/updateBeatmap",a)}}});x("data-v-3418d444");const Ut={id:"mode",class:"mb-3"},Qt=h("div",{class:"d-inline-block me-2"}," Mode ",-1),Et=["disabled"],jt=[h("i",{class:"far fa-circle"},null,-1)],Ht=["disabled"],Dt=[h("i",{class:"fas fa-drum"},null,-1)],Vt=["disabled"],Ft=[h("i",{class:"fas fa-apple-alt"},null,-1)],Nt=["disabled"],_t=[h("i",{class:"fas fa-stream"},null,-1)],Rt=["disabled"],Wt=[h("i",{class:"fas fa-check-double"},null,-1)];$(),Ot.render=function(t,e,s,a,o,i){const l=T("bs-tooltip");return m(),v("div",Ut,[Qt,k(h("button",{class:M(["btn btn-sm rounded-100 me-1","osu"==t.beatmap.mode?"btn-info":"btn-outline-info"]),disabled:"osu"==t.beatmap.mode,onClick:e[0]||(e[0]=e=>t.setMode(t.beatmap.id,"osu",e))},jt,10,Et),[[l,"osu!"]]),k(h("button",{class:M(["btn btn-sm rounded-100 me-1","taiko"==t.beatmap.mode?"btn-info":"btn-outline-info"]),disabled:"taiko"==t.beatmap.mode,onClick:e[1]||(e[1]=e=>t.setMode(t.beatmap.id,"taiko",e))},Dt,10,Ht),[[l,"osu!taiko"]]),k(h("button",{class:M(["btn btn-sm rounded-100 me-1","catch"==t.beatmap.mode?"btn-info":"btn-outline-info"]),disabled:"catch"==t.beatmap.mode,onClick:e[2]||(e[2]=e=>t.setMode(t.beatmap.id,"catch",e))},Ft,10,Vt),[[l,"osu!catch"]]),k(h("button",{class:M(["btn btn-sm rounded-100 me-1","mania"==t.beatmap.mode?"btn-info":"btn-outline-info"]),disabled:"mania"==t.beatmap.mode,onClick:e[3]||(e[3]=e=>t.setMode(t.beatmap.id,"mania",e))},_t,10,Nt),[[l,"osu!mania"]]),k(h("button",{class:M(["btn btn-sm rounded-100 me-1","hybrid"==t.beatmap.mode?"btn-info":"btn-outline-info"]),disabled:"hybrid"==t.beatmap.mode,onClick:e[4]||(e[4]=e=>t.setMode(t.beatmap.id,"hybrid",e))},Wt,10,Rt),[[l,"multiple modes"]])])},Ot.__scopeId="data-v-3418d444";var Gt=c({name:"StatusChoice",props:{beatmap:{type:Object,required:!0}},methods:{async setStatus(t,e){const s=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/setStatus`,{status:t},e);this.$http.isError(s)||this.$store.dispatch("beatmaps/updateBeatmap",s)}}});const Kt={id:"mapsetStatus",class:"mb-3"},Jt=h("div",{class:"d-inline-block me-2"}," Status ",-1),Xt=["disabled"],zt=[L(" Done ")],Yt=["disabled"],Zt=[L(" WIP ")];Gt.render=function(t,e,s,a,o,i){const l=T("bs-tooltip");return m(),v("div",Kt,[Jt,k(h("button",{class:M(["btn btn-sm me-1","Done"==t.beatmap.status?"btn-success":"btn-outline-success"]),disabled:"Done"==t.beatmap.status,onClick:e[0]||(e[0]=e=>t.setStatus("Done",e))},zt,10,Xt),[[l,"mark mapset and all diffs as done","bottom"]]),k(h("button",{class:M(["btn btn-sm me-1","WIP"==t.beatmap.status?"btn-warning":"btn-outline-warning"]),disabled:"WIP"==t.beatmap.status,onClick:e[1]||(e[1]=e=>t.setStatus("WIP",e))},Zt,10,Yt),[[l,"mark mapset as work-in-progress","bottom"]])])};var te=c({name:"NewTask",props:{isHost:Boolean,taskToAddCollaborator:{type:Object,default:null},beatmap:{type:Object,required:!0}},emits:["update:taskToAddCollaborator"],data:()=>({selectedTask:V.Easy,selectedMode:j.Osu,requestTaskUsername:""}),computed:{remainingTasks(){let t=Object.values(V);return this.beatmap.tasksLocked&&this.beatmap.tasksLocked.length&&!this.isHost&&(t=t.filter((t=>!this.beatmap.tasksLocked.includes(t)))),this.selectedTask=t[0]||"",t}},methods:{async addTask(t,e){if(this.requestTaskUsername&&this.requestTaskUsername.length)return void this.requestTask(t,e);let s;s=this.beatmap.mode==j.Hybrid?this.selectedMode:this.beatmap.mode;const a=await this.$http.executePost("/beatmaps/addTask/"+t,{taskName:this.selectedTask,mode:s},e);this.$http.isError(a)||this.$store.dispatch("beatmaps/updateBeatmap",a)},async requestTask(t,e){let s;s=this.beatmap.mode==j.Hybrid?this.selectedMode:this.beatmap.mode;const a=await this.$http.executePost("/beatmaps/requestTask/"+t,{taskName:this.selectedTask,user:this.requestTaskUsername,mode:s},e);this.$http.isError(a)||(this.$store.dispatch("beatmaps/updateBeatmap",a),this.$store.dispatch("updateToastMessages",{message:"Difficulty request sent!",type:"success"}))},async addCollab(t){let e;e=this.beatmap.mode==j.Hybrid?this.taskToAddCollaborator.mode:this.beatmap.mode;const s=await this.$http.executePost("/beatmaps/task/"+this.taskToAddCollaborator.id+"/addCollab",{user:this.requestTaskUsername,taskName:this.taskToAddCollaborator.name,mode:e},t);this.$http.isError(s)||(this.$store.dispatch("beatmaps/updateBeatmap",s),this.$store.dispatch("updateToastMessages",{message:"Collab invite sent!",type:"success"}))}}});const ee={key:0,class:"row mt-2 mb-3"},se={class:"col-sm-12"},ae={class:"input-group input-group-sm mx-auto"},oe=["value"],ie=[h("option",{value:"osu"}," osu! ",-1),h("option",{value:"taiko"}," osu!taiko ",-1),h("option",{value:"catch"}," osu!catch ",-1),h("option",{value:"mania"}," osu!mania ",-1)],le=[h("i",{class:"fas fa-plus"},null,-1)],ne={key:0,class:"col-sm-12 mt-1 text-center"},de=L(" Adding collaborator for the selected difficulty "),re=[h("i",{class:"fas fa-times-circle"},null,-1)];te.render=function(t,e,s,a,o,i){const l=T("bs-tooltip");return"WIP"!=t.beatmap.status&&"Secret"!=t.beatmap.status||!t.remainingTasks.length?S("",!0):(m(),v("div",ee,[h("div",se,[h("div",ae,[t.taskToAddCollaborator?S("",!0):k((m(),v("select",{key:0,"onUpdate:modelValue":e[0]||(e[0]=e=>t.selectedTask=e),class:"form-select"},[(m(!0),v(w,null,g(t.remainingTasks,(t=>(m(),v("option",{key:t,value:t},y(t),9,oe)))),128))],512)),[[f,t.selectedTask]]),"hybrid"!=t.beatmap.mode||t.taskToAddCollaborator?S("",!0):k((m(),v("select",{key:1,"onUpdate:modelValue":e[1]||(e[1]=e=>t.selectedMode=e),class:"form-select"},ie,512)),[[f,t.selectedMode]]),t.isHost||t.taskToAddCollaborator?k((m(),v("input",{key:2,"onUpdate:modelValue":e[2]||(e[2]=e=>t.requestTaskUsername=e),class:"form-control",type:"text",placeholder:"request to... (optional)",maxlength:"18",onKeyup:e[3]||(e[3]=q((e=>t.taskToAddCollaborator?t.addCollab(e):t.requestTask(t.beatmap.id,e)),["enter"]))},null,544)),[[A,t.requestTaskUsername]]):S("",!0),k(h("button",{class:"btn btn-outline-info",onClick:e[4]||(e[4]=e=>t.taskToAddCollaborator?t.addCollab(e):t.addTask(t.beatmap.id,e))},le,512),[[l,"add difficulty"]])])]),t.taskToAddCollaborator?(m(),v("div",ne,[h("small",null,[de,h("a",{class:"text-danger",href:"#",onClick:e[5]||(e[5]=O((e=>t.$emit("update:taskToAddCollaborator",null)),["prevent"]))},re)])])):S("",!0)]))};var ce=c({name:"TasksChoice",components:{NewTask:te,ModesIcons:F},props:{beatmap:{type:Object,required:!0},isHost:Boolean,isRanked:Boolean,isQualified:Boolean},data:()=>({taskToAddCollaborator:null}),computed:d(n({},U(["loggedInUser"])),{sortedTasks(){const t=["Easy","Normal","Hard","Insane","Expert","Storyboard"],e=["osu","taiko","catch","mania","sb"];return[...this.beatmap.tasks].sort((function(e,s){return t.indexOf(e.name)-t.indexOf(s.name)})).sort((function(t,s){return e.indexOf(t.mode)-e.indexOf(s.mode)}))}}),methods:{isOwner(t){return t.some((t=>t.osuId==this.loggedInUser.osuId))},canEditTask(t){return this.isOwner(t.mappers)||this.isHost},async setTaskStatus(t,e,s){s.target.classList.add("fake-button-disable");const a=await this.$http.executePost("/beatmaps/setTaskStatus/"+t,{status:e});this.$http.isError(a)||this.$store.dispatch("beatmaps/updateBeatmap",a),s.target.classList.remove("fake-button-disable")},async removeTask(t,e){e.target.classList.add("fake-button-disable");const s=await this.$http.executePost("/beatmaps/removeTask/"+t,{beatmapId:this.beatmap.id});this.$http.isError(s)||this.$store.dispatch("beatmaps/updateBeatmap",s),e.target.classList.remove("fake-button-disable")},canEditTaskCollaborators(t){return"Done"!=t.status&&!this.isQualified&&"Done"!=this.beatmap.status&&this.isOwner(t.mappers)},async removeCollab(t,e,s){s.target.classList.add("fake-button-disable");const a=await this.$http.executePost("/beatmaps/task/"+t+"/removeCollab",{user:e});this.$http.isError(a)||this.$store.dispatch("beatmaps/updateBeatmap",a),s.target.classList.remove("fake-button-disable")},isAddingCollaborator(t){var e;return(null==(e=this.taskToAddCollaborator)?void 0:e.id)==t.id}}});const ue={class:"row"},me={class:"col-sm-12"},pe={class:"table table-sm"},be=h("th",null,"Difficulty",-1),he=h("th",null,"Mapper(s)",-1),ke={key:0},fe=["id"],ve=[h("i",{class:"fas fa-times"},null,-1)],ge=["onClick"],ye=[h("i",{class:"fas fa-plus"},null,-1)],we=["onClick"],Be=[h("i",{class:"fas fa-minus"},null,-1)],Ie={key:0},Le=["onClick"],Ce=[h("i",{class:"fas fa-minus"},null,-1)],xe=["onClick"],$e=[h("i",{class:"fas fa-check"},null,-1)],Te=["onClick"],Se=[h("i",{class:"fas fa-ellipsis-h"},null,-1)],Pe={key:0,class:"col-sm-12 mt-2"};ce.render=function(t,e,s,a,o,i){const l=u("modes-icons"),n=u("user-link"),d=u("new-task"),r=T("bs-tooltip");return m(),v("div",ue,[h("div",me,[h("table",pe,[h("thead",null,[h("tr",null,[be,he,t.isRanked||t.isQualified?S("",!0):(m(),v("th",ke))])]),P(Q,{tag:"tbody",name:"list"},{default:b((()=>[(m(!0),v(w,null,g(t.sortedTasks,(s=>(m(),v("tr",{id:s.id+"Row",key:s.id},[h("td",{class:M(["text-white-50",`card-status-${s.status.toLowerCase()}`])},[L(y(s.name)+" ",1),"hybrid"==t.beatmap.mode?(m(),p(l,{key:0,modes:[s.mode]},null,8,["modes"])):S("",!0)],2),h("td",null,[(m(!0),v(w,null,g(s.mappers,((a,o)=>(m(),v("div",{key:a.id},[0==o&&t.canEditTaskCollaborators(s)?(m(),v(w,{key:0},[t.isAddingCollaborator(s)?k((m(),v("a",{key:0,href:"#",class:"text-danger",onClick:e[0]||(e[0]=O((e=>t.taskToAddCollaborator=null),["prevent"]))},ve,512)),[[r,"cancel"]]):k((m(),v("a",{key:1,href:"#",class:"text-success",onClick:O((e=>t.taskToAddCollaborator=s),["prevent"])},ye,8,ge)),[[r,"invite new collaborator"]])],64)):S("",!0),P(n,{class:"mx-1",user:a},null,8,["user"]),s.mappers.length>1&&t.canEditTaskCollaborators(s)&&a.osuId!=t.loggedInUser.osuId?k((m(),v("a",{key:1,href:"#",class:"text-danger",onClick:O((e=>t.removeCollab(s.id,a.id,e)),["prevent"])},Be,8,we)),[[r,"remove collaborator"]]):S("",!0)])))),128))]),t.isRanked||t.isQualified?S("",!0):(m(),v("td",Ie,[t.canEditTask(s)?(m(),v(w,{key:0},[k(h("a",{href:"#",class:"text-danger me-1",onClick:O((e=>t.removeTask(s.id,e)),["prevent"])},Ce,8,Le),[[r,"delete"]]),"WIP"==s.status?k((m(),v("a",{key:0,href:"#",class:"text-success me-1",onClick:O((e=>t.setTaskStatus(s.id,"Done",e)),["prevent"])},$e,8,xe)),[[r,"mark as done"]]):S("",!0),"Done"==s.status&&"Done"!=t.beatmap.status?k((m(),v("a",{key:1,href:"#",class:"text-wip me-1",onClick:O((e=>t.setTaskStatus(s.id,"WIP",e)),["prevent"])},Se,8,Te)),[[r,"mark as WIP"]]):S("",!0)],64)):S("",!0)]))],8,fe)))),128))])),_:1})])]),t.isRanked||t.isQualified?S("",!0):(m(),v("div",Pe,[P(d,{"task-to-add-collaborator":t.taskToAddCollaborator,"onUpdate:task-to-add-collaborator":e[1]||(e[1]=e=>t.taskToAddCollaborator=e),beatmap:t.beatmap,"is-host":t.isHost},null,8,["task-to-add-collaborator","beatmap","is-host"])]))])};var Me=c({name:"QuestChoice",props:{beatmap:{type:Object,required:!0}},data:()=>({userQuests:[],showQuestInput:!1,dropdownQuestId:""}),computed:U(["loggedInUser"]),watch:{beatmap(){var t;this.showQuestInput=!1,this.dropdownQuestId=(null==(t=this.beatmap.quest)?void 0:t.id)||""}},async created(){const t=await this.$http.executeGet(`/users/${this.loggedInUser.id}/quests`);this.$http.isError(t)||(this.userQuests=t)},methods:{async linkQuest(t){const e=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/linkQuest`,{questId:this.dropdownQuestId},t);this.$http.isError(e)||this.$store.dispatch("beatmaps/updateBeatmap",e)}}});const Ae={class:"row mb-2"},qe={class:"col"},Oe=L(" Quest "),Ue=[h("i",{class:"fas fa-edit"},null,-1)],Qe={class:"small ms-3 text-white-50"},Ee={key:0},je={key:1},He={key:0,class:"row mb-2"},De={class:"col"},Ve={class:"input-group input-group-sm"},Fe=h("option",{value:""}," No quest ",-1),Ne=["value"],_e=[L(" Save ")];Me.render=function(t,e,s,a,o,i){const l=T("bs-tooltip");return m(),v("div",null,[h("div",Ae,[h("div",qe,[h("div",null,[Oe,k(h("a",{id:"editLink",href:"#",class:M([t.showQuestInput?"text-danger":"","text-success small ms-1"]),onClick:e[0]||(e[0]=O((e=>t.showQuestInput=!t.showQuestInput),["prevent"]))},Ue,2),[[l,"connect mapset with a quest","right"]])]),h("div",Qe,[t.beatmap.quest?(m(),v("span",Ee,y(t.beatmap.quest.name),1)):(m(),v("i",je,"none"))])])]),t.showQuestInput?(m(),v("div",He,[h("div",De,[h("div",Ve,[k(h("select",{"onUpdate:modelValue":e[1]||(e[1]=e=>t.dropdownQuestId=e),class:"form-select"},[Fe,(m(!0),v(w,null,g(t.userQuests,(t=>(m(),v("option",{key:t.id,value:t.id},y(t.name),9,Ne)))),128))],512),[[f,t.dropdownQuestId]]),k(h("button",{class:"btn btn-outline-info",onClick:e[2]||(e[2]=e=>t.linkQuest(e))},_e,512),[[l,"link beatmap to quest"]])])])])):S("",!0)])};var Re=c({name:"ModdersList",components:{UserLinkList:N},props:{canEdit:Boolean,beatmap:{type:Object,required:!0}},computed:d(n({},U(["loggedInUser"])),{isModder(){return this.beatmap.modders.some((t=>t.osuId==this.loggedInUser.osuId))}}),methods:{async updateModder(t){t.target.classList.add("fake-button-disable");const e=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/updateModder`);this.$http.isError(e)||this.$store.dispatch("beatmaps/updateBeatmap",e),t.target.classList.remove("fake-button-disable")}}});const We={id:"modders",class:"row mb-2"},Ge={class:"col"},Ke={key:0,class:"ms-1"},Je={class:"small ms-3"},Xe={key:0,class:"text-white-50"};Re.render=function(t,e,s,a,o,i){const l=u("user-link-list"),n=T("bs-tooltip");return m(),v("div",We,[h("div",Ge,[h("div",null,[L(" Modders ("+y(t.beatmap.modders.length)+") ",1),t.canEdit?k((m(),v("small",Ke,[h("a",{href:"#",class:M(t.isModder?"text-danger":"text-success"),onClick:e[0]||(e[0]=O((e=>t.updateModder(e)),["prevent"]))},[h("i",{class:M(["fas",t.isModder?"fa-minus":"fa-plus"])},null,2)],2)],512)),[[n,"add/remove yourself from modder list","right"]]):S("",!0)]),h("div",Je,[0==t.beatmap.modders.length?(m(),v("i",Xe," none ")):(m(),p(l,{key:1,users:t.beatmap.modders},null,8,["users"]))])])])};var ze=c({name:"NominatorsList",components:{UserLinkList:N},props:{canEdit:Boolean,beatmap:{type:Object,required:!0}},computed:d(n({},U(["loggedInUser"])),{isBn(){return this.beatmap.bns.some((t=>t.osuId==this.loggedInUser.osuId))}}),methods:{async updateBn(t){t.target.classList.add("fake-button-disable");const e=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/updateBn`);this.$http.isError(e)||this.$store.dispatch("beatmaps/updateBeatmap",e),t.target.classList.remove("fake-button-disable")}}});const Ye={key:0,class:"ms-1"},Ze=[h("i",{class:"fas fa-minus"},null,-1)],ts=[h("i",{class:"fas fa-plus"},null,-1)],es={class:"small ms-3"},ss={key:0,class:"text-white-50"};ze.render=function(t,e,s,a,o,i){const l=u("user-link-list"),n=T("bs-tooltip");return m(),v("div",null,[h("div",null,[L(" Potential Nominators ("+y(t.beatmap.bns.length)+") ",1),t.canEdit?k((m(),v("small",Ye,[t.isBn?(m(),v("a",{key:0,href:"#",class:"text-danger",onClick:e[0]||(e[0]=O((e=>t.updateBn(e)),["prevent"]))},Ze)):S("",!0),!t.isBn&&t.beatmap.bns.length<2?(m(),v("a",{key:1,href:"#",class:"text-success",onClick:e[1]||(e[1]=O((e=>t.updateBn(e)),["prevent"]))},ts)):S("",!0)],512)),[[n,"add/remove yourself from potential BN list","right"]]):S("",!0)]),h("div",es,[0==t.beatmap.bns.length?(m(),v("i",ss,"none")):(m(),p(l,{key:1,users:t.beatmap.bns},null,8,["users"]))])])};var as=c({name:"BeatmapLink",props:{beatmap:{type:Object,required:!0}},data:()=>({url:"",showLinkInput:!1}),watch:{beatmap(t){t&&(this.showLinkInput=!1,this.url=t.url)}},created(){this.url=this.beatmap.url},methods:{async saveLink(t){const e=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/setLink`,{url:this.url},t);this.$http.isError(e)||(this.showLinkInput=!1,this.$store.dispatch("beatmaps/updateBeatmap",e))}}});const os={class:"row mb-2"},is={class:"col"},ls=L(" Link "),ns=[h("i",{class:"fas fa-edit"},null,-1)],ds={class:"small ms-3"},rs=["href"],cs={key:1,class:"text-white-50"},us={key:0,class:"row mb-2"},ms={class:"col-sm-12"},ps={class:"input-group input-group-sm"},bs=[L(" Save ")];as.render=function(t,e,s,a,o,i){const l=T("bs-tooltip");return m(),v("div",null,[h("div",os,[h("div",is,[h("div",null,[ls,k(h("a",{id:"editLink",href:"#",class:M(["text-success small ms-1",{"text-danger":t.showLinkInput}]),onClick:e[0]||(e[0]=O((e=>t.showLinkInput=!t.showLinkInput),["prevent"]))},ns,2),[[l,"edit link","right"]])]),h("div",ds,[t.beatmap.url?(m(),v("a",{key:0,href:t.beatmap.url,target:"_blank"},y(t.beatmap.url),9,rs)):(m(),v("i",cs,"none"))])])]),t.showLinkInput?(m(),v("div",us,[h("div",ms,[h("div",ps,[k(h("input",{"onUpdate:modelValue":e[1]||(e[1]=e=>t.url=e),class:"form-control form-control-sm",type:"text",placeholder:"URL",onKeyup:e[2]||(e[2]=q((e=>t.saveLink(e)),["enter"]))},null,544),[[A,t.url]]),k(h("button",{id:"addLinkButton",class:"btn btn-outline-info",type:"submit",onClick:e[3]||(e[3]=e=>t.saveLink(e))},bs,512),[[l,"use new osu!web link for card image","right"]])])])])):S("",!0)])};var hs=c({name:"LocksChoice",props:{beatmap:{type:Object,required:!0}},data:()=>({lockTaskSelection:"",showLocksInput:!1}),computed:{remainingTasks(){var t,e;let s=Object.values(V);return(null==(e=null==(t=this.beatmap)?void 0:t.tasksLocked)?void 0:e.length)&&(s=s.filter((t=>!this.beatmap.tasksLocked.includes(t)))),this.lockTaskSelection=s[0]||"",s}},watch:{beatmap(){this.showLocksInput=!1}},methods:{async unlockTask(t,e){e.target.classList.add("fake-button-disable");const s=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/unlockTask`,{task:t});this.$http.isError(s)||this.$store.dispatch("beatmaps/updateBeatmap",s),e.target.classList.remove("fake-button-disable")},async lockTask(t){const e=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/lockTask`,{task:this.lockTaskSelection},t);this.$http.isError(e)||this.$store.dispatch("beatmaps/updateBeatmap",e)}}});const ks={id:"locks",class:"row mb-1"},fs={class:"col"},vs=L(" Locks "),gs=[h("i",{class:"fas fa-edit"},null,-1)],ys={class:"small ms-3"},ws={key:0},Bs={key:1},Is=["onClick"],Ls=[h("i",{class:"fas fa-minus"},null,-1)],Cs={class:"text-white-50 mx-1"},xs={key:0,class:"row"},$s={class:"col"},Ts={class:"input-group input-group-sm"},Ss=["value"],Ps=[h("i",{class:"fas fa-lock"},null,-1)];hs.render=function(t,e,s,a,o,i){const l=T("bs-tooltip");return m(),v("div",null,[h("div",ks,[h("div",fs,[h("div",null,[vs,6!=t.beatmap.tasksLocked.length?(m(),v("a",{key:0,class:"text-success small ms-1",href:"#",onClick:e[0]||(e[0]=O((e=>t.showLocksInput=!t.showLocksInput),["prevent"]))},gs)):S("",!0)]),h("div",ys,[0==t.beatmap.tasksLocked.length?(m(),v("i",ws,"none")):S("",!0),t.beatmap.tasksLocked.length>0?(m(),v("div",Bs,[(m(!0),v(w,null,g(t.beatmap.tasksLocked,(e=>(m(),v("div",{key:e},[k(h("a",{href:"#",class:"text-danger",onClick:O((s=>t.unlockTask(e,s)),["prevent"])},Ls,8,Is),[[l,"unlock","left"]]),h("span",Cs,y(e),1)])))),128))])):S("",!0)])])]),t.showLocksInput?(m(),v("div",xs,[h("div",$s,[h("div",Ts,[k(h("select",{"onUpdate:modelValue":e[1]||(e[1]=e=>t.lockTaskSelection=e),class:"form-select"},[(m(!0),v(w,null,g(t.remainingTasks,(t=>(m(),v("option",{key:t,value:t},y(t),9,Ss)))),128))],512),[[f,t.lockTaskSelection]]),k(h("button",{id:"lockTask",class:"btn btn-outline-info",onClick:e[2]||(e[2]=e=>t.lockTask(e))},Ps,512),[[l,"prevent other mappers from claiming a difficulty","right"]])])])])):S("",!0)])};var Ms=c({name:"Points",props:{beatmap:{type:Object,required:!0}},data:()=>({tasksPointsArray:null,usersPointsArrays:null,pointsInfo:null,totalPoints:null,isLoading:!1}),watch:{beatmap(){this.tasksPointsArray=null,this.usersPointsArrays=null,this.pointsInfo=null,this.totalPoints=null,this.isLoading=!1}},methods:{async findPoints(t){this.isLoading=!0;const e=await this.$http.executeGet(`/beatmaps/${this.beatmap.id}/findPoints`,t);this.$http.isError(e)||(this.tasksPointsArray=e.tasksPointsArray,this.usersPointsArrays=e.usersPointsArrays,this.pointsInfo=e.pointsInfo,this.totalPoints=e.totalPoints),this.isLoading=!1}}});const As={class:"row"},qs={class:"col-sm-12"},Os=[L(" Calculate points ")],Us={key:1,class:"small text-white-50 ms-2"},Qs={key:2,class:"small text-white-50 ms-2"},Es={key:0,class:"col-sm-6"},js={class:"small text-white-50"},Hs={class:"col-sm-6"},Ds={key:0,class:"small text-white-50"},Vs={key:1,class:"col-sm-12"},Fs={class:"small text-white-50 ms-2"};Ms.render=function(t,e,s,a,o,i){const l=T("bs-tooltip");return m(),v("div",null,[h("div",As,[h("div",qs,[t.tasksPointsArray?S("",!0):k((m(),v("button",{key:0,class:"btn btn-sm btn-outline-info ms-1",onClick:e[0]||(e[0]=e=>t.findPoints(e))},Os,512)),[[l,"calculate points for all difficulties"]]),t.isLoading?(m(),v("span",Us," calculating... ")):t.pointsInfo?(m(),v("span",Qs,y(t.pointsInfo),1)):S("",!0)]),t.tasksPointsArray?(m(),v("div",Es,[h("ul",js,[(m(!0),v(w,null,g(t.tasksPointsArray,((t,e)=>(m(),v("li",{key:e},y(t),1)))),128))])])):S("",!0),h("div",Hs,[t.usersPointsArrays?(m(),v("ul",Ds,[(m(!0),v(w,null,g(t.usersPointsArrays,((e,s)=>(m(),v("li",{key:s},y(t.usersPointsArrays[s][0])+": "+y(t.usersPointsArrays[s][1]),1)))),128))])):S("",!0)]),t.totalPoints?(m(),v("div",Vs,[h("span",Fs," total: "+y(Math.round(10*t.totalPoints)/10),1)])):S("",!0)])])};var Ns=c({name:"BeatmapInfo",components:{ModeChoice:Ot,StatusChoice:Gt,TasksChoice:ce,QuestChoice:Me,ModdersList:Re,NominatorsList:ze,BeatmapLink:as,LocksChoice:hs,Points:Ms},props:{beatmap:{type:Object,required:!0}},data:()=>({userQuests:null}),computed:d(n({},U(["loggedInUser"])),{isHost(){return!(!this.loggedInUser.id||!this.beatmap)&&this.loggedInUser.id===this.beatmap.host.id},isRanked(){return this.beatmap.status===H.Ranked},isQualified(){return this.beatmap.status===H.Qualified}}),methods:{async deleteMap(t){if(confirm("Are you sure you want to delete?")){t.target.disabled=!0;const e=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/delete`,{},t);this.$http.isError(e)||(this.$bs.hideModal("editBeatmap"),this.$store.commit("beatmaps/deleteBeatmap",e)),t.target.disabled=!1}}}});x("data-v-3038551c");const _s={key:0,class:"container"},Rs={class:"row"},Ws={class:"row mb-2"},Gs={class:"col-sm-6"},Ks={key:0,id:"bns",class:"col-sm-6"},Js=h("hr",null,null,-1),Xs={class:"row"},zs={class:"col-sm"},Ys={key:0,class:"col-lg-5 bm-col-separator-left"},Zs={class:"row mb-2"},ta={class:"col-sm"},ea={class:"row mb-2"},sa={class:"col-sm"},aa=h("hr",null,null,-1),oa={class:"row"},ia={class:"col-sm-4 text-end"},la={class:"small text-white-50"};$(),Ns.render=function(t,e,s,a,o,i){const l=u("modders-list"),n=u("nominators-list"),d=u("tasks-choice"),r=u("mode-choice"),c=u("status-choice"),b=u("quest-choice"),k=u("beatmap-link"),f=u("locks-choice"),g=u("points");return t.beatmap?(m(),v("div",_s,[h("div",Rs,[h("div",{class:M(!t.isHost||t.isRanked||t.isQualified?"col-sm-12":"col-lg-7")},[h("div",Ws,[h("div",Gs,[P(l,{beatmap:t.beatmap,"can-edit":!t.isHost&&!t.isRanked},null,8,["beatmap","can-edit"])]),!t.isRanked||t.beatmap.bns?(m(),v("div",Ks,[P(n,{beatmap:t.beatmap,"can-edit":!t.isHost&&!t.isRanked},null,8,["beatmap","can-edit"])])):S("",!0)]),Js,h("div",Xs,[h("div",zs,[P(d,{beatmap:t.beatmap,"is-host":t.isHost,"is-ranked":t.isRanked,"is-qualified":t.isQualified},null,8,["beatmap","is-host","is-ranked","is-qualified"])])])],2),!t.isHost||t.isRanked||t.isQualified?S("",!0):(m(),v("div",Ys,[h("div",Zs,[h("div",ta,["WIP"==t.beatmap.status||"Secret"==t.beatmap.status?(m(),p(r,{key:0,beatmap:t.beatmap},null,8,["beatmap"])):S("",!0)])]),h("div",ea,[h("div",sa,["Secret"!==t.beatmap.status?(m(),p(c,{key:0,beatmap:t.beatmap},null,8,["beatmap"])):S("",!0)])]),"Secret"!==t.beatmap.status?(m(),p(b,{key:0,beatmap:t.beatmap},null,8,["beatmap"])):S("",!0),P(k,{beatmap:t.beatmap},null,8,["beatmap"]),"WIP"==t.beatmap.status||"Secret"==t.beatmap.status?(m(),p(f,{key:1,beatmap:t.beatmap},null,8,["beatmap"])):S("",!0)]))]),aa,h("div",oa,[P(g,{class:"col-sm-8",beatmap:t.beatmap},null,8,["beatmap"]),h("div",ia,[h("span",la," Created: "+y(t.beatmap.createdAt.toString().slice(0,10)),1),t.isHost&&!t.isRanked?(m(),v("button",{key:0,id:"deleteButton",class:"btn btn-sm btn-outline-danger ms-2",onClick:e[0]||(e[0]=e=>t.deleteMap(e))}," Delete ")):S("",!0)])])])):S("",!0)},Ns.__scopeId="data-v-3038551c";var na=c({components:{BeatmapInfo:Ns,ModalDialog:r,QuestImg:xt,ModesIcons:F},props:{selectedBeatmap:{type:Object,default:()=>({})}},watch:{selectedBeatmap(){this.selectedBeatmap&&this.$route.query.id!==this.selectedBeatmap.id&&this.$router.replace(`/${this.selectedBeatmap.status===H.Secret?"showcase":"beatmaps"}?id=${this.selectedBeatmap.id}`)}}});const da=["href"],ra=h("i",{class:"fas fa-link"},null,-1),ca={key:1},ua=L(" |");na.render=function(t,e,s,a,o,i){const l=u("quest-img"),n=u("user-link"),d=u("modes-icons"),r=u("beatmap-info"),c=u("modal-dialog");return m(),p(c,{id:"editBeatmap",loaded:Boolean(t.selectedBeatmap),"header-class":t.selectedBeatmap?"bg-"+t.selectedBeatmap.status.toLowerCase():""},{header:b((()=>[P(l,{beatmap:t.selectedBeatmap},null,8,["beatmap"]),t.selectedBeatmap.url?(m(),v("a",{key:0,href:t.selectedBeatmap.url,target:"_blank"},[ra,L(" "+y(t.selectedBeatmap.song.artist)+" - "+y(t.selectedBeatmap.song.title),1)],8,da)):(m(),v("span",ca,y(t.selectedBeatmap.song.artist)+" - "+y(t.selectedBeatmap.song.title),1)),ua,P(n,{class:"mx-1",user:t.selectedBeatmap.host},null,8,["user"]),P(d,{modes:[t.selectedBeatmap.mode]},null,8,["modes"])])),default:b((()=>[P(r,{beatmap:t.selectedBeatmap},null,8,["beatmap"])])),_:1},8,["loaded","header-class"])};var ma={namespaced:!0,state:{allBeatmaps:[],userBeatmaps:[],showcaseBeatmaps:[],filterValue:"",filterMode:_.any,filterStatus:"any",filterQuest:"any",selectedBeatmap:null,selectedBeatmapId:null,fetchLimit:30,isLoadingOtherBeatmaps:!0},mutations:{setAllBeatmaps(t,e){t.allBeatmaps=e},setUserBeatmaps(t,e){t.userBeatmaps=e},setShowcaseBeatmaps(t,e){t.showcaseBeatmaps=e},setFilterValue(t,e){t.filterValue=e},setFilterMode(t,e){t.filterMode=e},setFilterStatus(t,e){t.filterStatus=e},setFilterQuest(t,e){t.filterQuest=e},setIsLoadingOtherBeatmaps(t,e){t.isLoadingOtherBeatmaps=e},increaseFetchLimit(t){t.fetchLimit+=50},setSelectedBeatmap(t,e){const s=Object.values(V);e.tasks.sort((function(t,e){return s.indexOf(t.name)-s.indexOf(e.name)})),e.tasksLocked.sort((function(t,e){return s.indexOf(t)-s.indexOf(e)})),t.selectedBeatmap=e},addBeatmap(t,e){e.status===H.Secret?t.showcaseBeatmaps.unshift(e):t.userBeatmaps.unshift(e)},updateBeatmap(t,e){let s=t.allBeatmaps.findIndex((t=>t.id===e.id));-1!==s&&(t.allBeatmaps[s]=e),s=t.userBeatmaps.findIndex((t=>t.id===e.id)),-1!==s&&(t.userBeatmaps[s]=e),s=t.showcaseBeatmaps.findIndex((t=>t.id===e.id)),-1!==s&&(t.showcaseBeatmaps[s]=e)},deleteBeatmap(t,e){let s=t.allBeatmaps.findIndex((t=>t.id===e.id));-1!==s&&t.allBeatmaps.splice(s,1),s=t.userBeatmaps.findIndex((t=>t.id===e.id)),-1!==s&&t.userBeatmaps.splice(s,1),s=t.showcaseBeatmaps.findIndex((t=>t.id===e.id)),-1!==s&&t.showcaseBeatmaps.splice(s,1)}},getters:{filteredUserBeatmaps:t=>{let e=t.userBeatmaps;if(t.filterMode!==_.any){const s=t.filterMode;e=e.filter((t=>t.mode===s||t.mode===j.Hybrid))}if("any"!==t.filterStatus&&(e=e.filter((e=>e.status===t.filterStatus))),"any"!==t.filterQuest&&(e=e.filter((t=>!t.quest))),t.filterValue){const s=t.filterValue.toLowerCase().trim().split(" ").filter((t=>t.length));e=e.filter((t=>{let e=t.song.artist+" "+t.song.title+" "+t.host.username;return t.tasks.forEach((t=>{t.mappers.forEach((t=>{e+=" "+t.username}))})),e=e.toLowerCase(),s.some((t=>e.includes(t)))}))}return e},guestDifficultyBeatmaps:(t,e,s)=>e.filteredUserBeatmaps.filter((t=>{var e;return t.host.id!==(null==(e=s.loggedInUser)?void 0:e.id)})),hostedBeatmaps:(t,e,s)=>e.filteredUserBeatmaps.filter((t=>{var e;return t.host.id===(null==(e=s.loggedInUser)?void 0:e.id)}))},actions:{updateBeatmap({commit:t,state:e},s){var a;t("updateBeatmap",s),(null==(a=e.selectedBeatmap)?void 0:a.id)===s.id&&t("setSelectedBeatmap",s)},async updateFilterMode({commit:t,dispatch:e},s){t("setFilterMode",s),await e("loadOtherBeatmaps")},async updateFilterStatus({commit:t,dispatch:e},s){t("setFilterStatus",s),await e("loadOtherBeatmaps")},async updateFilterQuest({commit:t,dispatch:e},s){t("setFilterQuest",s),await e("loadOtherBeatmaps")},async updateFilterValue({commit:t,dispatch:e},s){t("setFilterValue",s),await e("loadOtherBeatmaps")},async loadOtherBeatmaps({commit:t,state:e}){var s;t("setIsLoadingOtherBeatmaps",!0);const a="any"!==e.filterStatus?`&status=${e.filterStatus}`:"",o="any"!==e.filterQuest?`&quest=${e.filterQuest}`:"",i=e.filterValue?`&search=${e.filterValue}`:"",l=await E.get(`/api/beatmaps/search?mode=${e.filterMode}&limit=${e.fetchLimit+a+o+i}`);(null==(s=l.data)?void 0:s.allBeatmaps)&&t("setAllBeatmaps",l.data.allBeatmaps),t("setIsLoadingOtherBeatmaps",!1)}}};export{Tt as _,Ns as a,Ct as b,xt as c,na as d,R as e,ma as f};
