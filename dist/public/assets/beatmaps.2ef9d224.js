var t=Object.defineProperty,e=Object.defineProperties,s=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,l=(e,s,a)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[s]=a,n=(t,e)=>{for(var s in e||(e={}))o.call(e,s)&&l(t,s,e[s]);if(a)for(var s of a(e))i.call(e,s)&&l(t,s,e[s]);return t},r=(t,a)=>e(t,s(a));import{_ as d}from"./ModalDialog.2baf64cc.js";import{d as c,i as u,o as m,q as p,w as b,f as h,G as k,H as f,b as v,g,t as y,F as w,I as B,J as I,k as C,K as L,p as x,a as $,L as T,e as S,j as P,n as M,N as A,O as q,l as O,m as U,u as Q,h as E}from"./vendor.7edd7468.js";import{B as j,a as H}from"./beatmap.b8797e7f.js";import{T as D,a as V}from"./task.5925ddbb.js";import{_ as F}from"./ModesIcons.0006461b.js";import{_}from"./UserLinkList.cf102be7.js";import{F as N}from"./extras.b9e74742.js";var R=c({name:"CreateBeatmapModal",components:{ModalDialog:d},props:{isSecret:Boolean},data:()=>({featuredArtists:[],featuredSongs:[],selectedArtist:"",selectedSong:"",selectedMode:"osu",checkedTasks:[],checkedLocks:[],modes:[{value:"osu",name:"osu!"},{value:"taiko",name:"osu!taiko"},{value:"catch",name:"osu!catch"},{value:"mania",name:"osu!mania"}],tasks:["Easy","Normal","Hard","Insane","Expert"]}),async created(){const t=await this.$http.executeGet("/featuredArtists/"+(this.isSecret?"showcase":""));t&&(this.featuredArtists=t.sort(((t,e)=>t.label.toLowerCase()>e.label.toLowerCase()?1:e.label.toLowerCase()>t.label.toLowerCase()?-1:0)))},methods:{async setArtist(t){if(!this.selectedArtist)return void this.$store.dispatch("updateToastMessages",{message:"Select an artist!",type:"info"});t.target.disabled=!0;const e=await this.$http.executeGet(`/featuredArtists/${this.selectedArtist}/${this.isSecret?"showcaseSongs":"songs"}`);e&&(this.featuredSongs=e.sort(((t,e)=>t.title.toLowerCase()>e.title.toLowerCase()?1:e.title.toLowerCase()>t.title.toLowerCase()?-1:0))),t.target.disabled=!1},async saveNewMap(t){if(!this.selectedSong)return void this.$store.dispatch("updateToastMessages",{message:"Select a song!",type:"info"});const e=await this.$http.executePost("/beatmaps/create/",{song:this.selectedSong,tasks:this.checkedTasks,tasksLocked:this.checkedLocks,mode:this.selectedMode,status:this.isSecret?"Secret":"WIP"},t);this.$http.isError(e)||(this.$bs.hideModal("addBeatmap"),this.$store.commit("beatmaps/addBeatmap",e))}}});const W={class:"container"},G={class:"mb-3 row"},K=h("div",{class:"col-lg-1"},[h("p",{style:{"margin-top":"3px"}}," Artist: ")],-1),J={class:"col-lg-11"},X={id:"artistForm",class:"input-group input-group-sm mb-3"},z=h("option",{value:"",disabled:""}," Select an artist ",-1),Y=h("option",{value:"-",disabled:""}," --- ",-1),Z=["value"],tt=h("div",{class:"col-lg-1"},[h("p",{style:{"margin-top":"3px"}}," Song: ")],-1),et={class:"col-lg-11"},st=["disabled"],at=h("option",{value:"",disabled:""}," Select an artist to view songs ",-1),ot=h("option",{value:"-",disabled:""}," --- ",-1),it=["value"],lt=h("p",null," Game-mode: ",-1),nt={class:"mb-3 row"},rt={class:"col-sm-10"},dt=["id","value"],ct=["for"],ut=h("br",null,null,-1),mt=h("small",{class:"text-white-50"},"If you want a hybrid mapset, change this later.",-1),pt=h("p",null,[C(" Select one or more difficulties "),h("i",null,"you plan on mapping"),C(". These can be changed later: ")],-1),bt={class:"mb-3 row"},ht={class:"col-sm-10"},kt=["id","value"],ft=["for"],vt=h("p",null,[C(" Select one or more difficulties "),h("i",null,"you don't want anyone else to claim"),C(". These can be changed later: "),h("br"),h("small",{class:"text-white-50"},"For example, if you don't want any guest difficulties, you should mark everything.")],-1),gt={class:"mb-3 row"},yt={class:"col-sm-10"},wt=["id","value"],Bt=["for"],It=h("div",{class:"radial-divisor"},null,-1),Ct=h("small",{class:"text-white-50"},[C("Check the "),h("a",{href:"/faq#rewards",target:"_blank"},"FAQ"),C(" to ensure your beatmap is elligible for points.")],-1);function Lt(t,e,s){const a={class:["px-1","text-"+e.toLowerCase()]};return s&&(a["data-bs-toggle"]="tooltip",a["data-bs-placement"]="top",a.title=s),L("span",a,t)}R.render=function(t,e,s,a,o,i){const l=u("modal-dialog");return m(),p(l,{id:"addBeatmap",title:"Add beatmap"},{default:b((()=>[h("div",W,[h("div",G,[K,h("div",J,[h("div",X,[k(h("select",{"onUpdate:modelValue":e[0]||(e[0]=e=>t.selectedArtist=e),class:"form-select"},[z,Y,(m(!0),v(w,null,g(t.featuredArtists,(t=>(m(),v("option",{key:t.id,value:t.id},y(t.label),9,Z)))),128))],512),[[f,t.selectedArtist]]),h("button",{id:"artistButton",class:"btn btn-outline-info",onClick:e[1]||(e[1]=e=>t.setArtist(e))}," Load songs ")])]),tt,h("div",et,[k(h("select",{"onUpdate:modelValue":e[2]||(e[2]=e=>t.selectedSong=e),class:"form-select form-select-sm",disabled:!t.featuredSongs.length},[at,ot,(m(!0),v(w,null,g(t.featuredSongs,(t=>(m(),v("option",{key:t.id,value:t.id},y(t.title)+" --- ("+y(t.artist)+") ",9,it)))),128))],8,st),[[f,t.selectedSong]])])]),lt,h("div",nt,[h("div",rt,[(m(!0),v(w,null,g(t.modes,(s=>(m(),v("div",{key:s.value,class:"form-check form-check-inline"},[k(h("input",{id:s.value,"onUpdate:modelValue":e[3]||(e[3]=e=>t.selectedMode=e),class:"form-check-input",type:"radio",value:s.value},null,8,dt),[[B,t.selectedMode]]),h("label",{class:"form-check-label",for:s.value},y(s.name),9,ct)])))),128)),ut,mt])]),pt,h("div",bt,[h("div",ht,[(m(!0),v(w,null,g(t.tasks,(s=>(m(),v("div",{key:s,class:"form-check"},[k(h("input",{id:s,"onUpdate:modelValue":e[4]||(e[4]=e=>t.checkedTasks=e),class:"form-check-input",type:"checkbox",value:s},null,8,kt),[[I,t.checkedTasks]]),h("label",{class:"form-check-label",for:s},y(s),9,ft)])))),128))])]),vt,h("div",gt,[h("div",yt,[(m(!0),v(w,null,g(t.tasks,(s=>(m(),v("div",{key:s,class:"form-check"},[k(h("input",{id:`lock-${s}`,"onUpdate:modelValue":e[5]||(e[5]=e=>t.checkedLocks=e),class:"form-check-input",type:"checkbox",value:s},null,8,wt),[[I,t.checkedLocks]]),h("label",{class:"form-check-label",for:`lock-${s}`},y(s),9,Bt)])))),128))])])]),It,h("button",{type:"submit",class:"btn btn-outline-success w-100",onClick:e[6]||(e[6]=e=>t.saveNewMap(e))}," Save "),Ct])),_:1})};var xt=c({props:{tasks:{type:Array,required:!0},tasksLocked:{type:Array,required:!0},mode:{type:String,required:!0}},render(){const t=[{name:"Storyboard",short:"SB",locked:!1,status:[]},{name:"Easy",short:"E",locked:!1,status:[]},{name:"Normal",short:"N",locked:!1,status:[]},{name:"Hard",short:"H",locked:!1,status:[]},{name:"Insane",short:"I",locked:!1,status:[]},{name:"Expert",short:"X",locked:!1,status:[]}],e=[{name:"osu",short:"circle",count:0,status:D.Done},{name:"taiko",short:"drum",count:0,status:D.Done},{name:"catch",short:"apple-alt",count:0,status:D.Done},{name:"mania",short:"stream",count:0,status:D.Done}],s=[],a=this.tasks.length>=10,o=this.mode===j.Hybrid;for(const i of t){let t=!1;const l=this.tasksLocked.includes(i.name);for(const s of this.tasks)if(i.name===s.name){i.status.push(s.status),t=!0;const a=e.findIndex((t=>t.name===s.mode));-1!==a&&(e[a].count++,s.status===D.WIP&&(e[a].status=D.WIP))}if(!o){if(a&&i.status.length>1)s.push(Lt(i.short+"+","secondary",i.status.length.toString()));else for(const t of i.status)s.push(Lt(i.short,t));t||s.push(Lt(i.short,l?"blocked":"open"))}}if(o)for(const i of e)s.push(Lt([L("i",{class:["fas","fa-"+i.short]})],i.count?i.status:"blocked",i.count.toString()));return L("span",{class:"fw-bold"},s)}}),$t=c({props:{beatmap:{type:Object,required:!0}},computed:{url(){var t;return this.beatmap.isShowcase||!(null==(t=this.beatmap.quest)?void 0:t.art)?"/images/no-art-icon.png":this.beatmap.quest.isMbc?"/images/mbc-icon.png":`https://assets.ppy.sh/artists/${this.beatmap.quest.art}/cover.jpg`}}});x("data-v-5218fee0");const Tt=["src"];$(),$t.render=function(t,e,s,a,o,i){const l=T("bs-tooltip");return t.beatmap.quest||t.beatmap.isShowcase?k((m(),v("img",{key:0,class:"rounded-circle me-1 quest-icon",src:t.url},null,8,Tt)),[[l,t.beatmap.quest&&t.beatmap.quest.name||"FA showcase"]]):S("",!0)},$t.__scopeId="data-v-5218fee0";var St=c({name:"BeatmapCard",components:{ProcessTasks:xt,QuestImg:$t,ModesIcons:F},props:{beatmap:{type:Object,required:!0}},emits:["update:selectedBeatmap"],data:()=>({defaultUrl:"https://osu.ppy.sh/images/layout/beatmaps/default-bg.png"}),computed:{statusBorder(){return this.beatmap.status?"card-status-"+this.beatmap.status.toLowerCase():""}},methods:{fallbackImage(t){t.target.src=this.defaultUrl},formatMetadata(t,e){const s=t+" - "+e;return s.length>34?s.slice(0,34)+"...":s},processUrl(t){if(t&&-1!==t.indexOf("osu.ppy.sh/beatmapsets/")){const e=t.indexOf("beatmapsets/")+"beatmapsets/".length,s=t.indexOf("#");let a;return a=-1!==s?t.slice(e,s):t.slice(e),`https://assets.ppy.sh/beatmaps/${a}/covers/card.jpg`}return this.defaultUrl}}});x("data-v-c6fa65f0");const Pt=["src"],Mt={class:"card-img-overlay",style:{padding:"0.50rem 0.50rem 0 0.50rem"}},At={class:"card-title mb-1"},qt={class:"card-text"},Ot=C(" Hosted by ");$(),St.render=function(t,e,s,a,o,i){const l=u("quest-img"),n=u("user-link"),r=u("modes-icons"),d=u("process-tasks");return m(),v("div",{class:"my-2 col-sm-12 col-md-6 col-lg-4",onClick:e[1]||(e[1]=e=>t.$emit("update:selectedBeatmap",t.beatmap))},[h("div",{class:M(["card card-hover map-card bg-dark",t.statusBorder]),"data-bs-toggle":"modal","data-bs-target":"#editBeatmap"},[h("img",{class:"card-img",src:t.processUrl(t.beatmap.url),style:{opacity:"0.2"},onError:e[0]||(e[0]=e=>t.fallbackImage(e))},null,40,Pt),h("div",Mt,[h("p",At,y(t.formatMetadata(t.beatmap.song.artist,t.beatmap.song.title)),1),h("small",qt,[P(l,{beatmap:t.beatmap},null,8,["beatmap"]),Ot,P(n,{class:"me-1",user:t.beatmap.host},null,8,["user"]),"osu"!==t.beatmap.mode?(m(),p(r,{key:0,modes:[t.beatmap.mode]},null,8,["modes"])):S("",!0),P(d,{class:"float-end pt-1",tasks:t.beatmap.tasks,"tasks-locked":t.beatmap.tasksLocked,mode:t.beatmap.mode},null,8,["tasks","tasks-locked","mode"])])])],2)])},St.__scopeId="data-v-c6fa65f0";var Ut=c({name:"ModeChoice",props:{beatmap:{type:Object,required:!0}},methods:{async setMode(t,e,s){const a=await this.$http.executePost(`/beatmaps/${t}/setMode`,{mode:e},s);this.$http.isError(a)||this.$store.dispatch("beatmaps/updateBeatmap",a)}}});x("data-v-1895db98");const Qt={id:"mode",class:"mb-3"},Et=h("div",{class:"d-inline-block me-2"}," Mode ",-1),jt=["disabled"],Ht=[h("i",{class:"far fa-circle"},null,-1)],Dt=["disabled"],Vt=[h("i",{class:"fas fa-drum"},null,-1)],Ft=["disabled"],_t=[h("i",{class:"fas fa-apple-alt"},null,-1)],Nt=["disabled"],Rt=[h("i",{class:"fas fa-stream"},null,-1)],Wt=["disabled"],Gt=[h("i",{class:"fas fa-check-double"},null,-1)];$(),Ut.render=function(t,e,s,a,o,i){const l=T("bs-tooltip");return m(),v("div",Qt,[Et,k(h("button",{class:M(["btn btn-sm rounded-100 me-1","osu"==t.beatmap.mode?"btn-info":"btn-outline-info"]),disabled:"osu"==t.beatmap.mode,onClick:e[0]||(e[0]=e=>t.setMode(t.beatmap.id,"osu",e))},Ht,10,jt),[[l,"osu!"]]),k(h("button",{class:M(["btn btn-sm rounded-100 me-1","taiko"==t.beatmap.mode?"btn-info":"btn-outline-info"]),disabled:"taiko"==t.beatmap.mode,onClick:e[1]||(e[1]=e=>t.setMode(t.beatmap.id,"taiko",e))},Vt,10,Dt),[[l,"osu!taiko"]]),k(h("button",{class:M(["btn btn-sm rounded-100 me-1","catch"==t.beatmap.mode?"btn-info":"btn-outline-info"]),disabled:"catch"==t.beatmap.mode,onClick:e[2]||(e[2]=e=>t.setMode(t.beatmap.id,"catch",e))},_t,10,Ft),[[l,"osu!catch"]]),k(h("button",{class:M(["btn btn-sm rounded-100 me-1","mania"==t.beatmap.mode?"btn-info":"btn-outline-info"]),disabled:"mania"==t.beatmap.mode,onClick:e[3]||(e[3]=e=>t.setMode(t.beatmap.id,"mania",e))},Rt,10,Nt),[[l,"osu!mania"]]),k(h("button",{class:M(["btn btn-sm rounded-100 me-1","hybrid"==t.beatmap.mode?"btn-info":"btn-outline-info"]),disabled:"hybrid"==t.beatmap.mode,onClick:e[4]||(e[4]=e=>t.setMode(t.beatmap.id,"hybrid",e))},Gt,10,Wt),[[l,"multiple modes"]])])},Ut.__scopeId="data-v-1895db98";var Kt=c({name:"StatusChoice",props:{beatmap:{type:Object,required:!0}},methods:{async setStatus(t,e){const s=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/setStatus`,{status:t},e);this.$http.isError(s)||this.$store.dispatch("beatmaps/updateBeatmap",s)}}});const Jt={id:"mapsetStatus",class:"mb-3"},Xt=h("div",{class:"d-inline-block me-2"}," Status ",-1),zt=["disabled"],Yt=[C(" Done ")],Zt=["disabled"],te=[C(" WIP ")];Kt.render=function(t,e,s,a,o,i){const l=T("bs-tooltip");return m(),v("div",Jt,[Xt,k(h("button",{class:M(["btn btn-sm me-1","Done"==t.beatmap.status?"btn-success":"btn-outline-success"]),disabled:"Done"==t.beatmap.status,onClick:e[0]||(e[0]=e=>t.setStatus("Done",e))},Yt,10,zt),[[l,"mark mapset and all diffs as done","bottom"]]),k(h("button",{class:M(["btn btn-sm me-1","WIP"==t.beatmap.status?"btn-warning":"btn-outline-warning"]),disabled:"WIP"==t.beatmap.status,onClick:e[1]||(e[1]=e=>t.setStatus("WIP",e))},te,10,Zt),[[l,"mark mapset as work-in-progress","bottom"]])])};var ee=c({name:"NewTask",props:{isHost:Boolean,taskToAddCollaborator:{type:Object,default:null},beatmap:{type:Object,required:!0}},emits:["update:taskToAddCollaborator"],data:()=>({selectedTask:V.Easy,selectedMode:j.Osu,requestTaskUsername:""}),computed:{remainingTasks(){let t=Object.values(V);return this.beatmap.tasksLocked&&this.beatmap.tasksLocked.length&&!this.isHost&&(t=t.filter((t=>!this.beatmap.tasksLocked.includes(t)))),this.selectedTask=t[0]||"",t}},methods:{async addTask(t,e){if(this.requestTaskUsername&&this.requestTaskUsername.length)return void this.requestTask(t,e);let s;s=this.beatmap.mode==j.Hybrid?this.selectedMode:this.beatmap.mode;const a=await this.$http.executePost("/beatmaps/addTask/"+t,{taskName:this.selectedTask,mode:s},e);this.$http.isError(a)||this.$store.dispatch("beatmaps/updateBeatmap",a)},async requestTask(t,e){let s;s=this.beatmap.mode==j.Hybrid?this.selectedMode:this.beatmap.mode;const a=await this.$http.executePost("/beatmaps/requestTask/"+t,{taskName:this.selectedTask,user:this.requestTaskUsername,mode:s},e);this.$http.isError(a)||(this.$store.dispatch("beatmaps/updateBeatmap",a),this.$store.dispatch("updateToastMessages",{message:"Difficulty request sent!",type:"success"}))},async addCollab(t){let e;e=this.beatmap.mode==j.Hybrid?this.taskToAddCollaborator.mode:this.beatmap.mode;const s=await this.$http.executePost("/beatmaps/task/"+this.taskToAddCollaborator.id+"/addCollab",{user:this.requestTaskUsername,taskName:this.taskToAddCollaborator.name,mode:e},t);this.$http.isError(s)||(this.$store.dispatch("beatmaps/updateBeatmap",s),this.$store.dispatch("updateToastMessages",{message:"Collab invite sent!",type:"success"}))}}});const se={key:0,class:"row mt-2 mb-3"},ae={class:"col-sm-12"},oe={class:"input-group input-group-sm mx-auto"},ie=["value"],le=[h("option",{value:"osu"}," osu! ",-1),h("option",{value:"taiko"}," osu!taiko ",-1),h("option",{value:"catch"}," osu!catch ",-1),h("option",{value:"mania"}," osu!mania ",-1)],ne=[h("i",{class:"fas fa-plus"},null,-1)],re={key:0,class:"col-sm-12 mt-1 text-center"},de=C(" Adding collaborator for the selected difficulty "),ce=[h("i",{class:"fas fa-times-circle"},null,-1)];ee.render=function(t,e,s,a,o,i){const l=T("bs-tooltip");return"WIP"!=t.beatmap.status&&"Secret"!=t.beatmap.status||!t.remainingTasks.length?S("",!0):(m(),v("div",se,[h("div",ae,[h("div",oe,[t.taskToAddCollaborator?S("",!0):k((m(),v("select",{key:0,"onUpdate:modelValue":e[0]||(e[0]=e=>t.selectedTask=e),class:"form-select"},[(m(!0),v(w,null,g(t.remainingTasks,(t=>(m(),v("option",{key:t,value:t},y(t),9,ie)))),128))],512)),[[f,t.selectedTask]]),"hybrid"!=t.beatmap.mode||t.taskToAddCollaborator?S("",!0):k((m(),v("select",{key:1,"onUpdate:modelValue":e[1]||(e[1]=e=>t.selectedMode=e),class:"form-select"},le,512)),[[f,t.selectedMode]]),t.isHost||t.taskToAddCollaborator?k((m(),v("input",{key:2,"onUpdate:modelValue":e[2]||(e[2]=e=>t.requestTaskUsername=e),class:"form-control",type:"text",placeholder:"request to... (optional)",maxlength:"18",onKeyup:e[3]||(e[3]=q((e=>t.taskToAddCollaborator?t.addCollab(e):t.requestTask(t.beatmap.id,e)),["enter"]))},null,544)),[[A,t.requestTaskUsername]]):S("",!0),k(h("button",{class:"btn btn-outline-info",onClick:e[4]||(e[4]=e=>t.taskToAddCollaborator?t.addCollab(e):t.addTask(t.beatmap.id,e))},ne,512),[[l,"add difficulty"]])])]),t.taskToAddCollaborator?(m(),v("div",re,[h("small",null,[de,h("a",{class:"text-danger",href:"#",onClick:e[5]||(e[5]=O((e=>t.$emit("update:taskToAddCollaborator",null)),["prevent"]))},ce)])])):S("",!0)]))};var ue=c({name:"TasksChoice",components:{NewTask:ee,ModesIcons:F},props:{beatmap:{type:Object,required:!0},isHost:Boolean,isRanked:Boolean,isQualified:Boolean},data:()=>({taskToAddCollaborator:null}),computed:r(n({},U(["loggedInUser"])),{sortedTasks(){const t=["Easy","Normal","Hard","Insane","Expert","Storyboard"],e=["osu","taiko","catch","mania","sb"];return[...this.beatmap.tasks].sort((function(e,s){return t.indexOf(e.name)-t.indexOf(s.name)})).sort((function(t,s){return e.indexOf(t.mode)-e.indexOf(s.mode)}))}}),methods:{isOwner(t){return t.some((t=>t.osuId==this.loggedInUser.osuId))},canEditTask(t){return this.isOwner(t.mappers)||this.isHost},async setTaskStatus(t,e,s){s.target.classList.add("fake-button-disable");const a=await this.$http.executePost("/beatmaps/setTaskStatus/"+t,{status:e});this.$http.isError(a)||this.$store.dispatch("beatmaps/updateBeatmap",a),s.target.classList.remove("fake-button-disable")},async removeTask(t,e){e.target.classList.add("fake-button-disable");const s=await this.$http.executePost("/beatmaps/removeTask/"+t,{beatmapId:this.beatmap.id});this.$http.isError(s)||this.$store.dispatch("beatmaps/updateBeatmap",s),e.target.classList.remove("fake-button-disable")},canEditTaskCollaborators(t){return"Done"!=t.status&&!this.isQualified&&"Done"!=this.beatmap.status&&this.isOwner(t.mappers)},async removeCollab(t,e,s){s.target.classList.add("fake-button-disable");const a=await this.$http.executePost("/beatmaps/task/"+t+"/removeCollab",{user:e});this.$http.isError(a)||this.$store.dispatch("beatmaps/updateBeatmap",a),s.target.classList.remove("fake-button-disable")},isAddingCollaborator(t){var e;return(null==(e=this.taskToAddCollaborator)?void 0:e.id)==t.id}}});const me={class:"row"},pe={class:"col-sm-12"},be={class:"table table-sm"},he=h("th",null,"Difficulty",-1),ke=h("th",null,"Mapper(s)",-1),fe={key:0},ve=["id"],ge=[h("i",{class:"fas fa-times"},null,-1)],ye=["onClick"],we=[h("i",{class:"fas fa-plus"},null,-1)],Be=["onClick"],Ie=[h("i",{class:"fas fa-minus"},null,-1)],Ce={key:0},Le=["onClick"],xe=[h("i",{class:"fas fa-minus"},null,-1)],$e=["onClick"],Te=[h("i",{class:"fas fa-check"},null,-1)],Se=["onClick"],Pe=[h("i",{class:"fas fa-ellipsis-h"},null,-1)],Me={key:0,class:"col-sm-12 mt-2"};ue.render=function(t,e,s,a,o,i){const l=u("modes-icons"),n=u("user-link"),r=u("new-task"),d=T("bs-tooltip");return m(),v("div",me,[h("div",pe,[h("table",be,[h("thead",null,[h("tr",null,[he,ke,t.isRanked||t.isQualified?S("",!0):(m(),v("th",fe))])]),P(Q,{tag:"tbody",name:"list"},{default:b((()=>[(m(!0),v(w,null,g(t.sortedTasks,(s=>(m(),v("tr",{id:s.id+"Row",key:s.id},[h("td",{class:M(["text-white-50",`card-status-${s.status.toLowerCase()}`])},[C(y(s.name)+" ",1),"hybrid"==t.beatmap.mode?(m(),p(l,{key:0,modes:[s.mode]},null,8,["modes"])):S("",!0)],2),h("td",null,[(m(!0),v(w,null,g(s.mappers,((a,o)=>(m(),v("div",{key:a.id},[0==o&&t.canEditTaskCollaborators(s)?(m(),v(w,{key:0},[t.isAddingCollaborator(s)?k((m(),v("a",{key:0,href:"#",class:"text-danger",onClick:e[0]||(e[0]=O((e=>t.taskToAddCollaborator=null),["prevent"]))},ge,512)),[[d,"cancel"]]):k((m(),v("a",{key:1,href:"#",class:"text-success",onClick:O((e=>t.taskToAddCollaborator=s),["prevent"])},we,8,ye)),[[d,"invite new collaborator"]])],64)):S("",!0),P(n,{class:"mx-1",user:a},null,8,["user"]),s.mappers.length>1&&t.canEditTaskCollaborators(s)&&a.osuId!=t.loggedInUser.osuId?k((m(),v("a",{key:1,href:"#",class:"text-danger",onClick:O((e=>t.removeCollab(s.id,a.id,e)),["prevent"])},Ie,8,Be)),[[d,"remove collaborator"]]):S("",!0)])))),128))]),t.isRanked||t.isQualified?S("",!0):(m(),v("td",Ce,[t.canEditTask(s)?(m(),v(w,{key:0},[k(h("a",{href:"#",class:"text-danger me-1",onClick:O((e=>t.removeTask(s.id,e)),["prevent"])},xe,8,Le),[[d,"delete"]]),"WIP"==s.status?k((m(),v("a",{key:0,href:"#",class:"text-success me-1",onClick:O((e=>t.setTaskStatus(s.id,"Done",e)),["prevent"])},Te,8,$e)),[[d,"mark as done"]]):S("",!0),"Done"==s.status&&"Done"!=t.beatmap.status?k((m(),v("a",{key:1,href:"#",class:"text-wip me-1",onClick:O((e=>t.setTaskStatus(s.id,"WIP",e)),["prevent"])},Pe,8,Se)),[[d,"mark as WIP"]]):S("",!0)],64)):S("",!0)]))],8,ve)))),128))])),_:1})])]),t.isRanked||t.isQualified?S("",!0):(m(),v("div",Me,[P(r,{"task-to-add-collaborator":t.taskToAddCollaborator,"onUpdate:task-to-add-collaborator":e[1]||(e[1]=e=>t.taskToAddCollaborator=e),beatmap:t.beatmap,"is-host":t.isHost},null,8,["task-to-add-collaborator","beatmap","is-host"])]))])};var Ae=c({name:"QuestChoice",props:{beatmap:{type:Object,required:!0}},data:()=>({userQuests:[],showQuestInput:!1,dropdownQuestId:""}),computed:U(["loggedInUser"]),watch:{beatmap(){var t;this.showQuestInput=!1,this.dropdownQuestId=(null==(t=this.beatmap.quest)?void 0:t.id)||""}},async created(){const t=await this.$http.executeGet(`/users/${this.loggedInUser.id}/quests`);this.$http.isError(t)||(this.userQuests=t)},methods:{async linkQuest(t){const e=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/linkQuest`,{questId:this.dropdownQuestId},t);this.$http.isError(e)||this.$store.dispatch("beatmaps/updateBeatmap",e)}}});const qe={class:"row mb-2"},Oe={class:"col"},Ue=C(" Quest "),Qe=[h("i",{class:"fas fa-edit"},null,-1)],Ee={class:"small ms-3 text-white-50"},je={key:0},He={key:1},De={key:0,class:"row mb-2"},Ve={class:"col"},Fe={class:"input-group input-group-sm"},_e=h("option",{value:""}," No quest ",-1),Ne=["value"],Re=[C(" Save ")];Ae.render=function(t,e,s,a,o,i){const l=T("bs-tooltip");return m(),v("div",null,[h("div",qe,[h("div",Oe,[h("div",null,[Ue,k(h("a",{id:"editLink",href:"#",class:M([t.showQuestInput?"text-danger":"","text-success small ms-1"]),onClick:e[0]||(e[0]=O((e=>t.showQuestInput=!t.showQuestInput),["prevent"]))},Qe,2),[[l,"connect mapset with a quest","right"]])]),h("div",Ee,[t.beatmap.quest?(m(),v("span",je,y(t.beatmap.quest.name),1)):(m(),v("i",He,"none"))])])]),t.showQuestInput?(m(),v("div",De,[h("div",Ve,[h("div",Fe,[k(h("select",{"onUpdate:modelValue":e[1]||(e[1]=e=>t.dropdownQuestId=e),class:"form-select"},[_e,(m(!0),v(w,null,g(t.userQuests,(t=>(m(),v("option",{key:t.id,value:t.id},y(t.name),9,Ne)))),128))],512),[[f,t.dropdownQuestId]]),k(h("button",{class:"btn btn-outline-info",onClick:e[2]||(e[2]=e=>t.linkQuest(e))},Re,512),[[l,"link beatmap to quest"]])])])])):S("",!0)])};var We=c({name:"ModdersList",components:{UserLinkList:_},props:{canEdit:Boolean,beatmap:{type:Object,required:!0}},computed:r(n({},U(["loggedInUser"])),{isModder(){return this.beatmap.modders.some((t=>t.osuId==this.loggedInUser.osuId))}}),methods:{async updateModder(t){t.target.classList.add("fake-button-disable");const e=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/updateModder`);this.$http.isError(e)||this.$store.dispatch("beatmaps/updateBeatmap",e),t.target.classList.remove("fake-button-disable")}}});const Ge={id:"modders",class:"row mb-2"},Ke={class:"col"},Je={key:0,class:"ms-1"},Xe={class:"small ms-3"},ze={key:0,class:"text-white-50"};We.render=function(t,e,s,a,o,i){const l=u("user-link-list"),n=T("bs-tooltip");return m(),v("div",Ge,[h("div",Ke,[h("div",null,[C(" Modders ("+y(t.beatmap.modders.length)+") ",1),t.canEdit?k((m(),v("small",Je,[h("a",{href:"#",class:M(t.isModder?"text-danger":"text-success"),onClick:e[0]||(e[0]=O((e=>t.updateModder(e)),["prevent"]))},[h("i",{class:M(["fas",t.isModder?"fa-minus":"fa-plus"])},null,2)],2)],512)),[[n,"add/remove yourself from modder list","right"]]):S("",!0)]),h("div",Xe,[0==t.beatmap.modders.length?(m(),v("i",ze," none ")):(m(),p(l,{key:1,users:t.beatmap.modders},null,8,["users"]))])])])};var Ye=c({name:"NominatorsList",components:{UserLinkList:_},props:{canEdit:Boolean,beatmap:{type:Object,required:!0}},computed:r(n({},U(["loggedInUser"])),{isBn(){return this.beatmap.bns.some((t=>t.osuId==this.loggedInUser.osuId))}}),methods:{async updateBn(t){t.target.classList.add("fake-button-disable");const e=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/updateBn`);this.$http.isError(e)||this.$store.dispatch("beatmaps/updateBeatmap",e),t.target.classList.remove("fake-button-disable")}}});const Ze={key:0,class:"ms-1"},ts=[h("i",{class:"fas fa-minus"},null,-1)],es=[h("i",{class:"fas fa-plus"},null,-1)],ss={class:"small ms-3"},as={key:0,class:"text-white-50"};Ye.render=function(t,e,s,a,o,i){const l=u("user-link-list"),n=T("bs-tooltip");return m(),v("div",null,[h("div",null,[C(" Potential Nominators ("+y(t.beatmap.bns.length)+") ",1),t.canEdit?k((m(),v("small",Ze,[t.isBn?(m(),v("a",{key:0,href:"#",class:"text-danger",onClick:e[0]||(e[0]=O((e=>t.updateBn(e)),["prevent"]))},ts)):S("",!0),!t.isBn&&t.beatmap.bns.length<2?(m(),v("a",{key:1,href:"#",class:"text-success",onClick:e[1]||(e[1]=O((e=>t.updateBn(e)),["prevent"]))},es)):S("",!0)],512)),[[n,"add/remove yourself from potential BN list","right"]]):S("",!0)]),h("div",ss,[0==t.beatmap.bns.length?(m(),v("i",as,"none")):(m(),p(l,{key:1,users:t.beatmap.bns},null,8,["users"]))])])};var os=c({name:"BeatmapLink",props:{beatmap:{type:Object,required:!0}},data:()=>({url:"",showLinkInput:!1}),watch:{beatmap(t){t&&(this.showLinkInput=!1,this.url=t.url)}},created(){this.url=this.beatmap.url},methods:{async saveLink(t){const e=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/setLink`,{url:this.url},t);this.$http.isError(e)||(this.showLinkInput=!1,this.$store.dispatch("beatmaps/updateBeatmap",e))}}});const is={class:"row mb-2"},ls={class:"col"},ns=C(" Link "),rs=[h("i",{class:"fas fa-edit"},null,-1)],ds={class:"small ms-3"},cs=["href"],us={key:1,class:"text-white-50"},ms={key:0,class:"row mb-2"},ps={class:"col-sm-12"},bs={class:"input-group input-group-sm"},hs=[C(" Save ")];os.render=function(t,e,s,a,o,i){const l=T("bs-tooltip");return m(),v("div",null,[h("div",is,[h("div",ls,[h("div",null,[ns,k(h("a",{id:"editLink",href:"#",class:M(["text-success small ms-1",{"text-danger":t.showLinkInput}]),onClick:e[0]||(e[0]=O((e=>t.showLinkInput=!t.showLinkInput),["prevent"]))},rs,2),[[l,"edit link","right"]])]),h("div",ds,[t.beatmap.url?(m(),v("a",{key:0,href:t.beatmap.url,target:"_blank"},y(t.beatmap.url),9,cs)):(m(),v("i",us,"none"))])])]),t.showLinkInput?(m(),v("div",ms,[h("div",ps,[h("div",bs,[k(h("input",{"onUpdate:modelValue":e[1]||(e[1]=e=>t.url=e),class:"form-control form-control-sm",type:"text",placeholder:"URL",onKeyup:e[2]||(e[2]=q((e=>t.saveLink(e)),["enter"]))},null,544),[[A,t.url]]),k(h("button",{id:"addLinkButton",class:"btn btn-outline-info",type:"submit",onClick:e[3]||(e[3]=e=>t.saveLink(e))},hs,512),[[l,"use new osu!web link for card image","right"]])])])])):S("",!0)])};var ks=c({name:"LocksChoice",props:{beatmap:{type:Object,required:!0}},data:()=>({lockTaskSelection:"",showLocksInput:!1}),computed:{remainingTasks(){var t,e;let s=Object.values(V);return(null==(e=null==(t=this.beatmap)?void 0:t.tasksLocked)?void 0:e.length)&&(s=s.filter((t=>!this.beatmap.tasksLocked.includes(t)))),this.lockTaskSelection=s[0]||"",s}},watch:{beatmap(){this.showLocksInput=!1}},methods:{async unlockTask(t,e){e.target.classList.add("fake-button-disable");const s=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/unlockTask`,{task:t});this.$http.isError(s)||this.$store.dispatch("beatmaps/updateBeatmap",s),e.target.classList.remove("fake-button-disable")},async lockTask(t){const e=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/lockTask`,{task:this.lockTaskSelection},t);this.$http.isError(e)||this.$store.dispatch("beatmaps/updateBeatmap",e)}}});const fs={id:"locks",class:"row mb-1"},vs={class:"col"},gs=C(" Locks "),ys=[h("i",{class:"fas fa-edit"},null,-1)],ws={class:"small ms-3"},Bs={key:0},Is={key:1},Cs=["onClick"],Ls=[h("i",{class:"fas fa-minus"},null,-1)],xs={class:"text-white-50 mx-1"},$s={key:0,class:"row"},Ts={class:"col"},Ss={class:"input-group input-group-sm"},Ps=["value"],Ms=[h("i",{class:"fas fa-lock"},null,-1)];ks.render=function(t,e,s,a,o,i){const l=T("bs-tooltip");return m(),v("div",null,[h("div",fs,[h("div",vs,[h("div",null,[gs,6!=t.beatmap.tasksLocked.length?(m(),v("a",{key:0,class:"text-success small ms-1",href:"#",onClick:e[0]||(e[0]=O((e=>t.showLocksInput=!t.showLocksInput),["prevent"]))},ys)):S("",!0)]),h("div",ws,[0==t.beatmap.tasksLocked.length?(m(),v("i",Bs,"none")):S("",!0),t.beatmap.tasksLocked.length>0?(m(),v("div",Is,[(m(!0),v(w,null,g(t.beatmap.tasksLocked,(e=>(m(),v("div",{key:e},[k(h("a",{href:"#",class:"text-danger",onClick:O((s=>t.unlockTask(e,s)),["prevent"])},Ls,8,Cs),[[l,"unlock","left"]]),h("span",xs,y(e),1)])))),128))])):S("",!0)])])]),t.showLocksInput?(m(),v("div",$s,[h("div",Ts,[h("div",Ss,[k(h("select",{"onUpdate:modelValue":e[1]||(e[1]=e=>t.lockTaskSelection=e),class:"form-select"},[(m(!0),v(w,null,g(t.remainingTasks,(t=>(m(),v("option",{key:t,value:t},y(t),9,Ps)))),128))],512),[[f,t.lockTaskSelection]]),k(h("button",{id:"lockTask",class:"btn btn-outline-info",onClick:e[2]||(e[2]=e=>t.lockTask(e))},Ms,512),[[l,"prevent other mappers from claiming a difficulty","right"]])])])])):S("",!0)])};var As=c({name:"Points",props:{beatmap:{type:Object,required:!0}},data:()=>({tasksPointsArray:null,usersPointsArrays:null,pointsInfo:null,totalPoints:null,isLoading:!1}),watch:{beatmap(){this.tasksPointsArray=null,this.usersPointsArrays=null,this.pointsInfo=null,this.totalPoints=null,this.isLoading=!1}},methods:{async findPoints(t){this.isLoading=!0;const e=await this.$http.executeGet(`/beatmaps/${this.beatmap.id}/findPoints`,t);this.$http.isError(e)||(this.tasksPointsArray=e.tasksPointsArray,this.usersPointsArrays=e.usersPointsArrays,this.pointsInfo=e.pointsInfo,this.totalPoints=e.totalPoints),this.isLoading=!1}}});const qs={class:"row"},Os={class:"col-sm-12"},Us=[C(" Calculate points ")],Qs={key:1,class:"small text-white-50 ms-2"},Es={key:2,class:"small text-white-50 ms-2"},js={key:0,class:"col-sm-6"},Hs={class:"small text-white-50"},Ds={class:"col-sm-6"},Vs={key:0,class:"small text-white-50"},Fs={key:1,class:"col-sm-12"},_s={class:"small text-white-50 ms-2"};As.render=function(t,e,s,a,o,i){const l=T("bs-tooltip");return m(),v("div",null,[h("div",qs,[h("div",Os,[t.tasksPointsArray?S("",!0):k((m(),v("button",{key:0,class:"btn btn-sm btn-outline-info ms-1",onClick:e[0]||(e[0]=e=>t.findPoints(e))},Us,512)),[[l,"calculate points for all difficulties"]]),t.isLoading?(m(),v("span",Qs," calculating... ")):t.pointsInfo?(m(),v("span",Es,y(t.pointsInfo),1)):S("",!0)]),t.tasksPointsArray?(m(),v("div",js,[h("ul",Hs,[(m(!0),v(w,null,g(t.tasksPointsArray,((t,e)=>(m(),v("li",{key:e},y(t),1)))),128))])])):S("",!0),h("div",Ds,[t.usersPointsArrays?(m(),v("ul",Vs,[(m(!0),v(w,null,g(t.usersPointsArrays,((e,s)=>(m(),v("li",{key:s},y(t.usersPointsArrays[s][0])+": "+y(t.usersPointsArrays[s][1]),1)))),128))])):S("",!0)]),t.totalPoints?(m(),v("div",Fs,[h("span",_s," total: "+y(Math.round(10*t.totalPoints)/10),1)])):S("",!0)])])};var Ns=c({name:"BeatmapInfo",components:{ModeChoice:Ut,StatusChoice:Kt,TasksChoice:ue,QuestChoice:Ae,ModdersList:We,NominatorsList:Ye,BeatmapLink:os,LocksChoice:ks,Points:As},props:{beatmap:{type:Object,required:!0}},data:()=>({userQuests:null}),computed:r(n({},U(["loggedInUser"])),{isHost(){return!(!this.loggedInUser.id||!this.beatmap)&&this.loggedInUser.id===this.beatmap.host.id},isRanked(){return this.beatmap.status===H.Ranked},isQualified(){return this.beatmap.status===H.Qualified}}),methods:{async deleteMap(t){if(confirm("Are you sure you want to delete?")){t.target.disabled=!0;const e=await this.$http.executePost(`/beatmaps/${this.beatmap.id}/delete`,{},t);this.$http.isError(e)||(this.$bs.hideModal("editBeatmap"),this.$store.commit("beatmaps/deleteBeatmap",e)),t.target.disabled=!1}}}});x("data-v-4a387e91");const Rs={key:0,class:"container"},Ws={class:"row"},Gs={class:"row mb-2"},Ks={class:"col-sm-6"},Js={key:0,id:"bns",class:"col-sm-6"},Xs=h("hr",null,null,-1),zs={class:"row"},Ys={class:"col-sm"},Zs={key:0,class:"col-lg-5 bm-col-separator-left"},ta={class:"row mb-2"},ea={class:"col-sm"},sa={class:"row mb-2"},aa={class:"col-sm"},oa=h("hr",null,null,-1),ia={class:"row"},la={class:"col-sm-4 text-end"},na={class:"small text-white-50"};$(),Ns.render=function(t,e,s,a,o,i){const l=u("modders-list"),n=u("nominators-list"),r=u("tasks-choice"),d=u("mode-choice"),c=u("status-choice"),b=u("quest-choice"),k=u("beatmap-link"),f=u("locks-choice"),g=u("points");return t.beatmap?(m(),v("div",Rs,[h("div",Ws,[h("div",{class:M(!t.isHost||t.isRanked||t.isQualified?"col-sm-12":"col-lg-7")},[h("div",Gs,[h("div",Ks,[P(l,{beatmap:t.beatmap,"can-edit":!t.isHost&&!t.isRanked},null,8,["beatmap","can-edit"])]),!t.isRanked||t.beatmap.bns?(m(),v("div",Js,[P(n,{beatmap:t.beatmap,"can-edit":!t.isHost&&!t.isRanked},null,8,["beatmap","can-edit"])])):S("",!0)]),Xs,h("div",zs,[h("div",Ys,[P(r,{beatmap:t.beatmap,"is-host":t.isHost,"is-ranked":t.isRanked,"is-qualified":t.isQualified},null,8,["beatmap","is-host","is-ranked","is-qualified"])])])],2),!t.isHost||t.isRanked||t.isQualified?S("",!0):(m(),v("div",Zs,[h("div",ta,[h("div",ea,["WIP"==t.beatmap.status||"Secret"==t.beatmap.status?(m(),p(d,{key:0,beatmap:t.beatmap},null,8,["beatmap"])):S("",!0)])]),h("div",sa,[h("div",aa,["Secret"!==t.beatmap.status?(m(),p(c,{key:0,beatmap:t.beatmap},null,8,["beatmap"])):S("",!0)])]),"Secret"!==t.beatmap.status?(m(),p(b,{key:0,beatmap:t.beatmap},null,8,["beatmap"])):S("",!0),P(k,{beatmap:t.beatmap},null,8,["beatmap"]),"WIP"==t.beatmap.status||"Secret"==t.beatmap.status?(m(),p(f,{key:1,beatmap:t.beatmap},null,8,["beatmap"])):S("",!0)]))]),oa,h("div",ia,[P(g,{class:"col-sm-8",beatmap:t.beatmap},null,8,["beatmap"]),h("div",la,[h("span",na," Created: "+y(t.beatmap.createdAt.toString().slice(0,10)),1),t.isHost&&!t.isRanked?(m(),v("button",{key:0,id:"deleteButton",class:"btn btn-sm btn-outline-danger ms-2",onClick:e[0]||(e[0]=e=>t.deleteMap(e))}," Delete ")):S("",!0)])])])):S("",!0)},Ns.__scopeId="data-v-4a387e91";var ra=c({components:{BeatmapInfo:Ns,ModalDialog:d,QuestImg:$t,ModesIcons:F},props:{selectedBeatmap:{type:Object,default:()=>({})}},watch:{selectedBeatmap(){this.selectedBeatmap&&this.$route.query.id!==this.selectedBeatmap.id&&this.$router.replace(`/${this.selectedBeatmap.status===H.Secret?"showcase":"beatmaps"}?id=${this.selectedBeatmap.id}`)}}});const da=["href"],ca=h("i",{class:"fas fa-link"},null,-1),ua={key:1},ma=C(" |");ra.render=function(t,e,s,a,o,i){const l=u("quest-img"),n=u("user-link"),r=u("modes-icons"),d=u("beatmap-info"),c=u("modal-dialog");return m(),p(c,{id:"editBeatmap",loaded:Boolean(t.selectedBeatmap),"header-class":t.selectedBeatmap?"bg-"+t.selectedBeatmap.status.toLowerCase():""},{header:b((()=>[P(l,{beatmap:t.selectedBeatmap},null,8,["beatmap"]),t.selectedBeatmap.url?(m(),v("a",{key:0,href:t.selectedBeatmap.url,target:"_blank"},[ca,C(" "+y(t.selectedBeatmap.song.artist)+" - "+y(t.selectedBeatmap.song.title),1)],8,da)):(m(),v("span",ua,y(t.selectedBeatmap.song.artist)+" - "+y(t.selectedBeatmap.song.title),1)),ma,P(n,{class:"mx-1",user:t.selectedBeatmap.host},null,8,["user"]),P(r,{modes:[t.selectedBeatmap.mode]},null,8,["modes"])])),default:b((()=>[P(d,{beatmap:t.selectedBeatmap},null,8,["beatmap"])])),_:1},8,["loaded","header-class"])};var pa={namespaced:!0,state:{allBeatmaps:[],userBeatmaps:[],showcaseBeatmaps:[],filterValue:"",filterMode:N.any,filterStatus:"any",filterQuest:"any",selectedBeatmap:null,selectedBeatmapId:null,fetchLimit:30,isLoadingOtherBeatmaps:!0},mutations:{setAllBeatmaps(t,e){t.allBeatmaps=e},setUserBeatmaps(t,e){t.userBeatmaps=e},setShowcaseBeatmaps(t,e){t.showcaseBeatmaps=e},setFilterValue(t,e){t.filterValue=e},setFilterMode(t,e){t.filterMode=e},setFilterStatus(t,e){t.filterStatus=e},setFilterQuest(t,e){t.filterQuest=e},setIsLoadingOtherBeatmaps(t,e){t.isLoadingOtherBeatmaps=e},increaseFetchLimit(t){t.fetchLimit+=50},setSelectedBeatmap(t,e){const s=Object.values(V);e.tasks.sort((function(t,e){return s.indexOf(t.name)-s.indexOf(e.name)})),e.tasksLocked.sort((function(t,e){return s.indexOf(t)-s.indexOf(e)})),t.selectedBeatmap=e},addBeatmap(t,e){e.status===H.Secret?t.showcaseBeatmaps.unshift(e):t.userBeatmaps.unshift(e)},updateBeatmap(t,e){let s=t.allBeatmaps.findIndex((t=>t.id===e.id));-1!==s&&(t.allBeatmaps[s]=e),s=t.userBeatmaps.findIndex((t=>t.id===e.id)),-1!==s&&(t.userBeatmaps[s]=e),s=t.showcaseBeatmaps.findIndex((t=>t.id===e.id)),-1!==s&&(t.showcaseBeatmaps[s]=e)},deleteBeatmap(t,e){let s=t.allBeatmaps.findIndex((t=>t.id===e.id));-1!==s&&t.allBeatmaps.splice(s,1),s=t.userBeatmaps.findIndex((t=>t.id===e.id)),-1!==s&&t.userBeatmaps.splice(s,1),s=t.showcaseBeatmaps.findIndex((t=>t.id===e.id)),-1!==s&&t.showcaseBeatmaps.splice(s,1)}},getters:{filteredUserBeatmaps:t=>{let e=t.userBeatmaps;if(t.filterMode!==N.any){const s=t.filterMode;e=e.filter((t=>t.mode===s||t.mode===j.Hybrid))}if("any"!==t.filterStatus&&(e=e.filter((e=>e.status===t.filterStatus))),"any"!==t.filterQuest&&(e=e.filter((t=>!t.quest))),t.filterValue){const s=t.filterValue.toLowerCase().trim().split(" ").filter((t=>t.length));e=e.filter((t=>{let e=t.song.artist+" "+t.song.title+" "+t.host.username;return t.tasks.forEach((t=>{t.mappers.forEach((t=>{e+=" "+t.username}))})),e=e.toLowerCase(),s.some((t=>e.includes(t)))}))}return e},guestDifficultyBeatmaps:(t,e,s)=>e.filteredUserBeatmaps.filter((t=>{var e;return t.host.id!==(null==(e=s.loggedInUser)?void 0:e.id)})),hostedBeatmaps:(t,e,s)=>e.filteredUserBeatmaps.filter((t=>{var e;return t.host.id===(null==(e=s.loggedInUser)?void 0:e.id)}))},actions:{updateBeatmap({commit:t,state:e},s){var a;t("updateBeatmap",s),(null==(a=e.selectedBeatmap)?void 0:a.id)===s.id&&t("setSelectedBeatmap",s)},async updateFilterMode({commit:t,dispatch:e},s){t("setFilterMode",s),await e("loadOtherBeatmaps")},async updateFilterStatus({commit:t,dispatch:e},s){t("setFilterStatus",s),await e("loadOtherBeatmaps")},async updateFilterQuest({commit:t,dispatch:e},s){t("setFilterQuest",s),await e("loadOtherBeatmaps")},async updateFilterValue({commit:t,dispatch:e},s){t("setFilterValue",s),await e("loadOtherBeatmaps")},async loadOtherBeatmaps({commit:t,state:e}){var s;t("setIsLoadingOtherBeatmaps",!0);const a="any"!==e.filterStatus?`&status=${e.filterStatus}`:"",o="any"!==e.filterQuest?`&quest=${e.filterQuest}`:"",i=e.filterValue?`&search=${e.filterValue}`:"",l=await E.get(`/api/beatmaps/search?mode=${e.filterMode}&limit=${e.fetchLimit+a+o+i}`);(null==(s=l.data)?void 0:s.allBeatmaps)&&t("setAllBeatmaps",l.data.allBeatmaps),t("setIsLoadingOtherBeatmaps",!1)}}};export{St as _,Ns as a,xt as b,$t as c,ra as d,R as e,pa as f};
